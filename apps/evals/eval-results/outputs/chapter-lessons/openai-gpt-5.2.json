{
  "generatedAt": "2026-03-01T01:37:24.397Z",
  "modelId": "openai/gpt-5.2",
  "outputs": [
    {
      "duration": 13939.014375,
      "inputTokens": 2544,
      "output": "{\n  \"lessons\": [\n    {\n      \"concepts\": [\n        \"Network packet\",\n        \"Network frame\",\n        \"Payload\",\n        \"Header\",\n        \"MTU\",\n        \"Network hop\"\n      ],\n      \"description\": \"Core building blocks for how data moves across networks, from encapsulation to hop-by-hop forwarding constraints.\",\n      \"title\": \"How Data Moves on Networks\"\n    },\n    {\n      \"concepts\": [\n        \"IPv4 address\",\n        \"IPv6 address\",\n        \"IP address scope\",\n        \"Public IP address\",\n        \"Private IP address\",\n        \"Loopback address\",\n        \"Link-local address\"\n      ],\n      \"description\": \"What IP addresses represent, common address categories, and how scope affects reachability.\",\n      \"title\": \"IP Address Types\"\n    },\n    {\n      \"concepts\": [\n        \"CIDR notation\",\n        \"Subnet mask\",\n        \"Network prefix\",\n        \"Host portion\",\n        \"Subnet\",\n        \"Broadcast address\"\n      ],\n      \"description\": \"How IP ranges are defined and subdivided for routing and network segmentation.\",\n      \"title\": \"Subnets and CIDR\"\n    },\n    {\n      \"concepts\": [\n        \"Default gateway\",\n        \"Router\",\n        \"Routing table\",\n        \"Longest prefix match\",\n        \"Static route\",\n        \"Route propagation\"\n      ],\n      \"description\": \"How routers choose paths and what local devices rely on to reach off-subnet destinations.\",\n      \"title\": \"Routing Mechanics\"\n    },\n    {\n      \"concepts\": [\n        \"Forward path\",\n        \"Return path\",\n        \"Asymmetric routing\",\n        \"Stateful device\",\n        \"Path MTU discovery\",\n        \"Fragmentation\"\n      ],\n      \"description\": \"Why connectivity depends on both directions working, and how MTU-related issues show up in real networks.\",\n      \"title\": \"Bidirectional Connectivity\"\n    },\n    {\n      \"concepts\": [\n        \"Port number\",\n        \"5-tuple flow identity\",\n        \"Well-known ports\",\n        \"Ephemeral ports\",\n        \"Socket\",\n        \"Connection state\"\n      ],\n      \"description\": \"How IP addresses and ports combine to identify conversations and how endpoints track them.\",\n      \"title\": \"Ports and Flows\"\n    },\n    {\n      \"concepts\": [\n        \"TCP segment\",\n        \"TCP 3-way handshake\",\n        \"TCP sequence number\",\n        \"TCP acknowledgment\",\n        \"TCP retransmission\",\n        \"TCP flow control\",\n        \"TCP congestion control\",\n        \"TCP connection teardown\"\n      ],\n      \"description\": \"How TCP provides reliable, ordered delivery and the mechanisms that shape performance under loss and congestion.\",\n      \"title\": \"TCP Reliability and Control\"\n    },\n    {\n      \"concepts\": [\n        \"UDP datagram\",\n        \"UDP checksum\",\n        \"UDP connectionless delivery\",\n        \"UDP application reliability\",\n        \"UDP message boundary\",\n        \"Head-of-line blocking avoidance\"\n      ],\n      \"description\": \"How UDP differs from TCP in delivery guarantees and why it can reduce certain latency penalties.\",\n      \"title\": \"UDP Delivery Model\"\n    },\n    {\n      \"concepts\": [\n        \"TCP use cases\",\n        \"UDP use cases\",\n        \"Latency sensitivity\",\n        \"Loss tolerance\",\n        \"Ordering requirement\"\n      ],\n      \"description\": \"How to choose between transport options based on application needs and network conditions.\",\n      \"title\": \"TCP Selection Criteria\"\n    },\n    {\n      \"concepts\": [\n        \"Latency\",\n        \"Propagation delay\",\n        \"Serialization delay\",\n        \"Queuing delay\",\n        \"Jitter\",\n        \"Round-trip time\"\n      ],\n      \"description\": \"What contributes to delay and variability, and how to reason about timing symptoms in debugging.\",\n      \"title\": \"Latency Components\"\n    },\n    {\n      \"concepts\": [\n        \"Bandwidth\",\n        \"Throughput\",\n        \"Goodput\",\n        \"Bottleneck link\",\n        \"Bandwidth-delay product\",\n        \"Bufferbloat\"\n      ],\n      \"description\": \"How capacity relates to real transfer rates and how buffering behavior can inflate latency under load.\",\n      \"title\": \"Bandwidth and Throughput\"\n    },\n    {\n      \"concepts\": [\n        \"NAT\",\n        \"SNAT\",\n        \"DNAT\",\n        \"NAT mapping\",\n        \"NAT hairpinning\",\n        \"NAT traversal\",\n        \"Carrier-grade NAT\",\n        \"NAT port exhaustion\"\n      ],\n      \"description\": \"How address translation works, the common variants, and the practical problems NAT creates for inbound connectivity and scale.\",\n      \"title\": \"NAT Fundamentals\"\n    },\n    {\n      \"concepts\": [\n        \"ICMP\",\n        \"Ping\",\n        \"Traceroute\",\n        \"TTL\",\n        \"ICMP unreachable\",\n        \"Blackhole routing\"\n      ],\n      \"description\": \"Common diagnostic signals and what their presence or absence implies about reachability across hops.\",\n      \"title\": \"Network Diagnostics Signals\"\n    },\n    {\n      \"concepts\": [\n        \"Firewall rule\",\n        \"Stateful firewall\",\n        \"Stateless firewall\",\n        \"Ingress filtering\",\n        \"Egress filtering\",\n        \"ACL rule order\",\n        \"Default deny\"\n      ],\n      \"description\": \"How packet filtering decisions get made and how misconfigurations produce connectivity failures.\",\n      \"title\": \"Packet Filtering Concepts\"\n    },\n    {\n      \"concepts\": [\n        \"Connection timeout\",\n        \"TCP reset\",\n        \"Dropped packet\",\n        \"Packet loss\",\n        \"Duplicate packet\",\n        \"Out-of-order packet\",\n        \"Intermittent connectivity\",\n        \"Flapping route\"\n      ],\n      \"description\": \"Typical failure patterns and the low-level events that create the symptoms developers observe.\",\n      \"title\": \"Common Failure Modes\"\n    },\n    {\n      \"concepts\": [\n        \"Layer 3 reachability check\",\n        \"Port reachability check\",\n        \"Local host isolation\",\n        \"Gateway reachability\",\n        \"Hop-by-hop fault isolation\",\n        \"Client-side network misconfiguration\",\n        \"Server-side listen mismatch\",\n        \"NAT mapping mismatch\"\n      ],\n      \"description\": \"Practical mental models for narrowing a problem to host, subnet, gateway, path, or service-layer reachability without relying on protocol-specific details.\",\n      \"title\": \"Connectivity Debugging Mental Models\"\n    }\n  ]\n}",
      "outputTokens": 878,
      "systemPrompt": "# Role\n\nYou are designing an **exhaustive**, well-organized curriculum for a specific chapter in a course.\n\nYou have expertise in instructional design, curriculum development, and creating granular learning paths. You have worked at top educational institutions creating micro-learning content that breaks down complex topics into digestible, single-concept items and organizes them into coherent thematic units.\n\nYour mission is to identify **every single concept** that needs to be taught in this chapter — at the most granular level possible — and then organize those concepts into thematic lesson units.\n\nYou deeply care about making learning accessible, focused, and efficient by breaking down topics into their smallest logical units.\n\n# Inputs\n\n- `COURSE_TITLE`: name of the overall course\n- `CHAPTER_TITLE`: title of this specific chapter\n- `CHAPTER_DESCRIPTION`: what this chapter covers\n- `LANGUAGE`: output language for titles and descriptions\n- `NEIGHBORING_CHAPTERS` (optional): titles and descriptions of chapters that come before and after this one in the course\n\n## Language\n\n- `en`: Use US region unless the content is about a different region.\n- `pt`: Use Brazilian Portuguese unless the content is about a different region.\n- `es`: Use Latin American Spanish unless the content is about a different region.\n\n# Goal\n\nProduce an **exhaustive** set of **single-concept items** that collectively cover everything in `CHAPTER_TITLE` and `CHAPTER_DESCRIPTION`, organized into thematic **lesson units**.\n\nThink of this in three steps:\n\n1. **Enumerate every concept** that needs to be taught. Each concept should be one specific idea — something you could explain in a single short tweet. Be thorough and cover everything.\n\n2. **Filter out neighboring-chapter concepts.** When `NEIGHBORING_CHAPTERS` is provided, remove any concept whose primary subject belongs in a neighboring chapter. Ask: \"Is this concept primarily about THIS chapter's topic, or is it borrowed from an adjacent domain?\" If borrowed, cut it — even if it feels relevant.\n\n3. **Group the remaining concepts** into thematic lesson units of related concepts each. Each lesson is a coherent cluster of related concepts.\n\n# Critical Requirements\n\n## Concept Granularity (MOST IMPORTANT)\n\nThis is the most critical aspect. Each concept must be **one single, specific idea**:\n\n- If you can explain it in **one short tweet**, it's appropriately scoped\n- If it needs more than a tweet, **split it into multiple concepts**\n- Each concept = one fact, one definition, one rule, one technique, one distinction\n\n**Examples of correct granularity:**\n✅ \"Mitosis\"\n✅ \"Meiosis\"\n✅ \"Prophase\"\n✅ \"Metaphase\"\n✅ \"Role of Spindle Fibers\"\n\n**Examples of concepts that are TOO BROAD:**\n❌ \"Cell Division\" → split into: Mitosis, Meiosis, Cytokinesis, etc.\n❌ \"Phases of Mitosis\" → split into: Prophase, Metaphase, Anaphase, Telophase\n\n**The rule**: If a concept title could be a HEADING with sub-items under it, it's too broad. Break it into those sub-items instead.\n\n## Lesson Unit Structure\n\n- Each lesson groups related concepts under a thematic title\n- Include **as many concepts as the theme naturally requires** — some themes need 4, others need 8. Don't force every lesson to the same size\n- If a group would exceed 8 concepts, split it into two lessons with more specific themes\n- If a group would have fewer than 3 concepts, merge it with a related group\n- Lessons should follow a logical progression from foundational to advanced\n- Don't add \"applications\", \"integrated practice\", or \"putting it all together\" lessons — every lesson should teach new concepts, not revisit previous ones\n\n## Exhaustive Coverage\n\n- The total number of concepts across ALL lessons must cover **everything** in the chapter\n- **Do NOT reduce the number of concepts just because you're organizing them into groups**\n- Add **as many concepts as needed** to break down each topic fully\n- Don't limit the number of concepts or lessons arbitrarily\n- It's better to have more fine-grained concepts than fewer broad ones\n- Make sure to have all concepts needed to **fully master the chapter's scope**\n\n## Title Requirements\n\n### Lesson Titles\n\n- Describe the thematic group: e.g. \"Phases of Mitosis\", \"DNA Replication Machinery\"\n- **NEVER** use words like \"learn\", \"understand\", \"explore\", \"introduction to\", \"basics of\"\n- Go straight to the point\n\n### Concept Titles\n\n- Short, specific, focused on a single idea\n- **NEVER** use \"AND\", \"OR\", \"VS\", or their equivalents in other languages (e.g., \"e\", \"ou\", \"y\", \"o\", \"frente a\", \"versus\") — if you find yourself comparing two things, split into separate concepts\n- Must be **concrete and self-explanatory** — a student should know what they'll learn just from reading the title\n- Prefer concrete nouns and actions over abstract/formal terms\n- Concept titles should read like **glossary entries** — factual, teachable items, not interpretive claims or thesis statements\n- Same concise style as: \"What is a Variable?\", \"Integer Numbers\", \"The Addition Operator\", \"Reading a Graduated Cylinder\"\n\n**Too abstract:**\n❌ \"Transcription\" → ✅ \"DNA Transcription\"\n❌ \"Precision\" → ✅ \"Measurement Precision\"\n❌ \"Substitution\" → ✅ \"Nucleophilic Substitution\"\n❌ \"Resolution\" → ✅ \"Instrument Resolution\"\n\n**Too verbose / reads like a description:**\n❌ \"Effect of Power on Relative Uncertainty\"\n❌ \"Decimal Places Compatible with Uncertainty\"\n❌ \"Consistency of Precision Throughout Calculation\"\n\n✅ \"Uncertainty in Powers\"\n✅ \"Matching Decimal Places to Uncertainty\"\n✅ \"Guard Digits\"\n\n**Too interpretive / reads like a thesis:**\n❌ \"Gravity as Geometric Curvature Metaphor\"\n❌ \"Entropy as Information Loss Framework\"\n❌ \"Selection as Optimization Analogy\"\n\n✅ \"Gravitational Curvature\"\n✅ \"Entropy in Thermodynamics\"\n✅ \"Natural Selection Mechanism\"\n\nWhen a concept title is a single generic word, add just enough context to make it concrete and unambiguous. When a concept title reads like a sentence or explanation, shorten it to a noun phrase. When a concept title reads like an essay argument (\"X as Y motif\"), reframe it as a concrete, teachable fact.\n\n### Lesson Descriptions\n\n- 1-2 sentences describing what this group of concepts covers, no fluff\n- **NEVER** start with words like \"introduces\", \"presents\", \"shows\", \"teaches\", \"covers\", \"explains\"\n- Go straight to the content: e.g. \"How the if, else, and elif keywords control which code block runs.\" not \"Introduces the main conditional keywords in Python.\"\n\n## Progression & Structure\n\n- Build a logical progression from basic to advanced concepts\n- Ensure later concepts build on knowledge from earlier ones\n- Focus specifically on THIS chapter, not the entire course\n- Don't add summary, review, \"key concepts\", or \"verification/checklist\" lessons — every lesson must teach new standalone concepts, not meta-skills about checking your own work\n- Don't add assessment, quiz, or project lessons\n\n## Neighboring Chapter Awareness\n\nWhen `NEIGHBORING_CHAPTERS` is provided, use it to strictly avoid generating concepts that belong in another chapter.\n\nFor EACH concept, apply this test: **\"If I removed this concept from my chapter and placed it in the neighboring chapter's list, would it fit naturally there?\"** If yes, it belongs there, not here — remove it.\n\nThis is a common mistake: the model sees a topic as _relevant_ to the chapter and includes it, even though it's _primarily taught_ in a neighboring chapter. Relevance is not enough — the concept must be **primarily about THIS chapter's subject matter**.\n\nFor example, if a neighboring chapter covers \"DevOps and CI/CD\", do not include concepts like \"Deploy Pipeline\" or \"Release Strategy\" — even if they seem useful for your chapter's topic. If a neighboring chapter covers \"SRE and Reliability\", do not include concepts about SLOs or error budgets.\n\nBrief contextual mentions within a concept's explanation are fine, but the concept itself must not be primarily about a neighboring chapter's domain.\n\n# Example\n\nFor a chapter titled \"Control Flow\" in a Python Programming course:\n\n**Lesson: \"Boolean Expressions\"**\nConcepts: What is a Boolean, True Value, False Value, Comparison Operators, Equal To Operator, Not Equal To Operator, Greater Than Operator, Less Than Operator\n\n**Lesson: \"Conditional Statements\"**\nConcepts: The if Statement, The else Clause, The elif Clause, Nested if Statements, Conditional Expressions (Ternary)\n\n**Lesson: \"Logical Operators\"**\nConcepts: The and Operator, The or Operator, The not Operator, Short-Circuit Evaluation, Operator Precedence in Conditions\n\n**Lesson: \"While Loops\"**\nConcepts: What is a Loop, The while Statement, Loop Condition, Infinite Loops, The break Statement, The continue Statement\n\n**Lesson: \"For Loops and Iteration\"**\nConcepts: The for Statement, Iterating Over a List, Iterating Over a String, The range() Function, Nested Loops\n\nNotice how each concept is a **single, specific idea** (not a broad topic), and the lessons group related concepts together thematically.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n1. **Concept granularity**: Can EACH concept be explained in a single tweet? If any concept could have sub-items under it, break it down further.\n2. **No compound concepts**: Does any concept title contain \"AND\", \"OR\", or \"VS\"? If yes, split it.\n3. **Lesson sizes**: Does each lesson have 3-8 concepts? Do lesson sizes vary naturally, or are they all the same number? Split or merge as needed.\n4. **Complete coverage**: Have you covered EVERYTHING from the chapter description?\n5. **Chapter scope**: Did you stay within the chapter's scope?\n6. **No neighboring overlap**: For each concept, if you moved it to a neighboring chapter's list, would it fit naturally there? If yes, remove it — it belongs there, not here.\n\n# Output Format\n\nEach lesson must include:\n\n- **title** — thematic group name\n- **description** — 1-2 sentences describing what this group of concepts covers\n- **concepts** — array of concept titles (short, specific, focused on a single idea each)\n",
      "testCaseId": "en-web-networking-fundamentals-1",
      "userPrompt": "\n    LANGUAGE: en\n    COURSE_TITLE: Web Development\n    CHAPTER_TITLE: Networking fundamentals\n    CHAPTER_DESCRIPTION: IP addressing, routing, NAT, TCP vs UDP, latency and bandwidth tradeoffs, and common failure modes. Practical mental models for debugging connectivity issues.\nNEIGHBORING_CHAPTERS:\n- \"Web development landscape\": Roles, responsibilities, and interfaces across front-end, back-end, full-stack, QA, DevOps, security, design, and product. How standards bodies and browser vendors shape the platform.\n- \"DNS and domains\": DNS records, resolvers, caching, propagation, and common configurations for web apps. Domain strategy, subdomains, and pitfalls with split-horizon DNS.\n- \"HTTP\": HTTP methods, status codes, headers, content negotiation, caching semantics, cookies, and redirects. HTTP/2 and HTTP/3 concepts and performance implications.\n- \"HTTPS and TLS\": TLS handshakes, certificate chains, HSTS, OCSP stapling, and modern TLS configuration choices. Secure transport patterns for browsers, APIs, and internal services.\n  "
    },
    {
      "duration": 14001.652458,
      "inputTokens": 2616,
      "output": "{\n  \"lessons\": [\n    {\n      \"concepts\": [\n        \"Classe int\",\n        \"Literais inteiros em base decimal\",\n        \"Literais inteiros em base binária\",\n        \"Literais inteiros em base octal\",\n        \"Literais inteiros em base hexadecimal\",\n        \"Separador visual underscore em literais numéricos\"\n      ],\n      \"description\": \"Representação de inteiros em Python, formas de escrita de literais e como diferentes bases numéricas aparecem no código-fonte.\",\n      \"title\": \"Inteiros e literais inteiros\"\n    },\n    {\n      \"concepts\": [\n        \"Precisão arbitrária de int\",\n        \"Sinal em inteiros negativos\",\n        \"Conversão de string para int com base\",\n        \"Função bin()\",\n        \"Função oct()\",\n        \"Função hex()\"\n      ],\n      \"description\": \"Como inteiros crescem sem overflow fixo e como converter inteiros para representações em string em bases comuns.\",\n      \"title\": \"Propriedades de int e conversões de base\"\n    },\n    {\n      \"concepts\": [\n        \"Classe float\",\n        \"Literal float com ponto decimal\",\n        \"Literal float em notação científica\",\n        \"Classe bool\",\n        \"Valores True\",\n        \"Valores False\",\n        \"bool como subtipo de int\"\n      ],\n      \"description\": \"Valores de ponto flutuante e booleanos, sintaxe de literais e a relação estrutural entre bool e int.\",\n      \"title\": \"Float e bool como tipos numéricos\"\n    },\n    {\n      \"concepts\": [\n        \"Classe complex\",\n        \"Literal complexo com sufixo j\",\n        \"Construtor complex()\",\n        \"Atributo real de complex\",\n        \"Atributo imag de complex\",\n        \"Método conjugate()\"\n      ],\n      \"description\": \"Números complexos em Python, formas de criação e acesso às partes real e imaginária.\",\n      \"title\": \"Números complexos\"\n    },\n    {\n      \"concepts\": [\n        \"Singleton None\",\n        \"Tipo NoneType\",\n        \"Teste de identidade com None usando is\",\n        \"Diferença entre None e 0\",\n        \"Diferença entre None e string vazia\",\n        \"Retorno implícito None em funções\"\n      ],\n      \"description\": \"O valor especial None, seu tipo, como compará-lo corretamente e situações comuns em que aparece.\",\n      \"title\": \"None e ausência de valor\"\n    },\n    {\n      \"concepts\": [\n        \"Função type()\",\n        \"Função isinstance()\",\n        \"Conversão explícita com int()\",\n        \"Conversão explícita com float()\",\n        \"Conversão explícita com bool()\",\n        \"Conversão explícita com complex()\"\n      ],\n      \"description\": \"Como inspecionar tipos em tempo de execução e realizar coerção explícita entre os tipos numéricos e valores especiais.\",\n      \"title\": \"Inspeção de tipos e coerções explícitas\"\n    },\n    {\n      \"concepts\": [\n        \"Truncamento de float para int\",\n        \"Arredondamento bancário de round()\",\n        \"Argumento ndigits de round()\",\n        \"Função math.floor()\",\n        \"Função math.ceil()\",\n        \"Função math.trunc()\"\n      ],\n      \"description\": \"Operações de arredondamento e truncamento, diferenças entre funções e impactos na conversão de floats.\",\n      \"title\": \"Arredondamento e truncamento de números\"\n    },\n    {\n      \"concepts\": [\n        \"Representação binária de float\",\n        \"IEEE 754 double precision em Python\",\n        \"Erro de representação de 0.1\",\n        \"Cancelamento catastrófico\",\n        \"Acúmulo de erro em somas repetidas\",\n        \"Comparação de floats com math.isclose()\",\n        \"Tolerância relativa em isclose()\",\n        \"Tolerância absoluta em isclose()\"\n      ],\n      \"description\": \"Por que floats têm erros de arredondamento, como esses erros se acumulam e como comparar valores de forma robusta.\",\n      \"title\": \"Precisão numérica e erros de arredondamento em float\"\n    },\n    {\n      \"concepts\": [\n        \"Infinity positivo em float\",\n        \"Infinity negativo em float\",\n        \"NaN em float\",\n        \"float('inf')\",\n        \"float('nan')\",\n        \"math.isinf()\",\n        \"math.isnan()\",\n        \"Propagação de NaN em operações\"\n      ],\n      \"description\": \"Valores especiais de ponto flutuante, como criá-los, detectá-los e como eles se comportam em cálculos.\",\n      \"title\": \"Valores especiais de float: inf e NaN\"\n    },\n    {\n      \"concepts\": [\n        \"Módulo decimal\",\n        \"Classe Decimal\",\n        \"Construção de Decimal a partir de string\",\n        \"Contexto de precisão do decimal\",\n        \"Arredondamento no decimal via contexto\",\n        \"Quantização com Decimal.quantize()\",\n        \"Sinalizadores de condições no decimal\"\n      ],\n      \"description\": \"Aritmética decimal exata e controlável para dinheiro e precisão definida, incluindo contexto, arredondamento e quantização.\",\n      \"title\": \"Decimal para aritmética decimal exata\"\n    },\n    {\n      \"concepts\": [\n        \"Módulo fractions\",\n        \"Classe Fraction\",\n        \"Construção de Fraction a partir de int\",\n        \"Construção de Fraction a partir de string\",\n        \"Construção de Fraction a partir de float via limit_denominator()\",\n        \"Normalização de frações em Fraction\",\n        \"Atributo numerator de Fraction\",\n        \"Atributo denominator de Fraction\"\n      ],\n      \"description\": \"Aritmética racional exata com frações, formas de criação e como controlar aproximações vindas de floats.\",\n      \"title\": \"Fractions para aritmética racional exata\"\n    },\n    {\n      \"concepts\": [\n        \"Mistura de int e float em operações\",\n        \"Promoção para float em operações mistas\",\n        \"Mistura de int e complex em operações\",\n        \"Promoção para complex em operações mistas\",\n        \"Mistura de Decimal e int em operações\",\n        \"Mistura de Decimal e float em operações\",\n        \"Mistura de Fraction e int em operações\",\n        \"Mistura de Fraction e float em operações\"\n      ],\n      \"description\": \"Regras práticas de interoperabilidade entre tipos numéricos e o que acontece quando diferentes tipos aparecem na mesma expressão.\",\n      \"title\": \"Interações entre tipos numéricos em expressões\"\n    }\n  ]\n}",
      "outputTokens": 1089,
      "systemPrompt": "# Role\n\nYou are designing an **exhaustive**, well-organized curriculum for a specific chapter in a course.\n\nYou have expertise in instructional design, curriculum development, and creating granular learning paths. You have worked at top educational institutions creating micro-learning content that breaks down complex topics into digestible, single-concept items and organizes them into coherent thematic units.\n\nYour mission is to identify **every single concept** that needs to be taught in this chapter — at the most granular level possible — and then organize those concepts into thematic lesson units.\n\nYou deeply care about making learning accessible, focused, and efficient by breaking down topics into their smallest logical units.\n\n# Inputs\n\n- `COURSE_TITLE`: name of the overall course\n- `CHAPTER_TITLE`: title of this specific chapter\n- `CHAPTER_DESCRIPTION`: what this chapter covers\n- `LANGUAGE`: output language for titles and descriptions\n- `NEIGHBORING_CHAPTERS` (optional): titles and descriptions of chapters that come before and after this one in the course\n\n## Language\n\n- `en`: Use US region unless the content is about a different region.\n- `pt`: Use Brazilian Portuguese unless the content is about a different region.\n- `es`: Use Latin American Spanish unless the content is about a different region.\n\n# Goal\n\nProduce an **exhaustive** set of **single-concept items** that collectively cover everything in `CHAPTER_TITLE` and `CHAPTER_DESCRIPTION`, organized into thematic **lesson units**.\n\nThink of this in three steps:\n\n1. **Enumerate every concept** that needs to be taught. Each concept should be one specific idea — something you could explain in a single short tweet. Be thorough and cover everything.\n\n2. **Filter out neighboring-chapter concepts.** When `NEIGHBORING_CHAPTERS` is provided, remove any concept whose primary subject belongs in a neighboring chapter. Ask: \"Is this concept primarily about THIS chapter's topic, or is it borrowed from an adjacent domain?\" If borrowed, cut it — even if it feels relevant.\n\n3. **Group the remaining concepts** into thematic lesson units of related concepts each. Each lesson is a coherent cluster of related concepts.\n\n# Critical Requirements\n\n## Concept Granularity (MOST IMPORTANT)\n\nThis is the most critical aspect. Each concept must be **one single, specific idea**:\n\n- If you can explain it in **one short tweet**, it's appropriately scoped\n- If it needs more than a tweet, **split it into multiple concepts**\n- Each concept = one fact, one definition, one rule, one technique, one distinction\n\n**Examples of correct granularity:**\n✅ \"Mitosis\"\n✅ \"Meiosis\"\n✅ \"Prophase\"\n✅ \"Metaphase\"\n✅ \"Role of Spindle Fibers\"\n\n**Examples of concepts that are TOO BROAD:**\n❌ \"Cell Division\" → split into: Mitosis, Meiosis, Cytokinesis, etc.\n❌ \"Phases of Mitosis\" → split into: Prophase, Metaphase, Anaphase, Telophase\n\n**The rule**: If a concept title could be a HEADING with sub-items under it, it's too broad. Break it into those sub-items instead.\n\n## Lesson Unit Structure\n\n- Each lesson groups related concepts under a thematic title\n- Include **as many concepts as the theme naturally requires** — some themes need 4, others need 8. Don't force every lesson to the same size\n- If a group would exceed 8 concepts, split it into two lessons with more specific themes\n- If a group would have fewer than 3 concepts, merge it with a related group\n- Lessons should follow a logical progression from foundational to advanced\n- Don't add \"applications\", \"integrated practice\", or \"putting it all together\" lessons — every lesson should teach new concepts, not revisit previous ones\n\n## Exhaustive Coverage\n\n- The total number of concepts across ALL lessons must cover **everything** in the chapter\n- **Do NOT reduce the number of concepts just because you're organizing them into groups**\n- Add **as many concepts as needed** to break down each topic fully\n- Don't limit the number of concepts or lessons arbitrarily\n- It's better to have more fine-grained concepts than fewer broad ones\n- Make sure to have all concepts needed to **fully master the chapter's scope**\n\n## Title Requirements\n\n### Lesson Titles\n\n- Describe the thematic group: e.g. \"Phases of Mitosis\", \"DNA Replication Machinery\"\n- **NEVER** use words like \"learn\", \"understand\", \"explore\", \"introduction to\", \"basics of\"\n- Go straight to the point\n\n### Concept Titles\n\n- Short, specific, focused on a single idea\n- **NEVER** use \"AND\", \"OR\", \"VS\", or their equivalents in other languages (e.g., \"e\", \"ou\", \"y\", \"o\", \"frente a\", \"versus\") — if you find yourself comparing two things, split into separate concepts\n- Must be **concrete and self-explanatory** — a student should know what they'll learn just from reading the title\n- Prefer concrete nouns and actions over abstract/formal terms\n- Concept titles should read like **glossary entries** — factual, teachable items, not interpretive claims or thesis statements\n- Same concise style as: \"What is a Variable?\", \"Integer Numbers\", \"The Addition Operator\", \"Reading a Graduated Cylinder\"\n\n**Too abstract:**\n❌ \"Transcription\" → ✅ \"DNA Transcription\"\n❌ \"Precision\" → ✅ \"Measurement Precision\"\n❌ \"Substitution\" → ✅ \"Nucleophilic Substitution\"\n❌ \"Resolution\" → ✅ \"Instrument Resolution\"\n\n**Too verbose / reads like a description:**\n❌ \"Effect of Power on Relative Uncertainty\"\n❌ \"Decimal Places Compatible with Uncertainty\"\n❌ \"Consistency of Precision Throughout Calculation\"\n\n✅ \"Uncertainty in Powers\"\n✅ \"Matching Decimal Places to Uncertainty\"\n✅ \"Guard Digits\"\n\n**Too interpretive / reads like a thesis:**\n❌ \"Gravity as Geometric Curvature Metaphor\"\n❌ \"Entropy as Information Loss Framework\"\n❌ \"Selection as Optimization Analogy\"\n\n✅ \"Gravitational Curvature\"\n✅ \"Entropy in Thermodynamics\"\n✅ \"Natural Selection Mechanism\"\n\nWhen a concept title is a single generic word, add just enough context to make it concrete and unambiguous. When a concept title reads like a sentence or explanation, shorten it to a noun phrase. When a concept title reads like an essay argument (\"X as Y motif\"), reframe it as a concrete, teachable fact.\n\n### Lesson Descriptions\n\n- 1-2 sentences describing what this group of concepts covers, no fluff\n- **NEVER** start with words like \"introduces\", \"presents\", \"shows\", \"teaches\", \"covers\", \"explains\"\n- Go straight to the content: e.g. \"How the if, else, and elif keywords control which code block runs.\" not \"Introduces the main conditional keywords in Python.\"\n\n## Progression & Structure\n\n- Build a logical progression from basic to advanced concepts\n- Ensure later concepts build on knowledge from earlier ones\n- Focus specifically on THIS chapter, not the entire course\n- Don't add summary, review, \"key concepts\", or \"verification/checklist\" lessons — every lesson must teach new standalone concepts, not meta-skills about checking your own work\n- Don't add assessment, quiz, or project lessons\n\n## Neighboring Chapter Awareness\n\nWhen `NEIGHBORING_CHAPTERS` is provided, use it to strictly avoid generating concepts that belong in another chapter.\n\nFor EACH concept, apply this test: **\"If I removed this concept from my chapter and placed it in the neighboring chapter's list, would it fit naturally there?\"** If yes, it belongs there, not here — remove it.\n\nThis is a common mistake: the model sees a topic as _relevant_ to the chapter and includes it, even though it's _primarily taught_ in a neighboring chapter. Relevance is not enough — the concept must be **primarily about THIS chapter's subject matter**.\n\nFor example, if a neighboring chapter covers \"DevOps and CI/CD\", do not include concepts like \"Deploy Pipeline\" or \"Release Strategy\" — even if they seem useful for your chapter's topic. If a neighboring chapter covers \"SRE and Reliability\", do not include concepts about SLOs or error budgets.\n\nBrief contextual mentions within a concept's explanation are fine, but the concept itself must not be primarily about a neighboring chapter's domain.\n\n# Example\n\nFor a chapter titled \"Control Flow\" in a Python Programming course:\n\n**Lesson: \"Boolean Expressions\"**\nConcepts: What is a Boolean, True Value, False Value, Comparison Operators, Equal To Operator, Not Equal To Operator, Greater Than Operator, Less Than Operator\n\n**Lesson: \"Conditional Statements\"**\nConcepts: The if Statement, The else Clause, The elif Clause, Nested if Statements, Conditional Expressions (Ternary)\n\n**Lesson: \"Logical Operators\"**\nConcepts: The and Operator, The or Operator, The not Operator, Short-Circuit Evaluation, Operator Precedence in Conditions\n\n**Lesson: \"While Loops\"**\nConcepts: What is a Loop, The while Statement, Loop Condition, Infinite Loops, The break Statement, The continue Statement\n\n**Lesson: \"For Loops and Iteration\"**\nConcepts: The for Statement, Iterating Over a List, Iterating Over a String, The range() Function, Nested Loops\n\nNotice how each concept is a **single, specific idea** (not a broad topic), and the lessons group related concepts together thematically.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n1. **Concept granularity**: Can EACH concept be explained in a single tweet? If any concept could have sub-items under it, break it down further.\n2. **No compound concepts**: Does any concept title contain \"AND\", \"OR\", or \"VS\"? If yes, split it.\n3. **Lesson sizes**: Does each lesson have 3-8 concepts? Do lesson sizes vary naturally, or are they all the same number? Split or merge as needed.\n4. **Complete coverage**: Have you covered EVERYTHING from the chapter description?\n5. **Chapter scope**: Did you stay within the chapter's scope?\n6. **No neighboring overlap**: For each concept, if you moved it to a neighboring chapter's list, would it fit naturally there? If yes, remove it — it belongs there, not here.\n\n# Output Format\n\nEach lesson must include:\n\n- **title** — thematic group name\n- **description** — 1-2 sentences describing what this group of concepts covers\n- **concepts** — array of concept titles (short, specific, focused on a single idea each)\n",
      "testCaseId": "pt-python-tipos-numericos-1",
      "userPrompt": "\n    LANGUAGE: pt\n    COURSE_TITLE: Python\n    CHAPTER_TITLE: Tipos numéricos e valores especiais\n    CHAPTER_DESCRIPTION: Inteiros, floats, complexos, bool, None; conversões, precisão numérica, erros de arredondamento e uso de decimal/fractions.\nNEIGHBORING_CHAPTERS:\n- \"Ambiente de desenvolvimento\": Instalação e configuração do Python, múltiplas versões, PATH, virtual environments, VS Code/IDEs, REPL, Jupyter e boas práticas de organização local.\n- \"Execução de programas\": Execução em REPL, scripts e módulos; shebang, codificação, argumentos de linha de comando e status de saída do processo.\n- \"Sintaxe e convenções\": Regras de indentação, nomes, comentários, docstrings, literais, operadores e precedência; diferenças entre Python interativo e arquivo.\n- \"Texto e codificação\": Strings, bytes e bytearray; Unicode, normalização, encodings, f-strings, formatação avançada e manipulação eficiente.\n- \"Estruturas de dados fundamentais\": Listas, tuplas, dicionários e conjuntos; mutabilidade, cópia rasa vs profunda, hashing, ordenação e complexidade de operações.\n- \"Controle de fluxo\": if/elif/else, match/case, loops, break/continue, compreensão de escopo e padrões comuns de controle.\n  "
    },
    {
      "duration": 46227.719042,
      "inputTokens": 2632,
      "output": "{\n  \"lessons\": [\n    {\n      \"concepts\": [\n        \"Polarización del enlace C=O\",\n        \"Geometría trigonal plana del carbonilo\",\n        \"Electrofilicidad del carbono carbonílico\",\n        \"Basicidad del oxígeno carbonílico\",\n        \"Resonancia del grupo carbonilo\",\n        \"Efecto inductivo en carbonilos\",\n        \"Activación ácida del carbonilo\",\n        \"Activación por coordinación a Lewis ácidos\"\n      ],\n      \"description\": \"Propiedades electrónicas y geométricas que determinan por qué el carbonilo es electrofílico y cómo se activa hacia la adición nucleofílica.\",\n      \"title\": \"Estructura electrónica del carbonilo\"\n    },\n    {\n      \"concepts\": [\n        \"Aldehídos como electrofilos\",\n        \"Cetonas como electrofilos\",\n        \"Formaldehído como carbonilo especial\",\n        \"Efecto estérico en la reactividad de carbonilos\",\n        \"Efecto del sustituyente alquilo en la electrofilicidad\",\n        \"Carbonilos conjugados como electrofilos\",\n        \"Influencia del grupo saliente ausente en aldehídos\",\n        \"Comparación de reactividad aldehído cetona\"\n      ],\n      \"description\": \"Factores estructurales que controlan la rapidez y el resultado de la adición a aldehídos, cetonas y carbonilos conjugados.\",\n      \"title\": \"Reactividad relativa de aldehídos y cetonas\"\n    },\n    {\n      \"concepts\": [\n        \"Ataque nucleofílico al carbono carbonílico\",\n        \"Intermedio alcóxido tetraédrico\",\n        \"Colapso del intermedio tetraédrico en aldehídos\",\n        \"Protonación del alcóxido\",\n        \"Regeneración del catalizador ácido\",\n        \"Balance de cargas en mecanismos de adición\",\n        \"Perfil energético de la adición al carbonilo\",\n        \"Control cinético en adiciones a carbonilos\"\n      ],\n      \"description\": \"Pasos elementales comunes en mecanismos de adición nucleofílica a carbonilos bajo condiciones ácidas y básicas.\",\n      \"title\": \"Mecanismo general de adición nucleofílica\"\n    },\n    {\n      \"concepts\": [\n        \"Hidratación de aldehídos\",\n        \"Hidratación de cetonas\",\n        \"Equilibrio carbonilo gem diol\",\n        \"Efecto de sustituyentes en la hidratación\",\n        \"Catalisis ácida de hidratación\",\n        \"Catalisis básica de hidratación\",\n        \"Formación de hemiacetales\",\n        \"Formación de acetales\"\n      ],\n      \"description\": \"Adiciones reversibles al carbonilo que generan gem-dioles, hemiacetales y acetales, junto con los factores que gobiernan sus equilibrios.\",\n      \"title\": \"Adiciones reversibles al carbonilo\"\n    },\n    {\n      \"concepts\": [\n        \"Formación de iminas\",\n        \"Intermedio carbinolamina\",\n        \"Condiciones ácidas para formación de iminas\",\n        \"Formación de iminios\",\n        \"Formación de oximas\",\n        \"Formación de hidrazonas\",\n        \"Formación de semicarbazonas\",\n        \"Hidrólisis de iminas\"\n      ],\n      \"description\": \"Química de adición-eliminación con nucleófilos nitrogenados en aldehídos y cetonas y los intermediarios clave implicados.\",\n      \"title\": \"Adición de nucleófilos nitrogenados a carbonilos\"\n    },\n    {\n      \"concepts\": [\n        \"Formación de enaminas\",\n        \"Catálisis por aminas secundarias\",\n        \"Equilibrio enamina iminio\",\n        \"Selectividad E Z en enaminas\",\n        \"Hidrólisis de enaminas\",\n        \"Enamina como equivalente de enolato\",\n        \"Alquilación en α vía enaminas\",\n        \"Acilación en α vía enaminas\"\n      ],\n      \"description\": \"Generación y uso de enaminas como nucleófilos en α de carbonilos para construir enlaces C–C con control de reactividad.\",\n      \"title\": \"Enaminas y reactividad en α\"\n    },\n    {\n      \"concepts\": [\n        \"Adición de cianuro a carbonilos\",\n        \"Formación de cianohidrinas\",\n        \"Control de pH en cianohidrinas\",\n        \"Equilibrio de formación de cianohidrinas\",\n        \"Adición de bisulfito a carbonilos\",\n        \"Aductos de bisulfito como derivados aislables\",\n        \"Uso de aductos de bisulfito en purificación\",\n        \"Reversibilidad del aducto de bisulfito\"\n      ],\n      \"description\": \"Adiciones de nucleófilos aniónicos típicos y su uso para generar derivados estables o equilibrados de aldehídos y cetonas.\",\n      \"title\": \"Cianohidrinas y aductos de bisulfito\"\n    },\n    {\n      \"concepts\": [\n        \"Adición de organolitios a carbonilos\",\n        \"Adición de reactivos de Grignard a carbonilos\",\n        \"Formación de alcoholes secundarios\",\n        \"Formación de alcoholes terciarios\",\n        \"Protonación en el trabajo de reacción\",\n        \"Incompatibilidad con agua en organometálicos\",\n        \"Quelación metal oxígeno en el ataque\",\n        \"Control estérico en la adición organometálica\"\n      ],\n      \"description\": \"Formación de enlaces C–C por adición de nucleófilos carbonados fuertes y los detalles prácticos y mecanísticos asociados.\",\n      \"title\": \"Adición de organometálicos a carbonilos\"\n    },\n    {\n      \"concepts\": [\n        \"Definición de posición alfa en carbonilos\",\n        \"Acidez de hidrógenos alfa\",\n        \"Estabilización por resonancia del enolato\",\n        \"Efecto inductivo en la acidez alfa\",\n        \"pKa típico de aldehídos en α\",\n        \"pKa típico de cetonas en α\",\n        \"Desprotonación en condiciones básicas\",\n        \"Equilibrio ácido base de formación de enolato\"\n      ],\n      \"description\": \"Origen de la acidez en α y cómo se forma el enolato como nucleófilo clave en reacciones de construcción C–C.\",\n      \"title\": \"Acidez en α y formación de enolatos\"\n    },\n    {\n      \"concepts\": [\n        \"Tautomería ceto enol\",\n        \"Enol como nucleófilo\",\n        \"Catálisis ácida de enolización\",\n        \"Catálisis básica de enolización\",\n        \"Paso limitante en enolización ácida\",\n        \"Paso limitante en enolización básica\",\n        \"Contenido de enol en equilibrio\",\n        \"Efecto de conjugación en el enol\"\n      ],\n      \"description\": \"Relación ceto–enol y rutas de enolización que determinan la disponibilidad de enoles reactivos.\",\n      \"title\": \"Tautomería ceto enol y enolización\"\n    },\n    {\n      \"concepts\": [\n        \"Enolato C-nucleófilo\",\n        \"Enolato O-nucleófilo\",\n        \"Resonancia del enolato\",\n        \"Enolato E\",\n        \"Enolato Z\",\n        \"Geometría del enolato por agregación metálica\",\n        \"Efecto del catión en la estructura del enolato\",\n        \"Equilibrio entre formas de enolato\"\n      ],\n      \"description\": \"Estructuras y formas reactivas del enolato que controlan dónde y cómo ataca en la formación de enlaces.\",\n      \"title\": \"Estructura y reactividad de enolatos\"\n    },\n    {\n      \"concepts\": [\n        \"Base cinética para enolatos\",\n        \"Base termodinámica para enolatos\",\n        \"Enolato cinético\",\n        \"Enolato termodinámico\",\n        \"Efecto de la temperatura en selectividad de enolato\",\n        \"Efecto del solvente en selectividad de enolato\",\n        \"Efecto del contraión en selectividad de enolato\",\n        \"Equilibración de enolatos\"\n      ],\n      \"description\": \"Cómo elegir condiciones para obtener el enolato deseado cuando existen sitios α no equivalentes.\",\n      \"title\": \"Control cinético y termodinámico de enolatos\"\n    },\n    {\n      \"concepts\": [\n        \"Condiciones para halogenación alfa\",\n        \"Monohalogenación alfa en base\",\n        \"Polihalogenación alfa en base\",\n        \"Halogenación alfa en ácido\",\n        \"Mecanismo vía enol en halogenación ácida\",\n        \"Mecanismo vía enolato en halogenación básica\",\n        \"Reacción de haloformo\",\n        \"Selectividad de halogenación en α\"\n      ],\n      \"description\": \"Transformaciones en α que usan enoles o enolatos como intermediarios para introducir halógenos y realizar escisiones específicas.\",\n      \"title\": \"Halogenación en α de carbonilos\"\n    },\n    {\n      \"concepts\": [\n        \"Formación de enol éteres silílicos\",\n        \"Reacción con cloruros de sililo\",\n        \"Uso de bases para sililación\",\n        \"Estabilidad de enol éteres silílicos\",\n        \"Regioselectividad en enol éteres silílicos\",\n        \"Enol éter silílico cinético\",\n        \"Enol éter silílico termodinámico\",\n        \"Desprotección de enol éteres silílicos\"\n      ],\n      \"description\": \"Preparación y control de regioselectividad de enol éteres silílicos como equivalentes neutros de enolatos.\",\n      \"title\": \"Enol éteres silílicos\"\n    },\n    {\n      \"concepts\": [\n        \"Alquilación en α de enolatos\",\n        \"Elección de electrófilo para alquilación\",\n        \"Alquilación C selectiva\",\n        \"Alquilación O selectiva\",\n        \"Polialquilación por sobrealquilación\",\n        \"Control de monoalquilación\",\n        \"Acilación en α por derivados acilo reactivos\",\n        \"Formación de 1,3-dicarbonilos por acilación\"\n      ],\n      \"description\": \"Formación de enlaces C–C en α usando enolatos y las variables que determinan quimioselectividad y grado de sustitución.\",\n      \"title\": \"Sustitución en α mediada por enolatos\"\n    },\n    {\n      \"concepts\": [\n        \"Definición de adición 1,2\",\n        \"Definición de adición 1,4\",\n        \"Electrófilo en enonas\",\n        \"Nucleófilos duros en adición 1,2\",\n        \"Nucleófilos blandos en adición 1,4\",\n        \"Intermedio enolato tras adición 1,4\",\n        \"Protonación del enolato de Michael\",\n        \"Efecto del catión en selectividad 1,2\"\n      ],\n      \"description\": \"Competencia entre ataque al carbonilo y ataque conjugado en carbonilos α,β-insaturados y reglas de selectividad.\",\n      \"title\": \"Selectividad 1,2 y 1,4 en carbonilos conjugados\"\n    },\n    {\n      \"concepts\": [\n        \"Adición de Michael\",\n        \"Aceptores de Michael típicos\",\n        \"Donadores de Michael típicos\",\n        \"Generación del enolato donador\",\n        \"Formación del enlace C–C en β\",\n        \"Desplazamiento de la insaturación tras Michael\",\n        \"Michael intramolecular\",\n        \"Efecto del solvente en Michael\"\n      ],\n      \"description\": \"Formación de enlaces C–C por adición conjugada de enolatos a aceptores α,β-insaturados y variantes intra e intermoleculares.\",\n      \"title\": \"Reacción de Michael\"\n    },\n    {\n      \"concepts\": [\n        \"Aldolación\",\n        \"Aldolización cruzada\",\n        \"Aldolización intramolecular\",\n        \"Producto β-hidroxicarbonilo\",\n        \"Deshidratación aldólica\",\n        \"Condensación aldólica\",\n        \"Control de autoaldolización\",\n        \"Estrategia de enolato preformado\"\n      ],\n      \"description\": \"Construcción de enlaces C–C entre carbonilos vía enolatos para dar β-hidroxicarbonilos y, tras eliminación, carbonilos α,β-insaturados.\",\n      \"title\": \"Reacción aldólica\"\n    },\n    {\n      \"concepts\": [\n        \"Mecanismo aldólico en base\",\n        \"Mecanismo aldólico en ácido\",\n        \"Formación del nuevo enlace C–C en aldol\",\n        \"Protonación del alcóxido aldólico\",\n        \"Retroaldol\",\n        \"Equilibrio aldol retroaldol\",\n        \"Efecto de temperatura en deshidratación\",\n        \"E-selectividad en enonas por deshidratación\"\n      ],\n      \"description\": \"Pasos mecanísticos y reversibilidad de la aldol, más el origen de la formación de enonas en la condensación.\",\n      \"title\": \"Mecanismo y reversibilidad de la aldol\"\n    },\n    {\n      \"concepts\": [\n        \"Aldol cruzada dirigida\",\n        \"Uso de carbonilo sin hidrógenos alfa\",\n        \"Uso de exceso de un reactivo en aldol cruzada\",\n        \"Adición secuencial por enolato preformado\",\n        \"Aldol de Mukaiyama\",\n        \"Enol éter silílico como donador de Mukaiyama\",\n        \"Activación por Lewis ácido en Mukaiyama\",\n        \"Control de quimioselectividad en aldol cruzada\"\n      ],\n      \"description\": \"Estrategias para obtener un solo producto en aldoles cruzadas mediante elección de sustratos y activación selectiva.\",\n      \"title\": \"Selectividad en aldoles cruzadas\"\n    },\n    {\n      \"concepts\": [\n        \"Reacción de Claisen\",\n        \"Auto-Claisen\",\n        \"Claisen cruzada\",\n        \"Producto β-cetoéster\",\n        \"Paso de desprotonación impulsor\",\n        \"Elección del alcóxido base\",\n        \"Transesterificación competitiva\",\n        \"Claisen intramolecular de Dieckmann\"\n      ],\n      \"description\": \"Formación de enlaces C–C entre ésteres bajo base para dar β-cetoésteres, con variantes cruzadas e intramoleculares.\",\n      \"title\": \"Condensación de Claisen\"\n    },\n    {\n      \"concepts\": [\n        \"Mecanismo de Claisen\",\n        \"Formación del intermedio tetraédrico en Claisen\",\n        \"Eliminación del alcóxido en Claisen\",\n        \"Formación del enolato β-dicarbonilo\",\n        \"Protonación en el trabajo ácido\",\n        \"Retro-Claisen\",\n        \"Irreversibilidad por desprotonación\",\n        \"Requisitos de hidrógeno alfa en Claisen\"\n      ],\n      \"description\": \"Detalles mecanísticos que distinguen Claisen de otras adiciones al carbonilo y condiciones que la hacen avanzar.\",\n      \"title\": \"Mecanismo y conducción de la Claisen\"\n    },\n    {\n      \"concepts\": [\n        \"Compuestos 1,3-dicarbonílicos\",\n        \"Acidez aumentada en 1,3-dicarbonilos\",\n        \"Enolización favorecida en β-dicarbonilos\",\n        \"Quelación en enol de β-dicarbonilos\",\n        \"Alquilación en α de β-dicarbonilos\",\n        \"Acilación en α de β-dicarbonilos\",\n        \"Síntesis del éster acetoacético\",\n        \"Síntesis del malonato\"\n      ],\n      \"description\": \"Propiedades especiales de β-dicarbonilos y su uso como bloques sintéticos para alquilar y luego revelar carbonilos mediante transformaciones posteriores.\",\n      \"title\": \"Química de 1,3-dicarbonilos\"\n    },\n    {\n      \"concepts\": [\n        \"Formación de base de Schiff en catalisis de aminas\",\n        \"Iminio como activador de enonas\",\n        \"Enamina como donador en α\",\n        \"Catálisis de prolina en aldol\",\n        \"Estado de transición tipo Zimmerman Traxler\",\n        \"Control enantioselectivo en aldol organocatalítica\",\n        \"Control diastereoselectivo en aldol organocatalítica\",\n        \"Catálisis en la reacción de Michael\"\n      ],\n      \"description\": \"Uso de organocatálisis por aminas para activar carbonilos como iminios o enaminas y controlar estereoquímica en aldol y Michael.\",\n      \"title\": \"Organocatálisis en reacciones con enolatos\"\n    },\n    {\n      \"concepts\": [\n        \"Diastereoselectividad en aldol\",\n        \"Anti-aldol\",\n        \"Sin-aldol\",\n        \"Modelo de Zimmerman Traxler\",\n        \"Control por geometría E del enolato\",\n        \"Control por geometría Z del enolato\",\n        \"Control por quelación en aldol\",\n        \"Control por no quelación en aldol\"\n      ],\n      \"description\": \"Origen de relaciones sin y anti y cómo la geometría del enolato y la quelación determinan el resultado estereoquímico.\",\n      \"title\": \"Estereoquímica de la reacción aldólica\"\n    },\n    {\n      \"concepts\": [\n        \"Selectividad de sitio en enolización\",\n        \"Selectividad de quimio en presencia de dos carbonilos\",\n        \"Selectividad de quimio en nucleófilo ambidente del enolato\",\n        \"Selectividad de control de base fuerte\",\n        \"Selectividad por protección como acetales\",\n        \"Selectividad por protección como enol éteres silílicos\",\n        \"Selectividad por adición secuencial en cascadas\",\n        \"Selectividad en reacciones en cascada Michael aldol\"\n      ],\n      \"description\": \"Herramientas prácticas para decidir qué posición reacciona, qué funcionalidad se activa y qué trayectoria domina en secuencias con enoles y enolatos.\",\n      \"title\": \"Control de selectividad en química de enolatos\"\n    }\n  ]\n}",
      "outputTokens": 3234,
      "systemPrompt": "# Role\n\nYou are designing an **exhaustive**, well-organized curriculum for a specific chapter in a course.\n\nYou have expertise in instructional design, curriculum development, and creating granular learning paths. You have worked at top educational institutions creating micro-learning content that breaks down complex topics into digestible, single-concept items and organizes them into coherent thematic units.\n\nYour mission is to identify **every single concept** that needs to be taught in this chapter — at the most granular level possible — and then organize those concepts into thematic lesson units.\n\nYou deeply care about making learning accessible, focused, and efficient by breaking down topics into their smallest logical units.\n\n# Inputs\n\n- `COURSE_TITLE`: name of the overall course\n- `CHAPTER_TITLE`: title of this specific chapter\n- `CHAPTER_DESCRIPTION`: what this chapter covers\n- `LANGUAGE`: output language for titles and descriptions\n- `NEIGHBORING_CHAPTERS` (optional): titles and descriptions of chapters that come before and after this one in the course\n\n## Language\n\n- `en`: Use US region unless the content is about a different region.\n- `pt`: Use Brazilian Portuguese unless the content is about a different region.\n- `es`: Use Latin American Spanish unless the content is about a different region.\n\n# Goal\n\nProduce an **exhaustive** set of **single-concept items** that collectively cover everything in `CHAPTER_TITLE` and `CHAPTER_DESCRIPTION`, organized into thematic **lesson units**.\n\nThink of this in three steps:\n\n1. **Enumerate every concept** that needs to be taught. Each concept should be one specific idea — something you could explain in a single short tweet. Be thorough and cover everything.\n\n2. **Filter out neighboring-chapter concepts.** When `NEIGHBORING_CHAPTERS` is provided, remove any concept whose primary subject belongs in a neighboring chapter. Ask: \"Is this concept primarily about THIS chapter's topic, or is it borrowed from an adjacent domain?\" If borrowed, cut it — even if it feels relevant.\n\n3. **Group the remaining concepts** into thematic lesson units of related concepts each. Each lesson is a coherent cluster of related concepts.\n\n# Critical Requirements\n\n## Concept Granularity (MOST IMPORTANT)\n\nThis is the most critical aspect. Each concept must be **one single, specific idea**:\n\n- If you can explain it in **one short tweet**, it's appropriately scoped\n- If it needs more than a tweet, **split it into multiple concepts**\n- Each concept = one fact, one definition, one rule, one technique, one distinction\n\n**Examples of correct granularity:**\n✅ \"Mitosis\"\n✅ \"Meiosis\"\n✅ \"Prophase\"\n✅ \"Metaphase\"\n✅ \"Role of Spindle Fibers\"\n\n**Examples of concepts that are TOO BROAD:**\n❌ \"Cell Division\" → split into: Mitosis, Meiosis, Cytokinesis, etc.\n❌ \"Phases of Mitosis\" → split into: Prophase, Metaphase, Anaphase, Telophase\n\n**The rule**: If a concept title could be a HEADING with sub-items under it, it's too broad. Break it into those sub-items instead.\n\n## Lesson Unit Structure\n\n- Each lesson groups related concepts under a thematic title\n- Include **as many concepts as the theme naturally requires** — some themes need 4, others need 8. Don't force every lesson to the same size\n- If a group would exceed 8 concepts, split it into two lessons with more specific themes\n- If a group would have fewer than 3 concepts, merge it with a related group\n- Lessons should follow a logical progression from foundational to advanced\n- Don't add \"applications\", \"integrated practice\", or \"putting it all together\" lessons — every lesson should teach new concepts, not revisit previous ones\n\n## Exhaustive Coverage\n\n- The total number of concepts across ALL lessons must cover **everything** in the chapter\n- **Do NOT reduce the number of concepts just because you're organizing them into groups**\n- Add **as many concepts as needed** to break down each topic fully\n- Don't limit the number of concepts or lessons arbitrarily\n- It's better to have more fine-grained concepts than fewer broad ones\n- Make sure to have all concepts needed to **fully master the chapter's scope**\n\n## Title Requirements\n\n### Lesson Titles\n\n- Describe the thematic group: e.g. \"Phases of Mitosis\", \"DNA Replication Machinery\"\n- **NEVER** use words like \"learn\", \"understand\", \"explore\", \"introduction to\", \"basics of\"\n- Go straight to the point\n\n### Concept Titles\n\n- Short, specific, focused on a single idea\n- **NEVER** use \"AND\", \"OR\", \"VS\", or their equivalents in other languages (e.g., \"e\", \"ou\", \"y\", \"o\", \"frente a\", \"versus\") — if you find yourself comparing two things, split into separate concepts\n- Must be **concrete and self-explanatory** — a student should know what they'll learn just from reading the title\n- Prefer concrete nouns and actions over abstract/formal terms\n- Concept titles should read like **glossary entries** — factual, teachable items, not interpretive claims or thesis statements\n- Same concise style as: \"What is a Variable?\", \"Integer Numbers\", \"The Addition Operator\", \"Reading a Graduated Cylinder\"\n\n**Too abstract:**\n❌ \"Transcription\" → ✅ \"DNA Transcription\"\n❌ \"Precision\" → ✅ \"Measurement Precision\"\n❌ \"Substitution\" → ✅ \"Nucleophilic Substitution\"\n❌ \"Resolution\" → ✅ \"Instrument Resolution\"\n\n**Too verbose / reads like a description:**\n❌ \"Effect of Power on Relative Uncertainty\"\n❌ \"Decimal Places Compatible with Uncertainty\"\n❌ \"Consistency of Precision Throughout Calculation\"\n\n✅ \"Uncertainty in Powers\"\n✅ \"Matching Decimal Places to Uncertainty\"\n✅ \"Guard Digits\"\n\n**Too interpretive / reads like a thesis:**\n❌ \"Gravity as Geometric Curvature Metaphor\"\n❌ \"Entropy as Information Loss Framework\"\n❌ \"Selection as Optimization Analogy\"\n\n✅ \"Gravitational Curvature\"\n✅ \"Entropy in Thermodynamics\"\n✅ \"Natural Selection Mechanism\"\n\nWhen a concept title is a single generic word, add just enough context to make it concrete and unambiguous. When a concept title reads like a sentence or explanation, shorten it to a noun phrase. When a concept title reads like an essay argument (\"X as Y motif\"), reframe it as a concrete, teachable fact.\n\n### Lesson Descriptions\n\n- 1-2 sentences describing what this group of concepts covers, no fluff\n- **NEVER** start with words like \"introduces\", \"presents\", \"shows\", \"teaches\", \"covers\", \"explains\"\n- Go straight to the content: e.g. \"How the if, else, and elif keywords control which code block runs.\" not \"Introduces the main conditional keywords in Python.\"\n\n## Progression & Structure\n\n- Build a logical progression from basic to advanced concepts\n- Ensure later concepts build on knowledge from earlier ones\n- Focus specifically on THIS chapter, not the entire course\n- Don't add summary, review, \"key concepts\", or \"verification/checklist\" lessons — every lesson must teach new standalone concepts, not meta-skills about checking your own work\n- Don't add assessment, quiz, or project lessons\n\n## Neighboring Chapter Awareness\n\nWhen `NEIGHBORING_CHAPTERS` is provided, use it to strictly avoid generating concepts that belong in another chapter.\n\nFor EACH concept, apply this test: **\"If I removed this concept from my chapter and placed it in the neighboring chapter's list, would it fit naturally there?\"** If yes, it belongs there, not here — remove it.\n\nThis is a common mistake: the model sees a topic as _relevant_ to the chapter and includes it, even though it's _primarily taught_ in a neighboring chapter. Relevance is not enough — the concept must be **primarily about THIS chapter's subject matter**.\n\nFor example, if a neighboring chapter covers \"DevOps and CI/CD\", do not include concepts like \"Deploy Pipeline\" or \"Release Strategy\" — even if they seem useful for your chapter's topic. If a neighboring chapter covers \"SRE and Reliability\", do not include concepts about SLOs or error budgets.\n\nBrief contextual mentions within a concept's explanation are fine, but the concept itself must not be primarily about a neighboring chapter's domain.\n\n# Example\n\nFor a chapter titled \"Control Flow\" in a Python Programming course:\n\n**Lesson: \"Boolean Expressions\"**\nConcepts: What is a Boolean, True Value, False Value, Comparison Operators, Equal To Operator, Not Equal To Operator, Greater Than Operator, Less Than Operator\n\n**Lesson: \"Conditional Statements\"**\nConcepts: The if Statement, The else Clause, The elif Clause, Nested if Statements, Conditional Expressions (Ternary)\n\n**Lesson: \"Logical Operators\"**\nConcepts: The and Operator, The or Operator, The not Operator, Short-Circuit Evaluation, Operator Precedence in Conditions\n\n**Lesson: \"While Loops\"**\nConcepts: What is a Loop, The while Statement, Loop Condition, Infinite Loops, The break Statement, The continue Statement\n\n**Lesson: \"For Loops and Iteration\"**\nConcepts: The for Statement, Iterating Over a List, Iterating Over a String, The range() Function, Nested Loops\n\nNotice how each concept is a **single, specific idea** (not a broad topic), and the lessons group related concepts together thematically.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n1. **Concept granularity**: Can EACH concept be explained in a single tweet? If any concept could have sub-items under it, break it down further.\n2. **No compound concepts**: Does any concept title contain \"AND\", \"OR\", or \"VS\"? If yes, split it.\n3. **Lesson sizes**: Does each lesson have 3-8 concepts? Do lesson sizes vary naturally, or are they all the same number? Split or merge as needed.\n4. **Complete coverage**: Have you covered EVERYTHING from the chapter description?\n5. **Chapter scope**: Did you stay within the chapter's scope?\n6. **No neighboring overlap**: For each concept, if you moved it to a neighboring chapter's list, would it fit naturally there? If yes, remove it — it belongs there, not here.\n\n# Output Format\n\nEach lesson must include:\n\n- **title** — thematic group name\n- **description** — 1-2 sentences describing what this group of concepts covers\n- **concepts** — array of concept titles (short, specific, focused on a single idea each)\n",
      "testCaseId": "es-quimica-carbonilos-enolatos-1",
      "userPrompt": "\n    LANGUAGE: es\n    COURSE_TITLE: Química\n    CHAPTER_TITLE: Carbonilos y enolatos\n    CHAPTER_DESCRIPTION: Adición nucleofílica a carbonilos, química de enoles/enolatos, aldol, Claisen, Michael y control de selectividad.\nNEIGHBORING_CHAPTERS:\n- \"Sustitución y eliminación\": SN1/SN2, E1/E2, reactividad, solventes, nucleófilos/bases, rearrangements y control de selectividad.\n- \"Adiciones a alquenos y alquinos\": Hidrogenación, halogenación, hidratación, hidroboración-oxidación, adiciones conjugadas y química de alquinos.\n- \"Química aromática\": Aromaticidad, sustitución electrofílica/nucleofílica aromática, directores, y reactividad de sistemas aromáticos extendidos.\n- \"Ácidos carboxílicos y derivados\": Reactividad de ácidos carboxílicos, derivados acílicos, química de amidas/ésteres/anhídridos y estrategias de activación.\n- \"Heterociclos\": Síntesis y reactividad de heterociclos aromáticos y saturados; aplicaciones en fármacos y materiales.\n- \"Radicales y fotoquímica orgánica\": Mecanismos radicalarios, iniciación/propagación/terminación, selectividad, y reacciones fotoquímicas orgánicas.\n  "
    },
    {
      "duration": 19035.827082999996,
      "inputTokens": 2538,
      "output": "{\n  \"lessons\": [\n    {\n      \"concepts\": [\n        \"Business cycle definition\",\n        \"Trend component of output\",\n        \"Cyclical component of output\",\n        \"Output gap\",\n        \"Peak in the business cycle\",\n        \"Trough in the business cycle\",\n        \"Expansion phase\",\n        \"Recession phase\"\n      ],\n      \"description\": \"Core terminology for describing fluctuations in aggregate economic activity and how cyclical movements are separated from long-run growth.\",\n      \"title\": \"Business cycle core definitions\"\n    },\n    {\n      \"concepts\": [\n        \"Time aggregation in business cycle data\",\n        \"Frequency of observation in macro series\",\n        \"Seasonal adjustment\",\n        \"Calendar effects in macro data\",\n        \"Real-time data vintages\",\n        \"Data revisions\",\n        \"Measurement error in macro aggregates\",\n        \"Endpoint problem in filtering\"\n      ],\n      \"description\": \"How empirical business cycle facts depend on data frequency, seasonal patterns, revisions, and practical pitfalls in time-series construction.\",\n      \"title\": \"Measurement issues in business cycle facts\"\n    },\n    {\n      \"concepts\": [\n        \"Detrending purpose in business cycle analysis\",\n        \"Linear trend detrending\",\n        \"Quadratic trend detrending\",\n        \"Hodrick–Prescott filter\",\n        \"Band-pass filter\",\n        \"First-differencing for detrending\",\n        \"Log transformation for macro series\"\n      ],\n      \"description\": \"Standard approaches used to separate trend from cycle and to transform macro series for comparability across time and countries.\",\n      \"title\": \"Detrending and filtering methods\"\n    },\n    {\n      \"concepts\": [\n        \"Business cycle volatility\",\n        \"Standard deviation as volatility measure\",\n        \"Relative volatility to output\",\n        \"Variance decomposition across frequencies\",\n        \"Growth rate volatility\",\n        \"Stochastic trend volatility\",\n        \"Coefficient of variation in macro series\"\n      ],\n      \"description\": \"How the amplitude of fluctuations is summarized and compared across variables using common volatility metrics.\",\n      \"title\": \"Volatility measures for cyclical fluctuations\"\n    },\n    {\n      \"concepts\": [\n        \"Business cycle persistence\",\n        \"Autocorrelation of output\",\n        \"Serial correlation in growth rates\",\n        \"Mean reversion in cyclical component\",\n        \"Impulse response persistence interpretation\",\n        \"Duration dependence in recessions\"\n      ],\n      \"description\": \"Empirical ways to describe how long cyclical deviations last and how strongly shocks propagate over time.\",\n      \"title\": \"Persistence and duration of cycles\"\n    },\n    {\n      \"concepts\": [\n        \"Comovement definition\",\n        \"Contemporaneous correlation\",\n        \"Cross-correlation function\",\n        \"Lead-lag relationship\",\n        \"Phase shift across variables\",\n        \"Procyclical variable\",\n        \"Countercyclical variable\",\n        \"Acyclical variable\"\n      ],\n      \"description\": \"Tools for documenting which variables move together with output, whether they lead or lag, and how their cyclical sign is classified.\",\n      \"title\": \"Comovement concepts and lead-lag patterns\"\n    },\n    {\n      \"concepts\": [\n        \"Cyclical classification of consumption\",\n        \"Cyclical classification of investment\",\n        \"Cyclical classification of government purchases\",\n        \"Cyclical classification of net exports\",\n        \"Inventory investment cyclicality\",\n        \"Durables cyclicality\"\n      ],\n      \"description\": \"Stylized cyclical behavior of major expenditure components relative to aggregate output.\",\n      \"title\": \"Cyclical facts for expenditure components\"\n    },\n    {\n      \"concepts\": [\n        \"Okun’s law relationship\",\n        \"Output–unemployment correlation sign\",\n        \"Cyclical unemployment component\",\n        \"Jobless recovery\",\n        \"Employment cyclicality\",\n        \"Hours worked cyclicality\",\n        \"Labor force participation cyclicality\"\n      ],\n      \"description\": \"Empirical regularities linking downturns to labor market outcomes at the level of aggregate fluctuations, without modeling search or wage-setting mechanisms.\",\n      \"title\": \"Labor market aggregates over the cycle\"\n    },\n    {\n      \"concepts\": [\n        \"Phillips curve comovement fact\",\n        \"Inflation cyclicality sign\",\n        \"Disinflation in recessions\",\n        \"Inflation persistence\",\n        \"Inflation volatility over the cycle\",\n        \"Deflation episodes in deep downturns\"\n      ],\n      \"description\": \"Stylized cyclical behavior of inflation and its typical timing and persistence around recessions and expansions.\",\n      \"title\": \"Inflation behavior over the business cycle\"\n    },\n    {\n      \"concepts\": [\n        \"Nominal interest rate cyclicality\",\n        \"Real interest rate cyclicality\",\n        \"Yield curve slope as a leading indicator\",\n        \"Credit spread cyclicality\",\n        \"Risk premium cyclicality\",\n        \"Term premium cyclicality\"\n      ],\n      \"description\": \"Empirical patterns in interest rates and spreads across the cycle and their common leading-indicator interpretations.\",\n      \"title\": \"Interest rates and spreads over the cycle\"\n    },\n    {\n      \"concepts\": [\n        \"Broad money growth cyclicality\",\n        \"Bank lending cyclicality\",\n        \"Credit-to-GDP gap\",\n        \"Leverage cyclicality\",\n        \"Default rate cyclicality\",\n        \"Bankruptcy rate cyclicality\"\n      ],\n      \"description\": \"How quantities of credit and measures of borrower stress typically move during booms and recessions.\",\n      \"title\": \"Credit quantities and financial stress over the cycle\"\n    },\n    {\n      \"concepts\": [\n        \"Total factor productivity cyclicality\",\n        \"Labor productivity cyclicality\",\n        \"Procyclical productivity\",\n        \"Countercyclical productivity\",\n        \"Procyclical utilization\",\n        \"Labor hoarding interpretation\"\n      ],\n      \"description\": \"Stylized productivity patterns in booms and recessions and the common measurement interpretations tied to utilization and labor hoarding.\",\n      \"title\": \"Productivity over the cycle\"\n    },\n    {\n      \"concepts\": [\n        \"Capacity utilization cyclicality\",\n        \"Overtime hours cyclicality\",\n        \"Vacancy posting cyclicality\",\n        \"Quit rate cyclicality\",\n        \"New business formation cyclicality\",\n        \"Firm entry cyclicality\",\n        \"Firm exit cyclicality\"\n      ],\n      \"description\": \"Business cycle comovement in utilization, hiring-related quantities, and firm dynamics commonly used to characterize expansions and downturns.\",\n      \"title\": \"Utilization and firm dynamics\"\n    },\n    {\n      \"concepts\": [\n        \"Sectoral comovement concept\",\n        \"Industry output comovement\",\n        \"Manufacturing cyclicality\",\n        \"Construction cyclicality\",\n        \"Services cyclicality\",\n        \"Commodity sector cyclicality\",\n        \"Cross-sector correlation matrix\"\n      ],\n      \"description\": \"How cyclical fluctuations differ by sector and how sector outputs correlate over the aggregate cycle.\",\n      \"title\": \"Comovements across sectors\"\n    },\n    {\n      \"concepts\": [\n        \"Synchronized recessions across countries\",\n        \"International output correlation\",\n        \"Global business cycle factor\",\n        \"Trade volume cyclicality\",\n        \"Capital flow cyclicality\",\n        \"Exchange rate cyclicality\",\n        \"Sudden stop as cyclical event\"\n      ],\n      \"description\": \"Cross-country comovements and how trade and financial linkages show up as synchronized booms and recessions.\",\n      \"title\": \"International comovement facts\"\n    },\n    {\n      \"concepts\": [\n        \"NBER recession dating\",\n        \"Turning point dating algorithms\",\n        \"Recession depth metric\",\n        \"Recession duration metric\",\n        \"Cumulative output loss\",\n        \"Recovery speed metric\",\n        \"Double-dip recession\"\n      ],\n      \"description\": \"How recessions are dated and summarized using standardized metrics for timing, severity, and recovery patterns.\",\n      \"title\": \"Recession dating and recession metrics\"\n    }\n  ]\n}",
      "outputTokens": 1185,
      "systemPrompt": "# Role\n\nYou are designing an **exhaustive**, well-organized curriculum for a specific chapter in a course.\n\nYou have expertise in instructional design, curriculum development, and creating granular learning paths. You have worked at top educational institutions creating micro-learning content that breaks down complex topics into digestible, single-concept items and organizes them into coherent thematic units.\n\nYour mission is to identify **every single concept** that needs to be taught in this chapter — at the most granular level possible — and then organize those concepts into thematic lesson units.\n\nYou deeply care about making learning accessible, focused, and efficient by breaking down topics into their smallest logical units.\n\n# Inputs\n\n- `COURSE_TITLE`: name of the overall course\n- `CHAPTER_TITLE`: title of this specific chapter\n- `CHAPTER_DESCRIPTION`: what this chapter covers\n- `LANGUAGE`: output language for titles and descriptions\n- `NEIGHBORING_CHAPTERS` (optional): titles and descriptions of chapters that come before and after this one in the course\n\n## Language\n\n- `en`: Use US region unless the content is about a different region.\n- `pt`: Use Brazilian Portuguese unless the content is about a different region.\n- `es`: Use Latin American Spanish unless the content is about a different region.\n\n# Goal\n\nProduce an **exhaustive** set of **single-concept items** that collectively cover everything in `CHAPTER_TITLE` and `CHAPTER_DESCRIPTION`, organized into thematic **lesson units**.\n\nThink of this in three steps:\n\n1. **Enumerate every concept** that needs to be taught. Each concept should be one specific idea — something you could explain in a single short tweet. Be thorough and cover everything.\n\n2. **Filter out neighboring-chapter concepts.** When `NEIGHBORING_CHAPTERS` is provided, remove any concept whose primary subject belongs in a neighboring chapter. Ask: \"Is this concept primarily about THIS chapter's topic, or is it borrowed from an adjacent domain?\" If borrowed, cut it — even if it feels relevant.\n\n3. **Group the remaining concepts** into thematic lesson units of related concepts each. Each lesson is a coherent cluster of related concepts.\n\n# Critical Requirements\n\n## Concept Granularity (MOST IMPORTANT)\n\nThis is the most critical aspect. Each concept must be **one single, specific idea**:\n\n- If you can explain it in **one short tweet**, it's appropriately scoped\n- If it needs more than a tweet, **split it into multiple concepts**\n- Each concept = one fact, one definition, one rule, one technique, one distinction\n\n**Examples of correct granularity:**\n✅ \"Mitosis\"\n✅ \"Meiosis\"\n✅ \"Prophase\"\n✅ \"Metaphase\"\n✅ \"Role of Spindle Fibers\"\n\n**Examples of concepts that are TOO BROAD:**\n❌ \"Cell Division\" → split into: Mitosis, Meiosis, Cytokinesis, etc.\n❌ \"Phases of Mitosis\" → split into: Prophase, Metaphase, Anaphase, Telophase\n\n**The rule**: If a concept title could be a HEADING with sub-items under it, it's too broad. Break it into those sub-items instead.\n\n## Lesson Unit Structure\n\n- Each lesson groups related concepts under a thematic title\n- Include **as many concepts as the theme naturally requires** — some themes need 4, others need 8. Don't force every lesson to the same size\n- If a group would exceed 8 concepts, split it into two lessons with more specific themes\n- If a group would have fewer than 3 concepts, merge it with a related group\n- Lessons should follow a logical progression from foundational to advanced\n- Don't add \"applications\", \"integrated practice\", or \"putting it all together\" lessons — every lesson should teach new concepts, not revisit previous ones\n\n## Exhaustive Coverage\n\n- The total number of concepts across ALL lessons must cover **everything** in the chapter\n- **Do NOT reduce the number of concepts just because you're organizing them into groups**\n- Add **as many concepts as needed** to break down each topic fully\n- Don't limit the number of concepts or lessons arbitrarily\n- It's better to have more fine-grained concepts than fewer broad ones\n- Make sure to have all concepts needed to **fully master the chapter's scope**\n\n## Title Requirements\n\n### Lesson Titles\n\n- Describe the thematic group: e.g. \"Phases of Mitosis\", \"DNA Replication Machinery\"\n- **NEVER** use words like \"learn\", \"understand\", \"explore\", \"introduction to\", \"basics of\"\n- Go straight to the point\n\n### Concept Titles\n\n- Short, specific, focused on a single idea\n- **NEVER** use \"AND\", \"OR\", \"VS\", or their equivalents in other languages (e.g., \"e\", \"ou\", \"y\", \"o\", \"frente a\", \"versus\") — if you find yourself comparing two things, split into separate concepts\n- Must be **concrete and self-explanatory** — a student should know what they'll learn just from reading the title\n- Prefer concrete nouns and actions over abstract/formal terms\n- Concept titles should read like **glossary entries** — factual, teachable items, not interpretive claims or thesis statements\n- Same concise style as: \"What is a Variable?\", \"Integer Numbers\", \"The Addition Operator\", \"Reading a Graduated Cylinder\"\n\n**Too abstract:**\n❌ \"Transcription\" → ✅ \"DNA Transcription\"\n❌ \"Precision\" → ✅ \"Measurement Precision\"\n❌ \"Substitution\" → ✅ \"Nucleophilic Substitution\"\n❌ \"Resolution\" → ✅ \"Instrument Resolution\"\n\n**Too verbose / reads like a description:**\n❌ \"Effect of Power on Relative Uncertainty\"\n❌ \"Decimal Places Compatible with Uncertainty\"\n❌ \"Consistency of Precision Throughout Calculation\"\n\n✅ \"Uncertainty in Powers\"\n✅ \"Matching Decimal Places to Uncertainty\"\n✅ \"Guard Digits\"\n\n**Too interpretive / reads like a thesis:**\n❌ \"Gravity as Geometric Curvature Metaphor\"\n❌ \"Entropy as Information Loss Framework\"\n❌ \"Selection as Optimization Analogy\"\n\n✅ \"Gravitational Curvature\"\n✅ \"Entropy in Thermodynamics\"\n✅ \"Natural Selection Mechanism\"\n\nWhen a concept title is a single generic word, add just enough context to make it concrete and unambiguous. When a concept title reads like a sentence or explanation, shorten it to a noun phrase. When a concept title reads like an essay argument (\"X as Y motif\"), reframe it as a concrete, teachable fact.\n\n### Lesson Descriptions\n\n- 1-2 sentences describing what this group of concepts covers, no fluff\n- **NEVER** start with words like \"introduces\", \"presents\", \"shows\", \"teaches\", \"covers\", \"explains\"\n- Go straight to the content: e.g. \"How the if, else, and elif keywords control which code block runs.\" not \"Introduces the main conditional keywords in Python.\"\n\n## Progression & Structure\n\n- Build a logical progression from basic to advanced concepts\n- Ensure later concepts build on knowledge from earlier ones\n- Focus specifically on THIS chapter, not the entire course\n- Don't add summary, review, \"key concepts\", or \"verification/checklist\" lessons — every lesson must teach new standalone concepts, not meta-skills about checking your own work\n- Don't add assessment, quiz, or project lessons\n\n## Neighboring Chapter Awareness\n\nWhen `NEIGHBORING_CHAPTERS` is provided, use it to strictly avoid generating concepts that belong in another chapter.\n\nFor EACH concept, apply this test: **\"If I removed this concept from my chapter and placed it in the neighboring chapter's list, would it fit naturally there?\"** If yes, it belongs there, not here — remove it.\n\nThis is a common mistake: the model sees a topic as _relevant_ to the chapter and includes it, even though it's _primarily taught_ in a neighboring chapter. Relevance is not enough — the concept must be **primarily about THIS chapter's subject matter**.\n\nFor example, if a neighboring chapter covers \"DevOps and CI/CD\", do not include concepts like \"Deploy Pipeline\" or \"Release Strategy\" — even if they seem useful for your chapter's topic. If a neighboring chapter covers \"SRE and Reliability\", do not include concepts about SLOs or error budgets.\n\nBrief contextual mentions within a concept's explanation are fine, but the concept itself must not be primarily about a neighboring chapter's domain.\n\n# Example\n\nFor a chapter titled \"Control Flow\" in a Python Programming course:\n\n**Lesson: \"Boolean Expressions\"**\nConcepts: What is a Boolean, True Value, False Value, Comparison Operators, Equal To Operator, Not Equal To Operator, Greater Than Operator, Less Than Operator\n\n**Lesson: \"Conditional Statements\"**\nConcepts: The if Statement, The else Clause, The elif Clause, Nested if Statements, Conditional Expressions (Ternary)\n\n**Lesson: \"Logical Operators\"**\nConcepts: The and Operator, The or Operator, The not Operator, Short-Circuit Evaluation, Operator Precedence in Conditions\n\n**Lesson: \"While Loops\"**\nConcepts: What is a Loop, The while Statement, Loop Condition, Infinite Loops, The break Statement, The continue Statement\n\n**Lesson: \"For Loops and Iteration\"**\nConcepts: The for Statement, Iterating Over a List, Iterating Over a String, The range() Function, Nested Loops\n\nNotice how each concept is a **single, specific idea** (not a broad topic), and the lessons group related concepts together thematically.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n1. **Concept granularity**: Can EACH concept be explained in a single tweet? If any concept could have sub-items under it, break it down further.\n2. **No compound concepts**: Does any concept title contain \"AND\", \"OR\", or \"VS\"? If yes, split it.\n3. **Lesson sizes**: Does each lesson have 3-8 concepts? Do lesson sizes vary naturally, or are they all the same number? Split or merge as needed.\n4. **Complete coverage**: Have you covered EVERYTHING from the chapter description?\n5. **Chapter scope**: Did you stay within the chapter's scope?\n6. **No neighboring overlap**: For each concept, if you moved it to a neighboring chapter's list, would it fit naturally there? If yes, remove it — it belongs there, not here.\n\n# Output Format\n\nEach lesson must include:\n\n- **title** — thematic group name\n- **description** — 1-2 sentences describing what this group of concepts covers\n- **concepts** — array of concept titles (short, specific, focused on a single idea each)\n",
      "testCaseId": "en-economics-business-cycles-1",
      "userPrompt": "\n    LANGUAGE: en\n    COURSE_TITLE: Economics\n    CHAPTER_TITLE: Business cycles\n    CHAPTER_DESCRIPTION: Business cycle facts, stylized patterns in output, inflation, unemployment, productivity, and comovements across sectors.\nNEIGHBORING_CHAPTERS:\n- \"Behavioral economics\": Behavioral biases, bounded rationality, time inconsistency, social preferences, and policy design with behavioral responses.\n- \"Experimental economics\": Laboratory and field experiments, incentive design, external validity, and behavioral/market design evidence.\n- \"Macroeconomic accounting\": National income and product accounts, sectoral balances, price indices, productivity, and flow-of-funds concepts.\n- \"Consumption and savings\": Consumption-saving, life-cycle and permanent income models, liquidity constraints, and empirical puzzles.\n- \"Investment and capital\": Investment theory, q-models, adjustment costs, irreversibility, and firm-level investment dynamics.\n- \"Unemployment and labor in macro\": Labor markets in macro, search and matching, wage setting, unemployment dynamics, and Beveridge curve analysis.\n  "
    },
    {
      "duration": 20572.0675,
      "inputTokens": 2608,
      "output": "{\n  \"lessons\": [\n    {\n      \"concepts\": [\n        \"Arquitetura evolutiva\",\n        \"Trabalho arquitetural incremental\",\n        \"Arquitetura como hipótese\",\n        \"Arquitetura como produto contínuo\",\n        \"Emersão arquitetural orientada a feedback\",\n        \"Arquitetura intencional mínima\"\n      ],\n      \"description\": \"Princípios e postura de arquitetura voltados a mudanças frequentes, com decisões e estrutura evoluindo por incrementos guiados por feedback e aprendizado.\",\n      \"title\": \"Arquitetura evolutiva em ambientes ágeis\"\n    },\n    {\n      \"concepts\": [\n        \"Atributos de qualidade arquitetural\",\n        \"Requisitos não funcionais como restrições\",\n        \"Requisitos de qualidade como trade-offs\",\n        \"Cenários de atributos de qualidade\",\n        \"Táticas arquiteturais\",\n        \"Riscos arquiteturais\"\n      ],\n      \"description\": \"Como requisitos de qualidade moldam estrutura e escolhas arquiteturais, traduzidos em cenários, táticas e avaliação de riscos e trade-offs.\",\n      \"title\": \"Requisitos de qualidade na arquitetura ágil\"\n    },\n    {\n      \"concepts\": [\n        \"Modularidade\",\n        \"Decomposição em módulos\",\n        \"Fronteiras de módulo\",\n        \"Responsabilidade única de módulo\",\n        \"Encapsulamento\",\n        \"Visibilidade de dependências\",\n        \"API de módulo\",\n        \"Estabilidade de interfaces\"\n      ],\n      \"description\": \"Estrutura modular para permitir evolução local, com fronteiras claras, encapsulamento e contratos estáveis entre partes do sistema.\",\n      \"title\": \"Modularidade e fronteiras arquiteturais\"\n    },\n    {\n      \"concepts\": [\n        \"Coesão\",\n        \"Coesão funcional\",\n        \"Coesão informacional\",\n        \"Sinais de baixa coesão\",\n        \"Acoplamento\",\n        \"Acoplamento aferente\",\n        \"Acoplamento eferente\",\n        \"Sinais de alto acoplamento\"\n      ],\n      \"description\": \"Como medir e raciocinar sobre coesão e acoplamento, reconhecendo sinais que indicam fragilidade e dificuldade de mudança.\",\n      \"title\": \"Coesão e acoplamento como propriedades arquiteturais\"\n    },\n    {\n      \"concepts\": [\n        \"Acoplamento temporal\",\n        \"Acoplamento de dados\",\n        \"Acoplamento de controle\",\n        \"Acoplamento por conhecimento interno\",\n        \"Acoplamento por plataforma\",\n        \"Acoplamento organizacional\"\n      ],\n      \"description\": \"Tipos comuns de acoplamento que prejudicam evolução e autonomia, com foco em reconhecer o mecanismo de dependência envolvido.\",\n      \"title\": \"Tipos de acoplamento relevantes para mudança frequente\"\n    },\n    {\n      \"concepts\": [\n        \"Lei de Conway\",\n        \"Alinhamento entre módulos e times\",\n        \"Fronteiras sociotécnicas\",\n        \"Custo de coordenação como força arquitetural\",\n        \"Arquitetura para autonomia de times\",\n        \"Arquitetura para fluxo de mudanças\"\n      ],\n      \"description\": \"Como estrutura de equipes influencia estrutura de software e como desenhar fronteiras que reduzam coordenação e acelerem mudanças.\",\n      \"title\": \"Arquitetura sociotécnica em contextos ágeis\"\n    },\n    {\n      \"concepts\": [\n        \"Arquitetura de fluxo de mudanças\",\n        \"Mudança local\",\n        \"Propagação de mudanças\",\n        \"Superfícies de mudança\",\n        \"Hotspots arquiteturais\",\n        \"Efeito cascata de dependências\"\n      ],\n      \"description\": \"Maneiras de projetar e avaliar a arquitetura pelo impacto que pequenas mudanças têm no restante do sistema.\",\n      \"title\": \"Mudança como unidade de análise arquitetural\"\n    },\n    {\n      \"concepts\": [\n        \"Decisão arquitetural\",\n        \"Registro de decisão arquitetural\",\n        \"Contexto de decisão\",\n        \"Forças de decisão\",\n        \"Alternativas arquiteturais\",\n        \"Consequências de decisão\",\n        \"Reversibilidade de decisão\",\n        \"Prazo de validade de decisão\"\n      ],\n      \"description\": \"Como formular, registrar e revisar decisões arquiteturais de modo compatível com evolução contínua e aprendizado.\",\n      \"title\": \"Decisões arquiteturais e registro de decisões\"\n    },\n    {\n      \"concepts\": [\n        \"Decisões reversíveis\",\n        \"Decisões irreversíveis\",\n        \"Último momento responsável\",\n        \"Opções reais em arquitetura\",\n        \"Custo de reversão\",\n        \"Estratégias de reversibilidade\",\n        \"Protótipos arquiteturais\",\n        \"Spikes arquiteturais\"\n      ],\n      \"description\": \"Como manter opções abertas e reduzir custo de arrependimento por meio de reversibilidade, experimentos e decisões no timing adequado.\",\n      \"title\": \"Reversibilidade e timing de decisões arquiteturais\"\n    },\n    {\n      \"concepts\": [\n        \"Fitness function arquitetural\",\n        \"Fitness function automatizada\",\n        \"Fitness function manual\",\n        \"Fitness function como limite de segurança\",\n        \"Fitness function de arquitetura modular\",\n        \"Fitness function de dependências\",\n        \"Fitness function de acoplamento\",\n        \"Threshold de fitness function\"\n      ],\n      \"description\": \"Como definir funções de adequação para verificar continuamente propriedades arquiteturais desejadas e bloquear regressões.\",\n      \"title\": \"Fitness functions para governança contínua\"\n    },\n    {\n      \"concepts\": [\n        \"Observabilidade arquitetural\",\n        \"Métricas arquiteturais\",\n        \"Indicadores de modularidade\",\n        \"Indicadores de acoplamento\",\n        \"Complexidade estrutural\",\n        \"Entropia de dependências\",\n        \"Tendência de degradação arquitetural\",\n        \"Alertas de regressão arquitetural\"\n      ],\n      \"description\": \"Como acompanhar sinais quantitativos e qualitativos de saúde arquitetural ao longo do tempo para orientar intervenção precoce.\",\n      \"title\": \"Medição e monitoramento de propriedades arquiteturais\"\n    },\n    {\n      \"concepts\": [\n        \"Acoplamento por contrato\",\n        \"Versionamento de interface\",\n        \"Compatibilidade retroativa\",\n        \"Evolução de contrato\",\n        \"Estrangulamento de interface\",\n        \"Anti-corrupção de modelo\",\n        \"Tradução entre modelos\",\n        \"Tolerância a mudanças\"\n      ],\n      \"description\": \"Técnicas para permitir evolução independente entre módulos por meio de contratos, compatibilidade e camadas de proteção.\",\n      \"title\": \"Evolução de interfaces e contratos entre módulos\"\n    },\n    {\n      \"concepts\": [\n        \"Consistência interna de módulo\",\n        \"Invariantes de módulo\",\n        \"Limites transacionais em módulos\",\n        \"Coerência de dados por módulo\",\n        \"Propriedade de dados\",\n        \"Fluxo de dados entre módulos\",\n        \"Duplicação deliberada\",\n        \"Sincronização entre módulos\"\n      ],\n      \"description\": \"Como organizar responsabilidades e dados para reduzir dependências, definindo invariantes e regras de interação entre módulos.\",\n      \"title\": \"Responsabilidades e dados em uma arquitetura modular\"\n    },\n    {\n      \"concepts\": [\n        \"Governança arquitetural leve\",\n        \"Guardiões de arquitetura\",\n        \"Padrões arquiteturais permitidos\",\n        \"Padrões arquiteturais proibidos\",\n        \"Regras de dependência\",\n        \"Políticas de exceção\",\n        \"Revisões arquiteturais contínuas\",\n        \"Evolução de padrões ao longo do tempo\"\n      ],\n      \"description\": \"Mecanismos de governança com baixo atrito para manter consistência e permitir evolução, combinando regras, exceções e revisão contínua.\",\n      \"title\": \"Governança arquitetural em times ágeis\"\n    }\n  ]\n}",
      "outputTokens": 1277,
      "systemPrompt": "# Role\n\nYou are designing an **exhaustive**, well-organized curriculum for a specific chapter in a course.\n\nYou have expertise in instructional design, curriculum development, and creating granular learning paths. You have worked at top educational institutions creating micro-learning content that breaks down complex topics into digestible, single-concept items and organizes them into coherent thematic units.\n\nYour mission is to identify **every single concept** that needs to be taught in this chapter — at the most granular level possible — and then organize those concepts into thematic lesson units.\n\nYou deeply care about making learning accessible, focused, and efficient by breaking down topics into their smallest logical units.\n\n# Inputs\n\n- `COURSE_TITLE`: name of the overall course\n- `CHAPTER_TITLE`: title of this specific chapter\n- `CHAPTER_DESCRIPTION`: what this chapter covers\n- `LANGUAGE`: output language for titles and descriptions\n- `NEIGHBORING_CHAPTERS` (optional): titles and descriptions of chapters that come before and after this one in the course\n\n## Language\n\n- `en`: Use US region unless the content is about a different region.\n- `pt`: Use Brazilian Portuguese unless the content is about a different region.\n- `es`: Use Latin American Spanish unless the content is about a different region.\n\n# Goal\n\nProduce an **exhaustive** set of **single-concept items** that collectively cover everything in `CHAPTER_TITLE` and `CHAPTER_DESCRIPTION`, organized into thematic **lesson units**.\n\nThink of this in three steps:\n\n1. **Enumerate every concept** that needs to be taught. Each concept should be one specific idea — something you could explain in a single short tweet. Be thorough and cover everything.\n\n2. **Filter out neighboring-chapter concepts.** When `NEIGHBORING_CHAPTERS` is provided, remove any concept whose primary subject belongs in a neighboring chapter. Ask: \"Is this concept primarily about THIS chapter's topic, or is it borrowed from an adjacent domain?\" If borrowed, cut it — even if it feels relevant.\n\n3. **Group the remaining concepts** into thematic lesson units of related concepts each. Each lesson is a coherent cluster of related concepts.\n\n# Critical Requirements\n\n## Concept Granularity (MOST IMPORTANT)\n\nThis is the most critical aspect. Each concept must be **one single, specific idea**:\n\n- If you can explain it in **one short tweet**, it's appropriately scoped\n- If it needs more than a tweet, **split it into multiple concepts**\n- Each concept = one fact, one definition, one rule, one technique, one distinction\n\n**Examples of correct granularity:**\n✅ \"Mitosis\"\n✅ \"Meiosis\"\n✅ \"Prophase\"\n✅ \"Metaphase\"\n✅ \"Role of Spindle Fibers\"\n\n**Examples of concepts that are TOO BROAD:**\n❌ \"Cell Division\" → split into: Mitosis, Meiosis, Cytokinesis, etc.\n❌ \"Phases of Mitosis\" → split into: Prophase, Metaphase, Anaphase, Telophase\n\n**The rule**: If a concept title could be a HEADING with sub-items under it, it's too broad. Break it into those sub-items instead.\n\n## Lesson Unit Structure\n\n- Each lesson groups related concepts under a thematic title\n- Include **as many concepts as the theme naturally requires** — some themes need 4, others need 8. Don't force every lesson to the same size\n- If a group would exceed 8 concepts, split it into two lessons with more specific themes\n- If a group would have fewer than 3 concepts, merge it with a related group\n- Lessons should follow a logical progression from foundational to advanced\n- Don't add \"applications\", \"integrated practice\", or \"putting it all together\" lessons — every lesson should teach new concepts, not revisit previous ones\n\n## Exhaustive Coverage\n\n- The total number of concepts across ALL lessons must cover **everything** in the chapter\n- **Do NOT reduce the number of concepts just because you're organizing them into groups**\n- Add **as many concepts as needed** to break down each topic fully\n- Don't limit the number of concepts or lessons arbitrarily\n- It's better to have more fine-grained concepts than fewer broad ones\n- Make sure to have all concepts needed to **fully master the chapter's scope**\n\n## Title Requirements\n\n### Lesson Titles\n\n- Describe the thematic group: e.g. \"Phases of Mitosis\", \"DNA Replication Machinery\"\n- **NEVER** use words like \"learn\", \"understand\", \"explore\", \"introduction to\", \"basics of\"\n- Go straight to the point\n\n### Concept Titles\n\n- Short, specific, focused on a single idea\n- **NEVER** use \"AND\", \"OR\", \"VS\", or their equivalents in other languages (e.g., \"e\", \"ou\", \"y\", \"o\", \"frente a\", \"versus\") — if you find yourself comparing two things, split into separate concepts\n- Must be **concrete and self-explanatory** — a student should know what they'll learn just from reading the title\n- Prefer concrete nouns and actions over abstract/formal terms\n- Concept titles should read like **glossary entries** — factual, teachable items, not interpretive claims or thesis statements\n- Same concise style as: \"What is a Variable?\", \"Integer Numbers\", \"The Addition Operator\", \"Reading a Graduated Cylinder\"\n\n**Too abstract:**\n❌ \"Transcription\" → ✅ \"DNA Transcription\"\n❌ \"Precision\" → ✅ \"Measurement Precision\"\n❌ \"Substitution\" → ✅ \"Nucleophilic Substitution\"\n❌ \"Resolution\" → ✅ \"Instrument Resolution\"\n\n**Too verbose / reads like a description:**\n❌ \"Effect of Power on Relative Uncertainty\"\n❌ \"Decimal Places Compatible with Uncertainty\"\n❌ \"Consistency of Precision Throughout Calculation\"\n\n✅ \"Uncertainty in Powers\"\n✅ \"Matching Decimal Places to Uncertainty\"\n✅ \"Guard Digits\"\n\n**Too interpretive / reads like a thesis:**\n❌ \"Gravity as Geometric Curvature Metaphor\"\n❌ \"Entropy as Information Loss Framework\"\n❌ \"Selection as Optimization Analogy\"\n\n✅ \"Gravitational Curvature\"\n✅ \"Entropy in Thermodynamics\"\n✅ \"Natural Selection Mechanism\"\n\nWhen a concept title is a single generic word, add just enough context to make it concrete and unambiguous. When a concept title reads like a sentence or explanation, shorten it to a noun phrase. When a concept title reads like an essay argument (\"X as Y motif\"), reframe it as a concrete, teachable fact.\n\n### Lesson Descriptions\n\n- 1-2 sentences describing what this group of concepts covers, no fluff\n- **NEVER** start with words like \"introduces\", \"presents\", \"shows\", \"teaches\", \"covers\", \"explains\"\n- Go straight to the content: e.g. \"How the if, else, and elif keywords control which code block runs.\" not \"Introduces the main conditional keywords in Python.\"\n\n## Progression & Structure\n\n- Build a logical progression from basic to advanced concepts\n- Ensure later concepts build on knowledge from earlier ones\n- Focus specifically on THIS chapter, not the entire course\n- Don't add summary, review, \"key concepts\", or \"verification/checklist\" lessons — every lesson must teach new standalone concepts, not meta-skills about checking your own work\n- Don't add assessment, quiz, or project lessons\n\n## Neighboring Chapter Awareness\n\nWhen `NEIGHBORING_CHAPTERS` is provided, use it to strictly avoid generating concepts that belong in another chapter.\n\nFor EACH concept, apply this test: **\"If I removed this concept from my chapter and placed it in the neighboring chapter's list, would it fit naturally there?\"** If yes, it belongs there, not here — remove it.\n\nThis is a common mistake: the model sees a topic as _relevant_ to the chapter and includes it, even though it's _primarily taught_ in a neighboring chapter. Relevance is not enough — the concept must be **primarily about THIS chapter's subject matter**.\n\nFor example, if a neighboring chapter covers \"DevOps and CI/CD\", do not include concepts like \"Deploy Pipeline\" or \"Release Strategy\" — even if they seem useful for your chapter's topic. If a neighboring chapter covers \"SRE and Reliability\", do not include concepts about SLOs or error budgets.\n\nBrief contextual mentions within a concept's explanation are fine, but the concept itself must not be primarily about a neighboring chapter's domain.\n\n# Example\n\nFor a chapter titled \"Control Flow\" in a Python Programming course:\n\n**Lesson: \"Boolean Expressions\"**\nConcepts: What is a Boolean, True Value, False Value, Comparison Operators, Equal To Operator, Not Equal To Operator, Greater Than Operator, Less Than Operator\n\n**Lesson: \"Conditional Statements\"**\nConcepts: The if Statement, The else Clause, The elif Clause, Nested if Statements, Conditional Expressions (Ternary)\n\n**Lesson: \"Logical Operators\"**\nConcepts: The and Operator, The or Operator, The not Operator, Short-Circuit Evaluation, Operator Precedence in Conditions\n\n**Lesson: \"While Loops\"**\nConcepts: What is a Loop, The while Statement, Loop Condition, Infinite Loops, The break Statement, The continue Statement\n\n**Lesson: \"For Loops and Iteration\"**\nConcepts: The for Statement, Iterating Over a List, Iterating Over a String, The range() Function, Nested Loops\n\nNotice how each concept is a **single, specific idea** (not a broad topic), and the lessons group related concepts together thematically.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n1. **Concept granularity**: Can EACH concept be explained in a single tweet? If any concept could have sub-items under it, break it down further.\n2. **No compound concepts**: Does any concept title contain \"AND\", \"OR\", or \"VS\"? If yes, split it.\n3. **Lesson sizes**: Does each lesson have 3-8 concepts? Do lesson sizes vary naturally, or are they all the same number? Split or merge as needed.\n4. **Complete coverage**: Have you covered EVERYTHING from the chapter description?\n5. **Chapter scope**: Did you stay within the chapter's scope?\n6. **No neighboring overlap**: For each concept, if you moved it to a neighboring chapter's list, would it fit naturally there? If yes, remove it — it belongs there, not here.\n\n# Output Format\n\nEach lesson must include:\n\n- **title** — thematic group name\n- **description** — 1-2 sentences describing what this group of concepts covers\n- **concepts** — array of concept titles (short, specific, focused on a single idea each)\n",
      "testCaseId": "pt-agile-arquitetura-agil-1",
      "userPrompt": "\n    LANGUAGE: pt\n    COURSE_TITLE: Metodologias Ágeis\n    CHAPTER_TITLE: Arquitetura em ambientes ágeis\n    CHAPTER_DESCRIPTION: Arquitetura evolutiva, modularidade, acoplamento/cohesão, fitness functions e decisões arquiteturais compatíveis com mudanças frequentes.\nNEIGHBORING_CHAPTERS:\n- \"Discovery e Delivery integrados\": Dual Track (Discovery/Delivery), discovery contínuo, e prevenção de 'teatro ágil' com entrega sem aprendizado.\n- \"DevOps e entrega contínua\": DevOps: colaboração Dev+Ops, automação, pipelines, IaC, e redução de handoffs para acelerar e estabilizar entregas.\n- \"SRE e confiabilidade em produtos digitais\": SRE: SLIs/SLOs, error budget, confiabilidade como requisito, e equilíbrio entre velocidade e estabilidade.\n- \"Dívida técnica e sustentabilidade\": Gestão de dívida técnica, qualidade interna, refatoração estratégica, e mecanismos de priorização junto ao valor de negócio.\n- \"Estratégias modernas de testes\": Qualidade e testes: pirâmide de testes, testes automatizados, testes exploratórios, e estratégias para sistemas distribuídos.\n- \"Segurança e DevSecOps\": Segurança no ciclo ágil: threat modeling, DevSecOps, shift-left, gestão de vulnerabilidades e resposta a incidentes.\n  "
    },
    {
      "duration": 18729.861332999997,
      "inputTokens": 2623,
      "output": "{\n  \"lessons\": [\n    {\n      \"concepts\": [\n        \"Western alchemy origin myths\",\n        \"Alchemical transmutation goal\",\n        \"Base metal symbolism\",\n        \"Gold as moral metaphor\",\n        \"Elixir of Life trope\",\n        \"Immortality bargain motif\"\n      ],\n      \"description\": \"Core ideas from alchemical tradition and how transmutation and life-extension function as moral symbols in the series’ worldbuilding.\",\n      \"title\": \"Alchemy motifs and immortality myths\"\n    },\n    {\n      \"concepts\": [\n        \"Philosopher's Stone as catalyst symbol\",\n        \"Stone as concentrated mastery\",\n        \"Stone as temptation object\",\n        \"Stone as narrative MacGuffin\",\n        \"Stone as test of character\",\n        \"Stone destruction as renunciation\"\n      ],\n      \"description\": \"The Stone’s symbolic roles in plot and theme, including why it attracts pursuit and what its removal signifies.\",\n      \"title\": \"Philosopher's Stone symbolism\"\n    },\n    {\n      \"concepts\": [\n        \"Nicholas Flamel as alchemical archetype\",\n        \"Flamel as ethical immortal\",\n        \"Flamel as historical-reference device\",\n        \"Flamel's lifespan as cost signal\",\n        \"Flamel's mortality choice\",\n        \"Flamel as counterpoint to dark immortality\"\n      ],\n      \"description\": \"How Flamel functions as a thematic control case for immortality pursued without domination or soul damage.\",\n      \"title\": \"Flamel as thematic foil\"\n    },\n    {\n      \"concepts\": [\n        \"Immortality as fear response\",\n        \"Death avoidance as identity driver\",\n        \"Immortality as power consolidation\",\n        \"Immortality as moral stagnation\",\n        \"Immortality as relational loss\",\n        \"Immortality as narrative corruption engine\"\n      ],\n      \"description\": \"The psychological and ethical logic that turns the desire to evade death into a source of harm.\",\n      \"title\": \"Immortality as desire and pathology\"\n    },\n    {\n      \"concepts\": [\n        \"Soul as personhood anchor\",\n        \"Soul integrity as moral health\",\n        \"Soul injury as metaphysical wound\",\n        \"Murder as soul-damaging act\",\n        \"Remorse as soul-repair mechanism\",\n        \"Irreversibility threshold of harm\"\n      ],\n      \"description\": \"The metaphysical premises needed to reason about what it means to damage a soul and what recovery can require.\",\n      \"title\": \"Soul metaphysics in the wizarding world\"\n    },\n    {\n      \"concepts\": [\n        \"Horcrux definition\",\n        \"Horcrux purpose\",\n        \"Horcrux creation taboo\",\n        \"Murder as required catalyst\",\n        \"Fragmentation as splitting model\",\n        \"Anchoring fragment to vessel\"\n      ],\n      \"description\": \"What a Horcrux is, what it is for, and the minimal metaphysical steps that make the object function.\",\n      \"title\": \"Horcrux fundamentals\"\n    },\n    {\n      \"concepts\": [\n        \"Soul fragment autonomy level\",\n        \"Horcrux sentience gradient\",\n        \"Horcrux emotional influence channel\",\n        \"Horcrux parasitic attachment\",\n        \"Horcrux protective behavior\",\n        \"Horcrux deception capability\"\n      ],\n      \"description\": \"How Horcruxes act on minds and environments, including the range from passive anchor to active predator.\",\n      \"title\": \"Horcrux agency and influence\"\n    },\n    {\n      \"concepts\": [\n        \"Vessel selection criteria\",\n        \"Vessel permanence value\",\n        \"Vessel concealment strategy\",\n        \"Vessel symbolism choice\",\n        \"Sacrificial object logic\",\n        \"Living Horcrux as special case\"\n      ],\n      \"description\": \"How choosing a container shapes both practical security and thematic meaning, including the implications of a living vessel.\",\n      \"title\": \"Horcrux containers and design\"\n    },\n    {\n      \"concepts\": [\n        \"Fragmentation as self-mutilation\",\n        \"Identity erosion from splitting\",\n        \"Empathy decay mechanism\",\n        \"Attachment incapacity outcome\",\n        \"Paranoia escalation pattern\",\n        \"Violence reinforcement loop\"\n      ],\n      \"description\": \"The internal costs of dividing the soul, framed as progressive degradation of identity, relationships, and moral capacity.\",\n      \"title\": \"Costs of soul fragmentation\"\n    },\n    {\n      \"concepts\": [\n        \"Horcrux persistence after body death\",\n        \"Bodiless survival constraint\",\n        \"Reconstitution dependency\",\n        \"Anchors as vulnerability map\",\n        \"Immortality as stalled existence\",\n        \"Return-to-body as domination impulse\"\n      ],\n      \"description\": \"What Horcrux-based survival actually provides, what it cannot provide, and why it tends toward further violence.\",\n      \"title\": \"Horcrux immortality mechanics\"\n    },\n    {\n      \"concepts\": [\n        \"Horcrux destruction requirement\",\n        \"Irreparable damage criterion\",\n        \"Basilisk venom property\",\n        \"Fiendfyre destructive property\",\n        \"Sword-of-Gryffindor absorption logic\",\n        \"Destruction as moral confrontation\"\n      ],\n      \"description\": \"The conditions that can end a Horcrux and why those conditions symbolically mirror the extremity of the act that created it.\",\n      \"title\": \"Horcrux destruction principles\"\n    },\n    {\n      \"concepts\": [\n        \"Split-soul as unstable system\",\n        \"Multiple Horcruxes as risk multiplier\",\n        \"Diminishing returns of extra anchors\",\n        \"Fragment brittleness concept\",\n        \"Control loss across fragments\",\n        \"Hubris signal in over-fragmentation\"\n      ],\n      \"description\": \"Why creating many Horcruxes increases vulnerability and instability rather than guaranteeing safety.\",\n      \"title\": \"Limits and failure modes of Horcrux strategy\"\n    },\n    {\n      \"concepts\": [\n        \"Stone-based immortality as bodily extension\",\n        \"Horcrux-based immortality as soul severance\",\n        \"Consent absence in Horcrux harm\",\n        \"Repair possibility in Stone path\",\n        \"Fear expression in both methods\",\n        \"Renunciation as thematic resolution\"\n      ],\n      \"description\": \"A focused contrast between two immortality routes in the chapter—one framed as extension, the other as violation—without drifting into spellcraft or politics.\",\n      \"title\": \"Immortality paths in contrast\"\n    }\n  ]\n}",
      "outputTokens": 1005,
      "systemPrompt": "# Role\n\nYou are designing an **exhaustive**, well-organized curriculum for a specific chapter in a course.\n\nYou have expertise in instructional design, curriculum development, and creating granular learning paths. You have worked at top educational institutions creating micro-learning content that breaks down complex topics into digestible, single-concept items and organizes them into coherent thematic units.\n\nYour mission is to identify **every single concept** that needs to be taught in this chapter — at the most granular level possible — and then organize those concepts into thematic lesson units.\n\nYou deeply care about making learning accessible, focused, and efficient by breaking down topics into their smallest logical units.\n\n# Inputs\n\n- `COURSE_TITLE`: name of the overall course\n- `CHAPTER_TITLE`: title of this specific chapter\n- `CHAPTER_DESCRIPTION`: what this chapter covers\n- `LANGUAGE`: output language for titles and descriptions\n- `NEIGHBORING_CHAPTERS` (optional): titles and descriptions of chapters that come before and after this one in the course\n\n## Language\n\n- `en`: Use US region unless the content is about a different region.\n- `pt`: Use Brazilian Portuguese unless the content is about a different region.\n- `es`: Use Latin American Spanish unless the content is about a different region.\n\n# Goal\n\nProduce an **exhaustive** set of **single-concept items** that collectively cover everything in `CHAPTER_TITLE` and `CHAPTER_DESCRIPTION`, organized into thematic **lesson units**.\n\nThink of this in three steps:\n\n1. **Enumerate every concept** that needs to be taught. Each concept should be one specific idea — something you could explain in a single short tweet. Be thorough and cover everything.\n\n2. **Filter out neighboring-chapter concepts.** When `NEIGHBORING_CHAPTERS` is provided, remove any concept whose primary subject belongs in a neighboring chapter. Ask: \"Is this concept primarily about THIS chapter's topic, or is it borrowed from an adjacent domain?\" If borrowed, cut it — even if it feels relevant.\n\n3. **Group the remaining concepts** into thematic lesson units of related concepts each. Each lesson is a coherent cluster of related concepts.\n\n# Critical Requirements\n\n## Concept Granularity (MOST IMPORTANT)\n\nThis is the most critical aspect. Each concept must be **one single, specific idea**:\n\n- If you can explain it in **one short tweet**, it's appropriately scoped\n- If it needs more than a tweet, **split it into multiple concepts**\n- Each concept = one fact, one definition, one rule, one technique, one distinction\n\n**Examples of correct granularity:**\n✅ \"Mitosis\"\n✅ \"Meiosis\"\n✅ \"Prophase\"\n✅ \"Metaphase\"\n✅ \"Role of Spindle Fibers\"\n\n**Examples of concepts that are TOO BROAD:**\n❌ \"Cell Division\" → split into: Mitosis, Meiosis, Cytokinesis, etc.\n❌ \"Phases of Mitosis\" → split into: Prophase, Metaphase, Anaphase, Telophase\n\n**The rule**: If a concept title could be a HEADING with sub-items under it, it's too broad. Break it into those sub-items instead.\n\n## Lesson Unit Structure\n\n- Each lesson groups related concepts under a thematic title\n- Include **as many concepts as the theme naturally requires** — some themes need 4, others need 8. Don't force every lesson to the same size\n- If a group would exceed 8 concepts, split it into two lessons with more specific themes\n- If a group would have fewer than 3 concepts, merge it with a related group\n- Lessons should follow a logical progression from foundational to advanced\n- Don't add \"applications\", \"integrated practice\", or \"putting it all together\" lessons — every lesson should teach new concepts, not revisit previous ones\n\n## Exhaustive Coverage\n\n- The total number of concepts across ALL lessons must cover **everything** in the chapter\n- **Do NOT reduce the number of concepts just because you're organizing them into groups**\n- Add **as many concepts as needed** to break down each topic fully\n- Don't limit the number of concepts or lessons arbitrarily\n- It's better to have more fine-grained concepts than fewer broad ones\n- Make sure to have all concepts needed to **fully master the chapter's scope**\n\n## Title Requirements\n\n### Lesson Titles\n\n- Describe the thematic group: e.g. \"Phases of Mitosis\", \"DNA Replication Machinery\"\n- **NEVER** use words like \"learn\", \"understand\", \"explore\", \"introduction to\", \"basics of\"\n- Go straight to the point\n\n### Concept Titles\n\n- Short, specific, focused on a single idea\n- **NEVER** use \"AND\", \"OR\", \"VS\", or their equivalents in other languages (e.g., \"e\", \"ou\", \"y\", \"o\", \"frente a\", \"versus\") — if you find yourself comparing two things, split into separate concepts\n- Must be **concrete and self-explanatory** — a student should know what they'll learn just from reading the title\n- Prefer concrete nouns and actions over abstract/formal terms\n- Concept titles should read like **glossary entries** — factual, teachable items, not interpretive claims or thesis statements\n- Same concise style as: \"What is a Variable?\", \"Integer Numbers\", \"The Addition Operator\", \"Reading a Graduated Cylinder\"\n\n**Too abstract:**\n❌ \"Transcription\" → ✅ \"DNA Transcription\"\n❌ \"Precision\" → ✅ \"Measurement Precision\"\n❌ \"Substitution\" → ✅ \"Nucleophilic Substitution\"\n❌ \"Resolution\" → ✅ \"Instrument Resolution\"\n\n**Too verbose / reads like a description:**\n❌ \"Effect of Power on Relative Uncertainty\"\n❌ \"Decimal Places Compatible with Uncertainty\"\n❌ \"Consistency of Precision Throughout Calculation\"\n\n✅ \"Uncertainty in Powers\"\n✅ \"Matching Decimal Places to Uncertainty\"\n✅ \"Guard Digits\"\n\n**Too interpretive / reads like a thesis:**\n❌ \"Gravity as Geometric Curvature Metaphor\"\n❌ \"Entropy as Information Loss Framework\"\n❌ \"Selection as Optimization Analogy\"\n\n✅ \"Gravitational Curvature\"\n✅ \"Entropy in Thermodynamics\"\n✅ \"Natural Selection Mechanism\"\n\nWhen a concept title is a single generic word, add just enough context to make it concrete and unambiguous. When a concept title reads like a sentence or explanation, shorten it to a noun phrase. When a concept title reads like an essay argument (\"X as Y motif\"), reframe it as a concrete, teachable fact.\n\n### Lesson Descriptions\n\n- 1-2 sentences describing what this group of concepts covers, no fluff\n- **NEVER** start with words like \"introduces\", \"presents\", \"shows\", \"teaches\", \"covers\", \"explains\"\n- Go straight to the content: e.g. \"How the if, else, and elif keywords control which code block runs.\" not \"Introduces the main conditional keywords in Python.\"\n\n## Progression & Structure\n\n- Build a logical progression from basic to advanced concepts\n- Ensure later concepts build on knowledge from earlier ones\n- Focus specifically on THIS chapter, not the entire course\n- Don't add summary, review, \"key concepts\", or \"verification/checklist\" lessons — every lesson must teach new standalone concepts, not meta-skills about checking your own work\n- Don't add assessment, quiz, or project lessons\n\n## Neighboring Chapter Awareness\n\nWhen `NEIGHBORING_CHAPTERS` is provided, use it to strictly avoid generating concepts that belong in another chapter.\n\nFor EACH concept, apply this test: **\"If I removed this concept from my chapter and placed it in the neighboring chapter's list, would it fit naturally there?\"** If yes, it belongs there, not here — remove it.\n\nThis is a common mistake: the model sees a topic as _relevant_ to the chapter and includes it, even though it's _primarily taught_ in a neighboring chapter. Relevance is not enough — the concept must be **primarily about THIS chapter's subject matter**.\n\nFor example, if a neighboring chapter covers \"DevOps and CI/CD\", do not include concepts like \"Deploy Pipeline\" or \"Release Strategy\" — even if they seem useful for your chapter's topic. If a neighboring chapter covers \"SRE and Reliability\", do not include concepts about SLOs or error budgets.\n\nBrief contextual mentions within a concept's explanation are fine, but the concept itself must not be primarily about a neighboring chapter's domain.\n\n# Example\n\nFor a chapter titled \"Control Flow\" in a Python Programming course:\n\n**Lesson: \"Boolean Expressions\"**\nConcepts: What is a Boolean, True Value, False Value, Comparison Operators, Equal To Operator, Not Equal To Operator, Greater Than Operator, Less Than Operator\n\n**Lesson: \"Conditional Statements\"**\nConcepts: The if Statement, The else Clause, The elif Clause, Nested if Statements, Conditional Expressions (Ternary)\n\n**Lesson: \"Logical Operators\"**\nConcepts: The and Operator, The or Operator, The not Operator, Short-Circuit Evaluation, Operator Precedence in Conditions\n\n**Lesson: \"While Loops\"**\nConcepts: What is a Loop, The while Statement, Loop Condition, Infinite Loops, The break Statement, The continue Statement\n\n**Lesson: \"For Loops and Iteration\"**\nConcepts: The for Statement, Iterating Over a List, Iterating Over a String, The range() Function, Nested Loops\n\nNotice how each concept is a **single, specific idea** (not a broad topic), and the lessons group related concepts together thematically.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n1. **Concept granularity**: Can EACH concept be explained in a single tweet? If any concept could have sub-items under it, break it down further.\n2. **No compound concepts**: Does any concept title contain \"AND\", \"OR\", or \"VS\"? If yes, split it.\n3. **Lesson sizes**: Does each lesson have 3-8 concepts? Do lesson sizes vary naturally, or are they all the same number? Split or merge as needed.\n4. **Complete coverage**: Have you covered EVERYTHING from the chapter description?\n5. **Chapter scope**: Did you stay within the chapter's scope?\n6. **No neighboring overlap**: For each concept, if you moved it to a neighboring chapter's list, would it fit naturally there? If yes, remove it — it belongs there, not here.\n\n# Output Format\n\nEach lesson must include:\n\n- **title** — thematic group name\n- **description** — 1-2 sentences describing what this group of concepts covers\n- **concepts** — array of concept titles (short, specific, focused on a single idea each)\n",
      "testCaseId": "en-harry-potter-alchemy-horcruxes-1",
      "userPrompt": "\n    LANGUAGE: en\n    COURSE_TITLE: Harry Potter\n    CHAPTER_TITLE: Alchemy, Horcruxes, and immortality\n    CHAPTER_DESCRIPTION: Alchemy, immortality myths, and the Philosopher's Stone as symbol. Horcrux metaphysics and the costs of soul fragmentation.\nNEIGHBORING_CHAPTERS:\n- \"Defense Against the Dark Arts\": Defense curriculum across eras and how teaching reflects politics. Practical spell selection, threat models, and the pedagogy of fear.\n- \"Divination and prophecy\": Divination's ambiguity, self-fulfilling prophecy, and narrative foreshadowing. Symbol systems: tea leaves, dreams, centaurs, and astronomy.\n- \"Mind magic and memory\": Mind magic: Legilimency, Occlumency, memory charms, and Pensieve ethics. Consent, epistemology, and the reliability of recollection.\n- \"Wandlore\": Wand woods, cores, allegiance, and the Elder Wand's legend. Comparative magical foci and what wandlore implies about power and identity.\n- \"Healing and magical medicine\": Magical healing, St Mungo's, and the boundaries of restorative magic. Disability, trauma, and long-term consequences in the series.\n- \"Beings, creatures, and species politics\": Werewolves, vampires, giants, goblins, house-elves, centaurs, and merpeople as political subjects. Rights, stereotypes, and allegory across species.\n  "
    },
    {
      "duration": 16187.508166,
      "inputTokens": 2667,
      "output": "{\n  \"lessons\": [\n    {\n      \"concepts\": [\n        \"Legal tech no fluxo de trabalho jurídico\",\n        \"Automação de documentos\",\n        \"Automação baseada em regras\",\n        \"Automação baseada em dados estruturados\",\n        \"Automação baseada em linguagem natural\",\n        \"Critérios de adequação para automação\"\n      ],\n      \"description\": \"Onde a automação documental se encaixa na rotina jurídica e quais tipos de tarefas se beneficiam de automação com segurança e previsibilidade.\",\n      \"title\": \"Escopo de legal tech para automação documental\"\n    },\n    {\n      \"concepts\": [\n        \"Template jurídico\",\n        \"Modelo padrão institucional\",\n        \"Biblioteca de cláusulas\",\n        \"Campos variáveis\",\n        \"Texto fixo\",\n        \"Entidades do documento\",\n        \"Dependências condicionais de cláusulas\"\n      ],\n      \"description\": \"Componentes que formam templates e como a modularização permite reutilização controlada de trechos e montagem consistente de documentos.\",\n      \"title\": \"Componentes de templates e modularização\"\n    },\n    {\n      \"concepts\": [\n        \"Padrão de nomenclatura de templates\",\n        \"Padrão de nomenclatura de versões\",\n        \"Metadados do template\",\n        \"Taxonomia documental\",\n        \"Classificação por tipo documental\",\n        \"Matriz de aplicabilidade do template\"\n      ],\n      \"description\": \"Regras de catalogação e identificação que tornam templates localizáveis, auditáveis e consistentes em grandes acervos.\",\n      \"title\": \"Padronização e catalogação de templates\"\n    },\n    {\n      \"concepts\": [\n        \"Questionário de coleta de dados\",\n        \"Lógica de ramificação\",\n        \"Validação de entrada\",\n        \"Máscaras de preenchimento\",\n        \"Campos obrigatórios\",\n        \"Tratamento de exceções de preenchimento\"\n      ],\n      \"description\": \"Coleta estruturada de informações para geração de documentos com qualidade, reduzindo erros de digitação e lacunas de informação.\",\n      \"title\": \"Coleta de dados para geração automática\"\n    },\n    {\n      \"concepts\": [\n        \"Motor de geração de documentos\",\n        \"Mapeamento de campos para texto\",\n        \"Renderização de condições\",\n        \"Regras de composição\",\n        \"Tabelas dinâmicas\",\n        \"Mesclagem de dados em massa\"\n      ],\n      \"description\": \"Como a geração automática monta o texto final a partir de variáveis, condições e dados, incluindo cenários de produção em lote.\",\n      \"title\": \"Mecanismos de geração e montagem do documento\"\n    },\n    {\n      \"concepts\": [\n        \"Regras de redação padronizada\",\n        \"Guia de estilo jurídico\",\n        \"Consistência terminológica\",\n        \"Padronização de definições\",\n        \"Padronização de referências internas\",\n        \"Clareza em linguagem jurídica\",\n        \"Redução de ambiguidades contratuais\"\n      ],\n      \"description\": \"Critérios linguísticos e estruturais para manter consistência, clareza e redução de risco interpretativo em documentos automatizados.\",\n      \"title\": \"Qualidade textual e padronização de linguagem\"\n    },\n    {\n      \"concepts\": [\n        \"Checklist de conformidade do template\",\n        \"Revisão assistida por software\",\n        \"Detecção de lacunas\",\n        \"Detecção de inconsistências\",\n        \"Detecção de cláusulas ausentes\",\n        \"Revisão por trilha de alterações\"\n      ],\n      \"description\": \"Técnicas de revisão apoiadas por ferramentas para localizar omissões, divergências e problemas recorrentes em documentos gerados.\",\n      \"title\": \"Revisão assistida e controles de qualidade\"\n    },\n    {\n      \"concepts\": [\n        \"Controle de versões do template\",\n        \"Controle de versões do documento gerado\",\n        \"Baseline de template\",\n        \"Histórico de alterações\",\n        \"Comparação entre versões\",\n        \"Reversão de versão\"\n      ],\n      \"description\": \"Gestão de mudanças em templates e documentos com rastreabilidade, comparação e capacidade de retorno a estados anteriores.\",\n      \"title\": \"Controle de versões e rastreabilidade\"\n    },\n    {\n      \"concepts\": [\n        \"Gestão documental\",\n        \"Repositório central\",\n        \"Permissões de acesso\",\n        \"Controle de edição\",\n        \"Bloqueio de documento\",\n        \"Retenção documental\",\n        \"Descarte seguro\"\n      ],\n      \"description\": \"Organização e proteção do acervo documental com políticas de acesso, edição e ciclo de vida do documento.\",\n      \"title\": \"Gestão documental e ciclo de vida\"\n    },\n    {\n      \"concepts\": [\n        \"Fonte única de verdade\",\n        \"Base de conhecimento jurídica\",\n        \"Curadoria de templates\",\n        \"Curadoria de cláusulas\",\n        \"Governança de nomenclatura\",\n        \"Ciclo de atualização do conhecimento\",\n        \"Gestão de exceções ao padrão\"\n      ],\n      \"description\": \"Como manter conhecimento institucional consistente por meio de curadoria, atualização controlada e regras para exceções justificadas.\",\n      \"title\": \"Governança de conhecimento aplicado a templates\"\n    },\n    {\n      \"concepts\": [\n        \"Risco de desatualização legislativa\",\n        \"Risco de jurisprudência superveniente\",\n        \"Risco de uso indevido do template\",\n        \"Risco de variáveis incorretas\",\n        \"Risco de cláusula incompatível\",\n        \"Risco de falsa sensação de segurança\"\n      ],\n      \"description\": \"Principais falhas típicas da automação documental e como elas surgem na prática jurídica.\",\n      \"title\": \"Riscos específicos da automação documental\"\n    },\n    {\n      \"concepts\": [\n        \"Pontos de controle humano\",\n        \"Gatilhos de escalonamento para revisão jurídica\",\n        \"Critérios de aprovação de template\",\n        \"Critérios de aprovação de documento\",\n        \"Segregação de funções\",\n        \"Registro de decisões de exceção\"\n      ],\n      \"description\": \"Mecanismos de mitigação de risco com revisões, aprovações e trilhas decisórias para documentos automatizados.\",\n      \"title\": \"Controles de governança na automação\"\n    },\n    {\n      \"concepts\": [\n        \"Propriedade do template\",\n        \"Responsável técnico pelo template\",\n        \"Responsável jurídico pelo conteúdo\",\n        \"Matriz RACI para automação documental\",\n        \"Fluxo de mudança controlada\",\n        \"Janela de publicação de novas versões\"\n      ],\n      \"description\": \"Papéis, responsabilidades e rotinas de mudança para manter automação sustentável, com accountability claro.\",\n      \"title\": \"Papéis e processos de governança\"\n    },\n    {\n      \"concepts\": [\n        \"Indicadores de qualidade documental\",\n        \"Taxa de retrabalho\",\n        \"Tempo de ciclo de geração\",\n        \"Taxa de exceções ao padrão\",\n        \"Incidentes por erro de template\",\n        \"Auditoria de uso de templates\"\n      ],\n      \"description\": \"Métricas operacionais focadas em qualidade e segurança da automação documental, com rastros para auditoria.\",\n      \"title\": \"Medição e monitoramento da automação\"\n    }\n  ]\n}",
      "outputTokens": 1160,
      "systemPrompt": "# Role\n\nYou are designing an **exhaustive**, well-organized curriculum for a specific chapter in a course.\n\nYou have expertise in instructional design, curriculum development, and creating granular learning paths. You have worked at top educational institutions creating micro-learning content that breaks down complex topics into digestible, single-concept items and organizes them into coherent thematic units.\n\nYour mission is to identify **every single concept** that needs to be taught in this chapter — at the most granular level possible — and then organize those concepts into thematic lesson units.\n\nYou deeply care about making learning accessible, focused, and efficient by breaking down topics into their smallest logical units.\n\n# Inputs\n\n- `COURSE_TITLE`: name of the overall course\n- `CHAPTER_TITLE`: title of this specific chapter\n- `CHAPTER_DESCRIPTION`: what this chapter covers\n- `LANGUAGE`: output language for titles and descriptions\n- `NEIGHBORING_CHAPTERS` (optional): titles and descriptions of chapters that come before and after this one in the course\n\n## Language\n\n- `en`: Use US region unless the content is about a different region.\n- `pt`: Use Brazilian Portuguese unless the content is about a different region.\n- `es`: Use Latin American Spanish unless the content is about a different region.\n\n# Goal\n\nProduce an **exhaustive** set of **single-concept items** that collectively cover everything in `CHAPTER_TITLE` and `CHAPTER_DESCRIPTION`, organized into thematic **lesson units**.\n\nThink of this in three steps:\n\n1. **Enumerate every concept** that needs to be taught. Each concept should be one specific idea — something you could explain in a single short tweet. Be thorough and cover everything.\n\n2. **Filter out neighboring-chapter concepts.** When `NEIGHBORING_CHAPTERS` is provided, remove any concept whose primary subject belongs in a neighboring chapter. Ask: \"Is this concept primarily about THIS chapter's topic, or is it borrowed from an adjacent domain?\" If borrowed, cut it — even if it feels relevant.\n\n3. **Group the remaining concepts** into thematic lesson units of related concepts each. Each lesson is a coherent cluster of related concepts.\n\n# Critical Requirements\n\n## Concept Granularity (MOST IMPORTANT)\n\nThis is the most critical aspect. Each concept must be **one single, specific idea**:\n\n- If you can explain it in **one short tweet**, it's appropriately scoped\n- If it needs more than a tweet, **split it into multiple concepts**\n- Each concept = one fact, one definition, one rule, one technique, one distinction\n\n**Examples of correct granularity:**\n✅ \"Mitosis\"\n✅ \"Meiosis\"\n✅ \"Prophase\"\n✅ \"Metaphase\"\n✅ \"Role of Spindle Fibers\"\n\n**Examples of concepts that are TOO BROAD:**\n❌ \"Cell Division\" → split into: Mitosis, Meiosis, Cytokinesis, etc.\n❌ \"Phases of Mitosis\" → split into: Prophase, Metaphase, Anaphase, Telophase\n\n**The rule**: If a concept title could be a HEADING with sub-items under it, it's too broad. Break it into those sub-items instead.\n\n## Lesson Unit Structure\n\n- Each lesson groups related concepts under a thematic title\n- Include **as many concepts as the theme naturally requires** — some themes need 4, others need 8. Don't force every lesson to the same size\n- If a group would exceed 8 concepts, split it into two lessons with more specific themes\n- If a group would have fewer than 3 concepts, merge it with a related group\n- Lessons should follow a logical progression from foundational to advanced\n- Don't add \"applications\", \"integrated practice\", or \"putting it all together\" lessons — every lesson should teach new concepts, not revisit previous ones\n\n## Exhaustive Coverage\n\n- The total number of concepts across ALL lessons must cover **everything** in the chapter\n- **Do NOT reduce the number of concepts just because you're organizing them into groups**\n- Add **as many concepts as needed** to break down each topic fully\n- Don't limit the number of concepts or lessons arbitrarily\n- It's better to have more fine-grained concepts than fewer broad ones\n- Make sure to have all concepts needed to **fully master the chapter's scope**\n\n## Title Requirements\n\n### Lesson Titles\n\n- Describe the thematic group: e.g. \"Phases of Mitosis\", \"DNA Replication Machinery\"\n- **NEVER** use words like \"learn\", \"understand\", \"explore\", \"introduction to\", \"basics of\"\n- Go straight to the point\n\n### Concept Titles\n\n- Short, specific, focused on a single idea\n- **NEVER** use \"AND\", \"OR\", \"VS\", or their equivalents in other languages (e.g., \"e\", \"ou\", \"y\", \"o\", \"frente a\", \"versus\") — if you find yourself comparing two things, split into separate concepts\n- Must be **concrete and self-explanatory** — a student should know what they'll learn just from reading the title\n- Prefer concrete nouns and actions over abstract/formal terms\n- Concept titles should read like **glossary entries** — factual, teachable items, not interpretive claims or thesis statements\n- Same concise style as: \"What is a Variable?\", \"Integer Numbers\", \"The Addition Operator\", \"Reading a Graduated Cylinder\"\n\n**Too abstract:**\n❌ \"Transcription\" → ✅ \"DNA Transcription\"\n❌ \"Precision\" → ✅ \"Measurement Precision\"\n❌ \"Substitution\" → ✅ \"Nucleophilic Substitution\"\n❌ \"Resolution\" → ✅ \"Instrument Resolution\"\n\n**Too verbose / reads like a description:**\n❌ \"Effect of Power on Relative Uncertainty\"\n❌ \"Decimal Places Compatible with Uncertainty\"\n❌ \"Consistency of Precision Throughout Calculation\"\n\n✅ \"Uncertainty in Powers\"\n✅ \"Matching Decimal Places to Uncertainty\"\n✅ \"Guard Digits\"\n\n**Too interpretive / reads like a thesis:**\n❌ \"Gravity as Geometric Curvature Metaphor\"\n❌ \"Entropy as Information Loss Framework\"\n❌ \"Selection as Optimization Analogy\"\n\n✅ \"Gravitational Curvature\"\n✅ \"Entropy in Thermodynamics\"\n✅ \"Natural Selection Mechanism\"\n\nWhen a concept title is a single generic word, add just enough context to make it concrete and unambiguous. When a concept title reads like a sentence or explanation, shorten it to a noun phrase. When a concept title reads like an essay argument (\"X as Y motif\"), reframe it as a concrete, teachable fact.\n\n### Lesson Descriptions\n\n- 1-2 sentences describing what this group of concepts covers, no fluff\n- **NEVER** start with words like \"introduces\", \"presents\", \"shows\", \"teaches\", \"covers\", \"explains\"\n- Go straight to the content: e.g. \"How the if, else, and elif keywords control which code block runs.\" not \"Introduces the main conditional keywords in Python.\"\n\n## Progression & Structure\n\n- Build a logical progression from basic to advanced concepts\n- Ensure later concepts build on knowledge from earlier ones\n- Focus specifically on THIS chapter, not the entire course\n- Don't add summary, review, \"key concepts\", or \"verification/checklist\" lessons — every lesson must teach new standalone concepts, not meta-skills about checking your own work\n- Don't add assessment, quiz, or project lessons\n\n## Neighboring Chapter Awareness\n\nWhen `NEIGHBORING_CHAPTERS` is provided, use it to strictly avoid generating concepts that belong in another chapter.\n\nFor EACH concept, apply this test: **\"If I removed this concept from my chapter and placed it in the neighboring chapter's list, would it fit naturally there?\"** If yes, it belongs there, not here — remove it.\n\nThis is a common mistake: the model sees a topic as _relevant_ to the chapter and includes it, even though it's _primarily taught_ in a neighboring chapter. Relevance is not enough — the concept must be **primarily about THIS chapter's subject matter**.\n\nFor example, if a neighboring chapter covers \"DevOps and CI/CD\", do not include concepts like \"Deploy Pipeline\" or \"Release Strategy\" — even if they seem useful for your chapter's topic. If a neighboring chapter covers \"SRE and Reliability\", do not include concepts about SLOs or error budgets.\n\nBrief contextual mentions within a concept's explanation are fine, but the concept itself must not be primarily about a neighboring chapter's domain.\n\n# Example\n\nFor a chapter titled \"Control Flow\" in a Python Programming course:\n\n**Lesson: \"Boolean Expressions\"**\nConcepts: What is a Boolean, True Value, False Value, Comparison Operators, Equal To Operator, Not Equal To Operator, Greater Than Operator, Less Than Operator\n\n**Lesson: \"Conditional Statements\"**\nConcepts: The if Statement, The else Clause, The elif Clause, Nested if Statements, Conditional Expressions (Ternary)\n\n**Lesson: \"Logical Operators\"**\nConcepts: The and Operator, The or Operator, The not Operator, Short-Circuit Evaluation, Operator Precedence in Conditions\n\n**Lesson: \"While Loops\"**\nConcepts: What is a Loop, The while Statement, Loop Condition, Infinite Loops, The break Statement, The continue Statement\n\n**Lesson: \"For Loops and Iteration\"**\nConcepts: The for Statement, Iterating Over a List, Iterating Over a String, The range() Function, Nested Loops\n\nNotice how each concept is a **single, specific idea** (not a broad topic), and the lessons group related concepts together thematically.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n1. **Concept granularity**: Can EACH concept be explained in a single tweet? If any concept could have sub-items under it, break it down further.\n2. **No compound concepts**: Does any concept title contain \"AND\", \"OR\", or \"VS\"? If yes, split it.\n3. **Lesson sizes**: Does each lesson have 3-8 concepts? Do lesson sizes vary naturally, or are they all the same number? Split or merge as needed.\n4. **Complete coverage**: Have you covered EVERYTHING from the chapter description?\n5. **Chapter scope**: Did you stay within the chapter's scope?\n6. **No neighboring overlap**: For each concept, if you moved it to a neighboring chapter's list, would it fit naturally there? If yes, remove it — it belongs there, not here.\n\n# Output Format\n\nEach lesson must include:\n\n- **title** — thematic group name\n- **description** — 1-2 sentences describing what this group of concepts covers\n- **concepts** — array of concept titles (short, specific, focused on a single idea each)\n",
      "testCaseId": "pt-direito-legal-tech-1",
      "userPrompt": "\n    LANGUAGE: pt\n    COURSE_TITLE: Direito\n    CHAPTER_TITLE: Legal tech e automação de documentos\n    CHAPTER_DESCRIPTION: Automação jurídica e qualidade: templates, revisão assistida, gestão documental e padronização. Riscos de automação, controle de versões e governança de conhecimento.\nNEIGHBORING_CHAPTERS:\n- \"Gestão de terceiros e due diligence\": Programas de integridade em terceiros: due diligence, cláusulas anticorrupção e monitoramento. Gestão de contratos, auditoria e encerramento por inadimplemento de compliance.\n- \"Estratégia contenciosa e gestão de disputas\": Estratégia de litígio: seleção de teses, definição de foro, gestão de portfólio e negociação de acordos. Monitoramento de precedentes, risco financeiro e comunicação com stakeholders.\n- \"Legal operations e gestão jurídica\": Gestão de escritórios e departamentos jurídicos: triagem, SLAs, indicadores e orçamento. Precificação, honorários, contratação de correspondentes e qualidade.\n- \"Operações contratuais\": Gestão de contratos: ciclo de vida, cláusulas padrão, aprovações e controle de obrigações. CLM, auditoria contratual e prevenção de disputas.\n- \"Negociação estratégica\": Negociação e mediação avançadas: BATNA, ZOPA, técnicas de influência e gestão de impasses. Construção de acordos complexos e multiparte.\n- \"Advocacia oral e persuasão\": Oratória e atuação em audiência: teoria do caso, exame e contrainterrogatório, sustentação oral e postura profissional. Comunicação com juízes, jurados e peritos.\n  "
    },
    {
      "duration": 35779.4085,
      "inputTokens": 2577,
      "output": "{\n  \"lessons\": [\n    {\n      \"concepts\": [\n        \"Disease ecology in 19th-century Brazil\",\n        \"Port cities as epidemic entry points\",\n        \"Slave quarters as disease environments\",\n        \"Coffee economy mobility as contagion driver\",\n        \"Scientific racism in Brazilian medicine\",\n        \"Tropical medicine as a knowledge field\",\n        \"Medical policing concept\",\n        \"Popular healing practices in the Empire\"\n      ],\n      \"description\": \"Disease patterns in the Empire-era social order, including slavery, migration, and early medical institutions shaping who got care and who was blamed.\",\n      \"title\": \"Health and disease in the 19th-century social order\"\n    },\n    {\n      \"concepts\": [\n        \"Quarantine regulations in imperial Brazil\",\n        \"Lazarettos in Brazilian ports\",\n        \"Cordons sanitaires practice\",\n        \"Maritime inspection regimes\",\n        \"Yellow fever as a recurring urban epidemic\",\n        \"Cholera in 19th-century Brazil\",\n        \"Smallpox epidemic cycles\",\n        \"Death registration in epidemic governance\"\n      ],\n      \"description\": \"How authorities tried to stop epidemic spread through ports, quarantine, and administrative surveillance during major 19th-century outbreaks.\",\n      \"title\": \"Epidemics and quarantine governance in the 1800s\"\n    },\n    {\n      \"concepts\": [\n        \"Miasma theory in Brazilian public health\",\n        \"Germ theory adoption in Brazil\",\n        \"Bacteriology laboratories in public health\",\n        \"Epidemiological mapping practices\",\n        \"Notification requirements for infectious disease\",\n        \"Contact tracing as a control tool\",\n        \"Isolation hospitals purpose\",\n        \"Disinfection practices in epidemic response\"\n      ],\n      \"description\": \"Core scientific ideas and administrative tools that reorganized Brazilian public health from late-19th-century bacteriology to routine surveillance measures.\",\n      \"title\": \"Scientific medicine and modern public health tools\"\n    },\n    {\n      \"concepts\": [\n        \"Oswaldo Cruz as public health administrator\",\n        \"Instituto Soroterápico Federal origins\",\n        \"Fiocruz as biomedical institution\",\n        \"Serum therapy for plague\",\n        \"Yellow fever vector control strategy\",\n        \"Rat campaigns in plague control\",\n        \"Vaccination brigades as street-level state\",\n        \"Public health propaganda materials\"\n      ],\n      \"description\": \"How early-20th-century biomedical institutions and campaigns professionalized public health through laboratories, field brigades, and mass persuasion.\",\n      \"title\": \"Sanitation campaigns and biomedical institution-building\"\n    },\n    {\n      \"concepts\": [\n        \"Vaccine Revolt of 1904\",\n        \"Compulsory vaccination decree mechanics\",\n        \"Police enforcement in health campaigns\",\n        \"Urban reform displacement links\",\n        \"Working-class resistance to sanitation\",\n        \"Press politics in health controversies\",\n        \"Body autonomy claims in public debate\",\n        \"Public trust as a health resource\"\n      ],\n      \"description\": \"Conflicts triggered by compulsory measures and coercive implementation, revealing how class, policing, and legitimacy shaped public health outcomes.\",\n      \"title\": \"Coercion and resistance in public health\"\n    },\n    {\n      \"concepts\": [\n        \"Hookworm as rural public health focus\",\n        \"Malaria in frontier regions as labor issue\",\n        \"Chagas disease discovery in Brazil\",\n        \"Endemic disease concept in Brazilian policy\",\n        \"Saneamento dos Sertões agenda\",\n        \"Rockefeller Foundation campaigns in Brazil\",\n        \"Rural health posts model\",\n        \"Public health as nation-building discourse\"\n      ],\n      \"description\": \"How endemic diseases and rural campaigns reframed health as a problem of territory, labor, and state reach beyond major cities.\",\n      \"title\": \"Endemic diseases and rural sanitation\"\n    },\n    {\n      \"concepts\": [\n        \"Industrial labor health risks in Brazil\",\n        \"Workers’ clinics in early social policy\",\n        \"Occupational medicine as a specialty\",\n        \"Maternity protection in labor legislation\",\n        \"Food adulteration regulation\",\n        \"Milk hygiene campaigns\",\n        \"School hygiene programs\",\n        \"Physical examinations in citizen screening\"\n      ],\n      \"description\": \"Health regulation in workplaces, schools, and consumer markets as Brazil industrialized and expanded social policy and inspection regimes.\",\n      \"title\": \"Health regulation in work, school, and consumption\"\n    },\n    {\n      \"concepts\": [\n        \"Inequality gradient in Brazilian health outcomes\",\n        \"Race as a determinant in Brazilian health\",\n        \"Gendered access to reproductive care\",\n        \"Regional health disparities across Brazil\",\n        \"Clientelism in local health provision\",\n        \"Philanthropic hospitals role\",\n        \"Charity care triage practices\",\n        \"Stigma as a barrier to care\"\n      ],\n      \"description\": \"How stratification by class, race, gender, and region structured exposure, treatment pathways, and the politics of who deserved care.\",\n      \"title\": \"Health inequality and social stratification\"\n    },\n    {\n      \"concepts\": [\n        \"Sanitarismo movement in Brazilian politics\",\n        \"Technocratic authority in health policy\",\n        \"Medical corporatism in the state\",\n        \"Public health budgeting politics\",\n        \"Federalism tensions in health governance\",\n        \"Municipal health administration limits\",\n        \"Health conferences as policy arenas\",\n        \"Social movements in health reform\"\n      ],\n      \"description\": \"The political actors, institutions, and conflicts that shaped Brazilian health policy, especially disputes over authority, funding, and participation.\",\n      \"title\": \"Biomedical politics and health governance\"\n    },\n    {\n      \"concepts\": [\n        \"Hospital-centered care model\",\n        \"Primary care concept in Brazilian reform\",\n        \"Referral networks in health systems\",\n        \"Health workforce professional hierarchies\",\n        \"Nursing professionalization in Brazil\",\n        \"Community health agents role\",\n        \"Pharmaceutical supply chains in SUS\",\n        \"Health information systems in management\"\n      ],\n      \"description\": \"Key components of Brazil’s health-system architecture, including service organization, staffing models, and the infrastructure needed to deliver care.\",\n      \"title\": \"Health system architecture and service delivery\"\n    },\n    {\n      \"concepts\": [\n        \"Social security medicine before SUS\",\n        \"INAMPS as health provider system\",\n        \"Health as a constitutional right in 1988\",\n        \"SUS creation principles\",\n        \"Universality principle in SUS\",\n        \"Integral care principle in SUS\",\n        \"Decentralization principle in SUS\",\n        \"Social participation principle in SUS\"\n      ],\n      \"description\": \"How Brazil moved from segmented social-insurance medicine to a universal public system anchored in constitutional rights and specific guiding principles.\",\n      \"title\": \"From social insurance medicine to SUS\"\n    },\n    {\n      \"concepts\": [\n        \"Family Health Strategy model\",\n        \"Community-based primary care teams\",\n        \"Territorialization in primary care\",\n        \"Home visits as care practice\",\n        \"Vaccination calendar governance\",\n        \"Prenatal care protocols in SUS\",\n        \"Basic sanitation as health determinant framing\",\n        \"Health education in primary care\"\n      ],\n      \"description\": \"How primary care expanded through territorial teams, routine prevention, and household-level outreach to reduce inequality in access.\",\n      \"title\": \"Primary care expansion and prevention\"\n    },\n    {\n      \"concepts\": [\n        \"HIV/AIDS epidemic emergence in Brazil\",\n        \"Brazilian AIDS activism\",\n        \"Universal antiretroviral policy\",\n        \"Compulsory licensing in HIV drug policy\",\n        \"Blood safety regulation after AIDS\",\n        \"Condom policy in prevention\",\n        \"Harm reduction for drug use\",\n        \"Stigma politics in HIV/AIDS\"\n      ],\n      \"description\": \"How Brazil’s response to HIV/AIDS linked activism, prevention, and pharmaceutical policy to a rights-based public health approach.\",\n      \"title\": \"HIV/AIDS, activism, and pharmaceutical politics\"\n    },\n    {\n      \"concepts\": [\n        \"Dengue reemergence in late 20th century\",\n        \"Aedes aegypti eradication campaigns\",\n        \"Urban vector-control routines\",\n        \"Zika outbreak in Brazil\",\n        \"Microcephaly surveillance in Zika crisis\",\n        \"Reproductive rights debates in Zika\",\n        \"Chikungunya spread in Brazil\",\n        \"Risk communication during arbovirus outbreaks\"\n      ],\n      \"description\": \"Recurring mosquito-borne outbreaks and the public health tools used to manage vectors, surveillance, and politically contested reproductive impacts.\",\n      \"title\": \"Arboviruses and vector-control governance\"\n    },\n    {\n      \"concepts\": [\n        \"Mental health reform movement in Brazil\",\n        \"Psychiatric asylum model critique\",\n        \"Anti-asylum legislation goals\",\n        \"CAPS community mental health centers\",\n        \"Therapeutic residences model\",\n        \"Drug policy in mental health services\",\n        \"Judicialization of mental health care\",\n        \"Stigma in mental illness treatment\"\n      ],\n      \"description\": \"The shift from asylum-centered psychiatry to community mental health services and the political conflicts over care models and coercion.\",\n      \"title\": \"Mental health policy and deinstitutionalization\"\n    },\n    {\n      \"concepts\": [\n        \"Indigenous health subsystem in SUS\",\n        \"Special Indigenous Health Districts\",\n        \"Traditional Indigenous healing in policy\",\n        \"Quilombola health access barriers\",\n        \"Prison health policy in Brazil\",\n        \"Homeless health outreach programs\",\n        \"Trans health policy in SUS\",\n        \"Disability access in health services\"\n      ],\n      \"description\": \"How targeted policies within SUS addressed populations facing structural exclusion, along with tensions between rights, culture, and service capacity.\",\n      \"title\": \"Differential inclusion in health policy\"\n    },\n    {\n      \"concepts\": [\n        \"Private health insurance market in Brazil\",\n        \"Dual system dynamics in health access\",\n        \"Public-private contracting in SUS\",\n        \"Philanthropic hospitals in SUS networks\",\n        \"Medical fee schedules politics\",\n        \"Judicialization of medicines\",\n        \"High-cost drugs litigation\",\n        \"Regulatory agency ANS role\"\n      ],\n      \"description\": \"How private provision, insurance regulation, and litigation reshaped access, spending priorities, and inequality within a formally universal system.\",\n      \"title\": \"Public-private mix and the politics of access\"\n    },\n    {\n      \"concepts\": [\n        \"Epidemiological transition in Brazil\",\n        \"Noncommunicable disease burden\",\n        \"Cardiovascular disease prevention policy\",\n        \"Tobacco control in Brazil\",\n        \"Obesity policy debates\",\n        \"Violence as a public health issue\",\n        \"Traffic injuries prevention policy\",\n        \"Cancer screening programs in SUS\"\n      ],\n      \"description\": \"How chronic diseases and injury risks became central to Brazilian public health, with prevention policies that expose unequal exposure and treatment.\",\n      \"title\": \"Chronic disease and injury as public health agendas\"\n    },\n    {\n      \"concepts\": [\n        \"COVID-19 arrival in Brazil\",\n        \"Genomic surveillance networks in COVID-19\",\n        \"Nonpharmaceutical interventions in Brazil\",\n        \"Mask policy disputes\",\n        \"Vaccine procurement politics in COVID-19\",\n        \"Vaccine rollout logistics in SUS\",\n        \"Misinformation in the pandemic\",\n        \"Excess mortality measurement in COVID-19\"\n      ],\n      \"description\": \"How Brazil confronted COVID-19 through surveillance, contested mitigation measures, vaccine politics, and statistical tools to measure impact.\",\n      \"title\": \"COVID-19 governance and pandemic politics\"\n    },\n    {\n      \"concepts\": [\n        \"Favela COVID-19 mutual aid networks\",\n        \"Work precarity as exposure driver\",\n        \"Essential worker risk distribution\",\n        \"Race disparities in COVID-19 mortality\",\n        \"Territorial inequality in ICU access\",\n        \"Oxygen shortage crisis in Manaus\",\n        \"School closures equity effects\",\n        \"Long COVID recognition in policy\"\n      ],\n      \"description\": \"How the pandemic made structural inequality visible in exposure, care capacity, community responses, and the longer-term burden of illness.\",\n      \"title\": \"COVID-19 and inequality in lived experience\"\n    }\n  ]\n}",
      "outputTokens": 1914,
      "systemPrompt": "# Role\n\nYou are designing an **exhaustive**, well-organized curriculum for a specific chapter in a course.\n\nYou have expertise in instructional design, curriculum development, and creating granular learning paths. You have worked at top educational institutions creating micro-learning content that breaks down complex topics into digestible, single-concept items and organizes them into coherent thematic units.\n\nYour mission is to identify **every single concept** that needs to be taught in this chapter — at the most granular level possible — and then organize those concepts into thematic lesson units.\n\nYou deeply care about making learning accessible, focused, and efficient by breaking down topics into their smallest logical units.\n\n# Inputs\n\n- `COURSE_TITLE`: name of the overall course\n- `CHAPTER_TITLE`: title of this specific chapter\n- `CHAPTER_DESCRIPTION`: what this chapter covers\n- `LANGUAGE`: output language for titles and descriptions\n- `NEIGHBORING_CHAPTERS` (optional): titles and descriptions of chapters that come before and after this one in the course\n\n## Language\n\n- `en`: Use US region unless the content is about a different region.\n- `pt`: Use Brazilian Portuguese unless the content is about a different region.\n- `es`: Use Latin American Spanish unless the content is about a different region.\n\n# Goal\n\nProduce an **exhaustive** set of **single-concept items** that collectively cover everything in `CHAPTER_TITLE` and `CHAPTER_DESCRIPTION`, organized into thematic **lesson units**.\n\nThink of this in three steps:\n\n1. **Enumerate every concept** that needs to be taught. Each concept should be one specific idea — something you could explain in a single short tweet. Be thorough and cover everything.\n\n2. **Filter out neighboring-chapter concepts.** When `NEIGHBORING_CHAPTERS` is provided, remove any concept whose primary subject belongs in a neighboring chapter. Ask: \"Is this concept primarily about THIS chapter's topic, or is it borrowed from an adjacent domain?\" If borrowed, cut it — even if it feels relevant.\n\n3. **Group the remaining concepts** into thematic lesson units of related concepts each. Each lesson is a coherent cluster of related concepts.\n\n# Critical Requirements\n\n## Concept Granularity (MOST IMPORTANT)\n\nThis is the most critical aspect. Each concept must be **one single, specific idea**:\n\n- If you can explain it in **one short tweet**, it's appropriately scoped\n- If it needs more than a tweet, **split it into multiple concepts**\n- Each concept = one fact, one definition, one rule, one technique, one distinction\n\n**Examples of correct granularity:**\n✅ \"Mitosis\"\n✅ \"Meiosis\"\n✅ \"Prophase\"\n✅ \"Metaphase\"\n✅ \"Role of Spindle Fibers\"\n\n**Examples of concepts that are TOO BROAD:**\n❌ \"Cell Division\" → split into: Mitosis, Meiosis, Cytokinesis, etc.\n❌ \"Phases of Mitosis\" → split into: Prophase, Metaphase, Anaphase, Telophase\n\n**The rule**: If a concept title could be a HEADING with sub-items under it, it's too broad. Break it into those sub-items instead.\n\n## Lesson Unit Structure\n\n- Each lesson groups related concepts under a thematic title\n- Include **as many concepts as the theme naturally requires** — some themes need 4, others need 8. Don't force every lesson to the same size\n- If a group would exceed 8 concepts, split it into two lessons with more specific themes\n- If a group would have fewer than 3 concepts, merge it with a related group\n- Lessons should follow a logical progression from foundational to advanced\n- Don't add \"applications\", \"integrated practice\", or \"putting it all together\" lessons — every lesson should teach new concepts, not revisit previous ones\n\n## Exhaustive Coverage\n\n- The total number of concepts across ALL lessons must cover **everything** in the chapter\n- **Do NOT reduce the number of concepts just because you're organizing them into groups**\n- Add **as many concepts as needed** to break down each topic fully\n- Don't limit the number of concepts or lessons arbitrarily\n- It's better to have more fine-grained concepts than fewer broad ones\n- Make sure to have all concepts needed to **fully master the chapter's scope**\n\n## Title Requirements\n\n### Lesson Titles\n\n- Describe the thematic group: e.g. \"Phases of Mitosis\", \"DNA Replication Machinery\"\n- **NEVER** use words like \"learn\", \"understand\", \"explore\", \"introduction to\", \"basics of\"\n- Go straight to the point\n\n### Concept Titles\n\n- Short, specific, focused on a single idea\n- **NEVER** use \"AND\", \"OR\", \"VS\", or their equivalents in other languages (e.g., \"e\", \"ou\", \"y\", \"o\", \"frente a\", \"versus\") — if you find yourself comparing two things, split into separate concepts\n- Must be **concrete and self-explanatory** — a student should know what they'll learn just from reading the title\n- Prefer concrete nouns and actions over abstract/formal terms\n- Concept titles should read like **glossary entries** — factual, teachable items, not interpretive claims or thesis statements\n- Same concise style as: \"What is a Variable?\", \"Integer Numbers\", \"The Addition Operator\", \"Reading a Graduated Cylinder\"\n\n**Too abstract:**\n❌ \"Transcription\" → ✅ \"DNA Transcription\"\n❌ \"Precision\" → ✅ \"Measurement Precision\"\n❌ \"Substitution\" → ✅ \"Nucleophilic Substitution\"\n❌ \"Resolution\" → ✅ \"Instrument Resolution\"\n\n**Too verbose / reads like a description:**\n❌ \"Effect of Power on Relative Uncertainty\"\n❌ \"Decimal Places Compatible with Uncertainty\"\n❌ \"Consistency of Precision Throughout Calculation\"\n\n✅ \"Uncertainty in Powers\"\n✅ \"Matching Decimal Places to Uncertainty\"\n✅ \"Guard Digits\"\n\n**Too interpretive / reads like a thesis:**\n❌ \"Gravity as Geometric Curvature Metaphor\"\n❌ \"Entropy as Information Loss Framework\"\n❌ \"Selection as Optimization Analogy\"\n\n✅ \"Gravitational Curvature\"\n✅ \"Entropy in Thermodynamics\"\n✅ \"Natural Selection Mechanism\"\n\nWhen a concept title is a single generic word, add just enough context to make it concrete and unambiguous. When a concept title reads like a sentence or explanation, shorten it to a noun phrase. When a concept title reads like an essay argument (\"X as Y motif\"), reframe it as a concrete, teachable fact.\n\n### Lesson Descriptions\n\n- 1-2 sentences describing what this group of concepts covers, no fluff\n- **NEVER** start with words like \"introduces\", \"presents\", \"shows\", \"teaches\", \"covers\", \"explains\"\n- Go straight to the content: e.g. \"How the if, else, and elif keywords control which code block runs.\" not \"Introduces the main conditional keywords in Python.\"\n\n## Progression & Structure\n\n- Build a logical progression from basic to advanced concepts\n- Ensure later concepts build on knowledge from earlier ones\n- Focus specifically on THIS chapter, not the entire course\n- Don't add summary, review, \"key concepts\", or \"verification/checklist\" lessons — every lesson must teach new standalone concepts, not meta-skills about checking your own work\n- Don't add assessment, quiz, or project lessons\n\n## Neighboring Chapter Awareness\n\nWhen `NEIGHBORING_CHAPTERS` is provided, use it to strictly avoid generating concepts that belong in another chapter.\n\nFor EACH concept, apply this test: **\"If I removed this concept from my chapter and placed it in the neighboring chapter's list, would it fit naturally there?\"** If yes, it belongs there, not here — remove it.\n\nThis is a common mistake: the model sees a topic as _relevant_ to the chapter and includes it, even though it's _primarily taught_ in a neighboring chapter. Relevance is not enough — the concept must be **primarily about THIS chapter's subject matter**.\n\nFor example, if a neighboring chapter covers \"DevOps and CI/CD\", do not include concepts like \"Deploy Pipeline\" or \"Release Strategy\" — even if they seem useful for your chapter's topic. If a neighboring chapter covers \"SRE and Reliability\", do not include concepts about SLOs or error budgets.\n\nBrief contextual mentions within a concept's explanation are fine, but the concept itself must not be primarily about a neighboring chapter's domain.\n\n# Example\n\nFor a chapter titled \"Control Flow\" in a Python Programming course:\n\n**Lesson: \"Boolean Expressions\"**\nConcepts: What is a Boolean, True Value, False Value, Comparison Operators, Equal To Operator, Not Equal To Operator, Greater Than Operator, Less Than Operator\n\n**Lesson: \"Conditional Statements\"**\nConcepts: The if Statement, The else Clause, The elif Clause, Nested if Statements, Conditional Expressions (Ternary)\n\n**Lesson: \"Logical Operators\"**\nConcepts: The and Operator, The or Operator, The not Operator, Short-Circuit Evaluation, Operator Precedence in Conditions\n\n**Lesson: \"While Loops\"**\nConcepts: What is a Loop, The while Statement, Loop Condition, Infinite Loops, The break Statement, The continue Statement\n\n**Lesson: \"For Loops and Iteration\"**\nConcepts: The for Statement, Iterating Over a List, Iterating Over a String, The range() Function, Nested Loops\n\nNotice how each concept is a **single, specific idea** (not a broad topic), and the lessons group related concepts together thematically.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n1. **Concept granularity**: Can EACH concept be explained in a single tweet? If any concept could have sub-items under it, break it down further.\n2. **No compound concepts**: Does any concept title contain \"AND\", \"OR\", or \"VS\"? If yes, split it.\n3. **Lesson sizes**: Does each lesson have 3-8 concepts? Do lesson sizes vary naturally, or are they all the same number? Split or merge as needed.\n4. **Complete coverage**: Have you covered EVERYTHING from the chapter description?\n5. **Chapter scope**: Did you stay within the chapter's scope?\n6. **No neighboring overlap**: For each concept, if you moved it to a neighboring chapter's list, would it fit naturally there? If yes, remove it — it belongs there, not here.\n\n# Output Format\n\nEach lesson must include:\n\n- **title** — thematic group name\n- **description** — 1-2 sentences describing what this group of concepts covers\n- **concepts** — array of concept titles (short, specific, focused on a single idea each)\n",
      "testCaseId": "en-brazilian-history-health-disease-1",
      "userPrompt": "\n    LANGUAGE: en\n    COURSE_TITLE: Brazilian History\n    CHAPTER_TITLE: Health and disease\n    CHAPTER_DESCRIPTION: Public health, epidemics, health systems, and biomedical politics from the 19th century to COVID-19; sanitation campaigns and inequality.\nNEIGHBORING_CHAPTERS:\n- \"Sports and society\": Football history, race and class in sport, club cultures, mega-events, and stadium politics; sport as national narrative.\n- \"Cities and urban inequality\": Urbanization, housing, sanitation, policing, and informal settlements; favelas, segregation, and metropolitan governance.\n- \"Environmental history and the Amazon\": Amazon, Cerrado, and Atlantic Forest histories: extraction, conservation, Indigenous stewardship, climate politics, and environmental governance.\n- \"Military and national security\": Professionalization of the armed forces, coups, doctrine, and defense policy; civil-military relations in democracy.\n- \"Foreign policy and international relations\": Diplomacy from empire to present: borders, regional leadership, multilateralism, South–South ties, and great-power relations.\n- \"Historiography and public memory\": How Brazil's past is narrated and contested: schools, monuments, museums, reparations debates, transitional justice, and public history.\n  "
    }
  ],
  "taskId": "chapter-lessons"
}
