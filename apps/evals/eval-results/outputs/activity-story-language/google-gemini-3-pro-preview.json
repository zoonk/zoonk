{
  "generatedAt": "2026-01-21T21:29:44.273Z",
  "modelId": "google/gemini-3-pro-preview",
  "outputs": [
    {
      "duration": 33308.64241599999,
      "inputTokens": 2681,
      "output": "{\n  \"scenario\": \"You are spending a relaxing morning in Paris. You decide to stop at 'Le Café des Arts' for breakfast. You need to get a table, order your food and drink, handle a small unavailability issue, and pay for your meal.\",\n  \"steps\": [\n    {\n      \"context\": \"Bonjour ! Une table pour une personne ?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Hello! A table for one person?\",\n      \"options\": [\n        {\n          \"feedback\": \"Yes, please - Perfect! This confirms you are alone and want a table.\",\n          \"isCorrect\": true,\n          \"text\": \"Oui, s'il vous plaît.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"The check, please - You just arrived! You haven't ordered yet.\",\n          \"isCorrect\": false,\n          \"text\": \"L'addition, s'il vous plaît.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I don't know - The waiter needs to know if you want to sit down.\",\n          \"isCorrect\": false,\n          \"text\": \"Je ne sais pas.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Goodbye - You are leaving before you even sat down!\",\n          \"isCorrect\": false,\n          \"text\": \"Au revoir.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Installez-vous ici. Voici le menu. Vous désirez boire quelque chose pour commencer ?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Sit here. Here is the menu. Would you like to drink something to start?\",\n      \"options\": [\n        {\n          \"feedback\": \"I'm looking for the station - You are answering a question about drinks with a request for directions.\",\n          \"isCorrect\": false,\n          \"text\": \"Je cherche la gare.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"My name is Paul - The waiter asked for your order, not your name.\",\n          \"isCorrect\": false,\n          \"text\": \"Je m'appelle Paul.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I would like a coffee with milk - Excellent! This directly answers the waiter's question.\",\n          \"isCorrect\": true,\n          \"text\": \"Je voudrais un café au lait.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I am tired - While true perhaps, you need to order a drink.\",\n          \"isCorrect\": false,\n          \"text\": \"Je suis fatigué.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Très bien, un café au lait. Et pour manger ?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Very good, a coffee with milk. And to eat?\",\n      \"options\": [\n        {\n          \"feedback\": \"Where are the toilets? - This is an important question, but it doesn't answer what you want to eat.\",\n          \"isCorrect\": false,\n          \"text\": \"Où sont les toilettes ?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"A croissant, please - Perfect! A classic choice for a French breakfast.\",\n          \"isCorrect\": true,\n          \"text\": \"Un croissant, s'il vous plaît.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"It is expensive - Even if true, this doesn't tell the waiter what you want to order.\",\n          \"isCorrect\": false,\n          \"text\": \"C'est cher.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Good evening - It is morning time, and this doesn't place an order.\",\n          \"isCorrect\": false,\n          \"text\": \"Bonsoir.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Ah, je suis désolé, nous n'avons plus de croissants ce matin. Désirez-vous autre chose ?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Ah, I am sorry, we are out of croissants this morning. Would you like something else?\",\n      \"options\": [\n        {\n          \"feedback\": \"I would like a croissant - The waiter just told you they don't have any!\",\n          \"isCorrect\": false,\n          \"text\": \"Je voudrais un croissant.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Do you have a chocolate croissant? - Good strategy! Since they are out of regular croissants, asking for an alternative is perfect.\",\n          \"isCorrect\": true,\n          \"text\": \"Avez-vous un pain au chocolat ?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Thank you very much - Politely declining implies you don't want any food at all, which might not be what you intended.\",\n          \"isCorrect\": false,\n          \"text\": \"Merci beaucoup.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"What time is it? - This ignores the waiter's question about your food order.\",\n          \"isCorrect\": false,\n          \"text\": \"Quelle heure est-il ?\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Oui, bien sûr. Je vous apporte ça tout de suite... (Plus tard) Tout s'est bien passé ?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Yes, of course. I'll bring that right away... (Later) Did everything go well?\",\n      \"options\": [\n        {\n          \"feedback\": \"Yes, it was delicious. The bill, please - Perfect! You confirmed the meal was good and are ready to pay.\",\n          \"isCorrect\": true,\n          \"text\": \"Oui, c'était délicieux. L'addition, s'il vous plaît.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"A coffee, please - You just finished eating. It's a bit late to order another coffee unless you explicitly want one.\",\n          \"isCorrect\": false,\n          \"text\": \"Un café, s'il vous plaît.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I don't speak French - You've been speaking French the whole time!\",\n          \"isCorrect\": false,\n          \"text\": \"Je ne parle pas français.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Where is the train? - This is unrelated to the meal or the bill.\",\n          \"isCorrect\": false,\n          \"text\": \"Où est le train ?\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Voici l'addition. Ça fera 8 euros. Vous payez par carte ou en espèces ?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Here is the bill. That will be 8 euros. Are you paying by card or cash?\",\n      \"options\": [\n        {\n          \"feedback\": \"By card, please - Perfect! This answers the specific question about payment method.\",\n          \"isCorrect\": true,\n          \"text\": \"Par carte, s'il vous plaît.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I am hungry - You just ate!\",\n          \"isCorrect\": false,\n          \"text\": \"J'ai faim.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"No, thank you - You must pay for your meal; you cannot say no!\",\n          \"isCorrect\": false,\n          \"text\": \"Non, merci.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Hello sir - It is too late for greetings.\",\n          \"isCorrect\": false,\n          \"text\": \"Bonjour monsieur.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    }\n  ]\n}",
      "outputTokens": 3429,
      "systemPrompt": "# Role\n\nYou are an expert language immersion designer specializing in creating realistic, dialogue-driven scenarios that help learners practice language production in authentic contexts. You design experiences that simulate situations learners would encounter when living or traveling in a country where the target language is spoken.\n\n# Goal\n\nCreate an immersive story activity where learners are placed in an everyday situation and must choose appropriate phrases to communicate. The activity simulates real conversations with native speakers, forcing learners to engage with the target language directly rather than relying on translations.\n\nThe activity places learners in a specific scenario (ordering food, asking for directions, checking into a hotel) and guides them through a dialogue where they must select appropriate responses at each step.\n\n# Key Design Principles\n\n## Immersion Over Translation\n\nUnlike other activities where translations help comprehension, this activity intentionally withholds translations from the options. Learners see:\n\n- **Context**: What the native speaker says (in TARGET language with translation)\n- **Options**: Four possible responses (in TARGET language ONLY - no translations)\n\nThis forces learners to:\n\n1. Engage with the target language sounds and patterns\n2. Use context clues to infer meaning\n3. Build recognition before relying on translations\n4. Experience the \"productive uncertainty\" of real conversations\n\nThe translation appears only in the feedback AFTER selection, revealing whether they understood correctly.\n\n## Authentic Scenarios\n\nFocus on situations learners will actually encounter:\n\n| Category       | Example Scenarios                                  |\n| -------------- | -------------------------------------------------- |\n| Food & Dining  | Ordering at a restaurant, asking about ingredients |\n| Transportation | Buying train tickets, asking for directions        |\n| Shopping       | Bargaining at a market, returning an item          |\n| Accommodation  | Checking into a hotel, reporting a problem         |\n| Healthcare     | Describing symptoms at a pharmacy, doctor's visit  |\n| Social         | Meeting neighbors, small talk at a cafe            |\n| Services       | Opening a bank account, getting a phone plan       |\n| Emergencies    | Reporting lost items, asking for help              |\n\n## Supportive Native Speaker\n\nThe character in the story is a friendly native speaker who:\n\n- Speaks naturally but not too fast\n- Helps the learner when they struggle\n- Provides context clues in their responses\n- Never mocks mistakes\n- Gradually introduces more complex language\n\n# Language Handling\n\n## Input Variables\n\n- **TARGET_LANGUAGE**: The language being learned (from `courseTitle`). All dialogue and options are in this language.\n- **NATIVE_LANGUAGE**: The learner's native language (from `language` code). Questions, feedback, and context translations use this language.\n\n## Language Codes\n\n- `en`: US English\n- `pt`: Brazilian Portuguese\n- `es`: Latin American Spanish\n\n## What Appears in Each Language\n\n| Field                        | Language     | Example (Spanish course, English native)                  |\n| ---------------------------- | ------------ | --------------------------------------------------------- |\n| `scenario`                   | NATIVE       | \"You're at a cafe in Madrid and want to order coffee.\"    |\n| `context`                    | TARGET       | \"Buenos dias, que le pongo?\"                              |\n| `contextTranslation`         | NATIVE       | \"Good morning, what can I get you?\"                       |\n| `contextRomanization`        | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].text`             | TARGET       | \"Un cafe con leche, por favor.\"                           |\n| `options[].textRomanization` | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].feedback`         | NATIVE       | \"A coffee with milk, please - Perfect! Polite and clear.\" |\n\n# Options Design\n\n## No Translations in Options\n\nThis is the most critical design decision. Options show ONLY:\n\n- `text`: The phrase in TARGET language\n- `textRomanization`: Romanization for non-Roman scripts (empty string for Roman scripts)\n\n**NO translation is shown**. This forces the learner to:\n\n1. Parse the target language directly\n2. Use patterns they've learned\n3. Make educated guesses based on context\n4. Experience the productive struggle of real communication\n\n## Option Quality\n\nAll 4 options must be:\n\n- **Grammatically correct** in the target language\n- **Contextually plausible** (something a learner might say in this situation)\n- **Distinct in meaning** (not just word variations)\n- **Level-appropriate** (using vocabulary/structures the learner knows)\n\n## Distractor Design\n\n**CRITICAL**: Wrong options must be genuinely inappropriate for the situation - they should lead to miscommunication or confusion if used. Do NOT create distractors that are merely \"less polished\" versions of the correct answer.\n\nWrong options should be **clearly wrong** because they:\n\n1. **Answer a different question**: Respond to something the speaker didn't ask (asking about price when asked about quantity)\n2. **Request the wrong thing**: Order/ask for something different than intended (one-way ticket when you need round-trip)\n3. **Are off-topic**: Say something unrelated to the current conversation point (asking for the check when you just arrived)\n4. **Would cause confusion**: Use words that change the meaning entirely (saying \"no\" when you mean \"yes\")\n\n**DO NOT** create distractors that are:\n\n- Just more/less formal versions of the correct answer\n- Slightly different phrasings that would still work\n- Grammatically awkward but still understandable\n\n# Feedback Design\n\nFeedback appears AFTER the learner selects an option. Every feedback message MUST include:\n\n1. **Translation**: What the option actually means in the native language\n2. **Explanation**: Why this choice is correct or incorrect for the situation\n\n## Feedback Structure\n\nFor **correct** options:\n\n```\n\"[Translation of what they said] - [Why this works in context]\"\n```\n\nExample: \"A coffee with milk, please - Perfect! This is polite and clearly communicates what you want.\"\n\nFor **incorrect** options:\n\n```\n\"[Translation of what they said] - [Why this doesn't work and what would be better]\"\n```\n\nExample: \"Where is the bathroom? - You're trying to order coffee, not find the restroom. Tell the barista what you'd like to drink.\"\n\n# Romanization Requirements\n\nFor languages using non-Roman writing systems (Japanese, Chinese, Korean, Arabic, Russian, Greek, Hebrew, Thai, Hindi, etc.), provide romanization for both context and options.\n\n## Standard Systems\n\n- **Japanese**: Romaji using Hepburn romanization\n- **Chinese**: Pinyin with tone marks\n- **Korean**: Revised Romanization of Korean\n- **Russian**: ISO 9 or BGN/PCGN transliteration\n- **Arabic**: Standard romanization\n- **Greek**: Standard transliteration\n- **Thai**: Royal Thai General System\n- **Hindi**: IAST or Hunterian transliteration\n\n## Roman Scripts\n\nFor languages using Roman letters (Spanish, French, German, Portuguese, Italian, etc.), set both `contextRomanization` and `textRomanization` to empty strings `\"\"`.\n\n# Story Arc\n\nEach story should have 5-10 steps following a natural arc:\n\n## Step Progression\n\n1. **Opening** (1-2 steps): Arrive at the location, initial greeting\n2. **Building** (2-4 steps): Main interaction, making requests, clarifying\n3. **Complication** (0-2 steps): Optional challenge that adds realism\n4. **Resolution** (1-2 steps): Complete the transaction\n5. **Closing** (1 step): Thank and goodbye\n\n## Complication Ideas (Recommended)\n\nAdding a complication makes the story more realistic and teaches learners to handle unexpected situations:\n\n- **Item unavailable**: \"Sorry, we're out of that. Would you like something else?\"\n- **Misunderstanding**: \"Did you say two or twelve?\"\n- **Additional requirement**: \"I'll need to see your ID for that.\"\n- **Clarification needed**: \"Which size did you want?\"\n\n## Pacing Guidelines\n\n- Steps should feel like natural conversation beats\n- Each step presents ONE decision point\n- Context should flow naturally from the previous step\n- The native speaker's response should acknowledge what the learner said\n\n# Output Format\n\nReturn an object with this structure (abbreviated examples shown):\n\n**Non-Roman script example (Japanese):**\n\n```json\n{\n  \"scenario\": \"You're at a train station in Tokyo...\",\n  \"steps\": [\n    {\n      \"context\": \"いらっしゃいませ。どちらまで？\",\n      \"contextTranslation\": \"Welcome. Where to?\",\n      \"contextRomanization\": \"Irasshaimase. Dochira made?\",\n      \"options\": [\n        {\n          \"text\": \"京都までお願いします。\",\n          \"textRomanization\": \"Kyouto made onegaishimasu.\",\n          \"isCorrect\": true,\n          \"feedback\": \"To Kyoto, please - Perfect!\"\n        },\n        {\n          \"text\": \"京都は遠いですか？\",\n          \"textRomanization\": \"Kyouto wa tooi desu ka?\",\n          \"isCorrect\": false,\n          \"feedback\": \"Is Kyoto far? - This asks about distance, not for a ticket.\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n**Roman script example (Spanish) - empty romanization fields:**\n\n```json\n{\n  \"scenario\": \"You're at a restaurant in Barcelona...\",\n  \"steps\": [\n    {\n      \"context\": \"Buenas noches. Estan listos para pedir?\",\n      \"contextTranslation\": \"Good evening. Are you ready to order?\",\n      \"contextRomanization\": \"\",\n      \"options\": [\n        {\n          \"text\": \"Si, me gustaria la paella, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": true,\n          \"feedback\": \"Yes, I would like the paella, please - Perfect!\"\n        },\n        {\n          \"text\": \"La cuenta, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": false,\n          \"feedback\": \"The check, please - You haven't eaten yet!\"\n        }\n      ]\n    }\n  ]\n}\n```\n\nNote: Examples above are abbreviated. Actual output must have 4 options per step and 5-10 steps total.\n\n# Quality Checklist\n\nBefore finalizing, verify:\n\n1. **Grammar accuracy**: All target language text is grammatically correct\n2. **Natural dialogue**: Conversations flow like real interactions\n3. **Appropriate register**: Formality matches the situation (casual cafe vs formal office)\n4. **Cultural accuracy**: Interactions reflect how things work in that culture\n5. **Clear progression**: Steps follow a logical narrative arc\n6. **Distinct options**: Each option represents a meaningfully different choice\n7. **Helpful feedback**: Translations and explanations clarify meaning and context\n8. **Correct romanization**: Follows standard systems for non-Roman scripts, empty for Roman scripts\n9. **Scenario relevance**: The story matches the lesson topic\n10. **Appropriate difficulty**: Language complexity matches learner level\n\n# Common Mistakes to Avoid\n\n1. **Including translations in options**: Options must show TARGET language only\n2. **Trivial distractors**: Options that are obviously wrong or nonsensical\n3. **Inconsistent register**: Mixing formal and informal inappropriately\n4. **Unnatural responses**: Things a native speaker would never actually say\n5. **Missing romanization**: Forgetting to add romanization for non-Roman scripts\n6. **Adding romanization to Roman scripts**: Spanish, French, etc. should have empty strings\n7. **Feedback without translation**: Always include what the option means\n8. **Disconnected steps**: Each step should follow logically from the previous one\n",
      "testCaseId": "en-french-cafe-ordering-1",
      "userPrompt": "TARGET_LANGUAGE: French\nNATIVE_LANGUAGE: en\nCHAPTER_TITLE: At the Cafe\nLESSON_TITLE: Ordering at a Cafe\nLESSON_DESCRIPTION: Practice ordering drinks and food at a French cafe, including asking for the menu and paying\n\nGenerate an immersive dialogue-driven story activity for this language lesson. Create a realistic everyday scenario where learners practice language production in situations they'd face in a foreign country."
    },
    {
      "duration": 51518.08462500002,
      "inputTokens": 2679,
      "output": "{\n  \"scenario\": \"You have just arrived at the Sakura Hotel in Tokyo after a long flight. It is evening, and you are tired but excited. You approach the front desk to check in, provide your details, and get settled in your room.\",\n  \"steps\": [\n    {\n      \"context\": \"いらっしゃいませ。こんばんは。\",\n      \"contextRomanization\": \"Irasshaimase. Konbanwa.\",\n      \"contextTranslation\": \"Welcome. Good evening.\",\n      \"options\": [\n        {\n          \"feedback\": \"Good evening. Check-in, please. - Perfect! You returned the greeting and stated your purpose immediately.\",\n          \"isCorrect\": true,\n          \"text\": \"こんばんは。チェックインをお願いします。\",\n          \"textRomanization\": \"Konbanwa. Chekkuin o onegaishimasu.\"\n        },\n        {\n          \"feedback\": \"Goodbye. - You just arrived! This is used when leaving.\",\n          \"isCorrect\": false,\n          \"text\": \"さようなら。\",\n          \"textRomanization\": \"Sayounara.\"\n        },\n        {\n          \"feedback\": \"It is delicious. - You aren't eating anything right now.\",\n          \"isCorrect\": false,\n          \"text\": \"おいしいです。\",\n          \"textRomanization\": \"Oishii desu.\"\n        },\n        {\n          \"feedback\": \"How much is this? - You haven't selected anything to buy yet.\",\n          \"isCorrect\": false,\n          \"text\": \"これはいくらですか。\",\n          \"textRomanization\": \"Kore wa ikura desu ka.\"\n        }\n      ]\n    },\n    {\n      \"context\": \"はい、かしこまりました。お名前をいただけますか。\",\n      \"contextRomanization\": \"Hai, kashikomarimashita. O-namae o itadakemasu ka?\",\n      \"contextTranslation\": \"Yes, certainly. May I have your name?\",\n      \"options\": [\n        {\n          \"feedback\": \"It's Smith. I have a reservation. - Excellent. You provided your name and confirmed you booked ahead.\",\n          \"isCorrect\": true,\n          \"text\": \"スミスです。予約しています。\",\n          \"textRomanization\": \"Sumisu desu. Yoyaku shite imasu.\"\n        },\n        {\n          \"feedback\": \"No, thank you. - The receptionist needs your name to help you.\",\n          \"isCorrect\": false,\n          \"text\": \"いいえ、けっこうです。\",\n          \"textRomanization\": \"Iie, kekkou desu.\"\n        },\n        {\n          \"feedback\": \"Please call a taxi. - This ignores the receptionist's question completely.\",\n          \"isCorrect\": false,\n          \"text\": \"タクシーを呼んでください。\",\n          \"textRomanization\": \"Takushii o yonde kudasai.\"\n        },\n        {\n          \"feedback\": \"I am American. - While true, they asked for your name, not your nationality yet.\",\n          \"isCorrect\": false,\n          \"text\": \"私はアメリカ人です。\",\n          \"textRomanization\": \"Watashi wa Amerikajin desu.\"\n        }\n      ]\n    },\n    {\n      \"context\": \"スミス様ですね。パスポートを拝見できますか。\",\n      \"contextRomanization\": \"Sumisu-sama desu ne. Pasupōto o haiken dekimasu ka?\",\n      \"contextTranslation\": \"Mr./Ms. Smith. May I see your passport?\",\n      \"options\": [\n        {\n          \"feedback\": \"Yes, here you go. - Perfect. This is the standard polite phrase when handing something over.\",\n          \"isCorrect\": true,\n          \"text\": \"はい、どうぞ。\",\n          \"textRomanization\": \"Hai, douzo.\"\n        },\n        {\n          \"feedback\": \"I will pay with cash. - They asked for ID, not payment yet.\",\n          \"isCorrect\": false,\n          \"text\": \"現金で払います。\",\n          \"textRomanization\": \"Genkin de haraimasu.\"\n        },\n        {\n          \"feedback\": \"What time is it now? - This is off-topic. You need to show your ID first.\",\n          \"isCorrect\": false,\n          \"text\": \"今、何時ですか。\",\n          \"textRomanization\": \"Ima, nan-ji desu ka.\"\n        },\n        {\n          \"feedback\": \"Is the room big? - You should comply with the ID request before asking questions.\",\n          \"isCorrect\": false,\n          \"text\": \"部屋は広いですか。\",\n          \"textRomanization\": \"Heya wa hiroi desu ka.\"\n        }\n      ]\n    },\n    {\n      \"context\": \"ありがとうございます。では、ここにサインをお願いします。\",\n      \"contextRomanization\": \"Arigatou gozaimasu. Dewa, koko ni sain o onegaishimasu.\",\n      \"contextTranslation\": \"Thank you. Now, please sign here.\",\n      \"options\": [\n        {\n          \"feedback\": \"Understood. Please lend me a pen. - Great! You agreed to sign and asked for the necessary tool.\",\n          \"isCorrect\": true,\n          \"text\": \"分かりました。ペンを貸してください。\",\n          \"textRomanization\": \"Wakarimashita. Pen o kashite kudasai.\"\n        },\n        {\n          \"feedback\": \"I haven't eaten yet. - This is unrelated to signing the registration form.\",\n          \"isCorrect\": false,\n          \"text\": \"まだ食べていません。\",\n          \"textRomanization\": \"Mada tabete imasen.\"\n        },\n        {\n          \"feedback\": \"Thank you for the meal. - This phrase is used after eating, not at a hotel desk.\",\n          \"isCorrect\": false,\n          \"text\": \"ごちそうさまでした。\",\n          \"textRomanization\": \"Gochisousama deshita.\"\n        },\n        {\n          \"feedback\": \"Is the station close? - You are being asked to do something right now.\",\n          \"isCorrect\": false,\n          \"text\": \"駅は近いですか。\",\n          \"textRomanization\": \"Eki wa chikai desu ka.\"\n        }\n      ]\n    },\n    {\n      \"context\": \"はい、どうぞ。・・・ありがとうございます。お部屋は502号室です。他に質問はありますか。\",\n      \"contextRomanization\": \"Hai, douzo. ... Arigatou gozaimasu. O-heya wa 502-gou-shitsu desu. Hoka ni shitsumon wa arimasu ka?\",\n      \"contextTranslation\": \"Yes, here you go. ... Thank you. Your room is 502. Do you have any other questions?\",\n      \"options\": [\n        {\n          \"feedback\": \"What is the Wi-Fi password? - A very useful amenity question to ask at check-in!\",\n          \"isCorrect\": true,\n          \"text\": \"Wi-Fiのパスワードは何ですか。\",\n          \"textRomanization\": \"Wi-Fi no pasuwādo wa nan desu ka.\"\n        },\n        {\n          \"feedback\": \"Yes, I am fine. - This answers 'How are you?', not 'Do you have questions?'.\",\n          \"isCorrect\": false,\n          \"text\": \"はい、元気です。\",\n          \"textRomanization\": \"Hai, genki desu.\"\n        },\n        {\n          \"feedback\": \"Where is the bank? - While possible, this is usually asked of a concierge, not while getting your room key.\",\n          \"isCorrect\": false,\n          \"text\": \"銀行はどこですか。\",\n          \"textRomanization\": \"Ginkou wa doko desu ka.\"\n        },\n        {\n          \"feedback\": \"I'm leaving. - You phrase implies leaving home. You just got here!\",\n          \"isCorrect\": false,\n          \"text\": \"行ってきます。\",\n          \"textRomanization\": \"Itte kimasu.\"\n        }\n      ]\n    },\n    {\n      \"context\": \"パスワードはカードキーに書いてあります。朝食は7時からです。どうぞごゆっくり。\",\n      \"contextRomanization\": \"Pasuwādo wa kaado kii ni kaite arimasu. Choushoku wa shichi-ji kara desu. Douzo go-yukkuri.\",\n      \"contextTranslation\": \"The password is on the key card. Breakfast is from 7:00. Please enjoy your stay.\",\n      \"options\": [\n        {\n          \"feedback\": \"Thank you very much. - Perfect. A polite way to end the interaction.\",\n          \"isCorrect\": true,\n          \"text\": \"ありがとうございます。\",\n          \"textRomanization\": \"Arigatou gozaimasu.\"\n        },\n        {\n          \"feedback\": \"Take care (of your health). - This is used for someone who is sick.\",\n          \"isCorrect\": false,\n          \"text\": \"お大事に。\",\n          \"textRomanization\": \"O-daiji ni.\"\n        },\n        {\n          \"feedback\": \"Congratulations. - There is no special occasion to celebrate here.\",\n          \"isCorrect\": false,\n          \"text\": \"おめでとうございます。\",\n          \"textRomanization\": \"Omedetou gozaimasu.\"\n        },\n        {\n          \"feedback\": \"Nice to meet you. - This is usually said at the very beginning of an introduction, not the end.\",\n          \"isCorrect\": false,\n          \"text\": \"はじめまして。\",\n          \"textRomanization\": \"Hajimemashite.\"\n        }\n      ]\n    }\n  ]\n}",
      "outputTokens": 5500,
      "systemPrompt": "# Role\n\nYou are an expert language immersion designer specializing in creating realistic, dialogue-driven scenarios that help learners practice language production in authentic contexts. You design experiences that simulate situations learners would encounter when living or traveling in a country where the target language is spoken.\n\n# Goal\n\nCreate an immersive story activity where learners are placed in an everyday situation and must choose appropriate phrases to communicate. The activity simulates real conversations with native speakers, forcing learners to engage with the target language directly rather than relying on translations.\n\nThe activity places learners in a specific scenario (ordering food, asking for directions, checking into a hotel) and guides them through a dialogue where they must select appropriate responses at each step.\n\n# Key Design Principles\n\n## Immersion Over Translation\n\nUnlike other activities where translations help comprehension, this activity intentionally withholds translations from the options. Learners see:\n\n- **Context**: What the native speaker says (in TARGET language with translation)\n- **Options**: Four possible responses (in TARGET language ONLY - no translations)\n\nThis forces learners to:\n\n1. Engage with the target language sounds and patterns\n2. Use context clues to infer meaning\n3. Build recognition before relying on translations\n4. Experience the \"productive uncertainty\" of real conversations\n\nThe translation appears only in the feedback AFTER selection, revealing whether they understood correctly.\n\n## Authentic Scenarios\n\nFocus on situations learners will actually encounter:\n\n| Category       | Example Scenarios                                  |\n| -------------- | -------------------------------------------------- |\n| Food & Dining  | Ordering at a restaurant, asking about ingredients |\n| Transportation | Buying train tickets, asking for directions        |\n| Shopping       | Bargaining at a market, returning an item          |\n| Accommodation  | Checking into a hotel, reporting a problem         |\n| Healthcare     | Describing symptoms at a pharmacy, doctor's visit  |\n| Social         | Meeting neighbors, small talk at a cafe            |\n| Services       | Opening a bank account, getting a phone plan       |\n| Emergencies    | Reporting lost items, asking for help              |\n\n## Supportive Native Speaker\n\nThe character in the story is a friendly native speaker who:\n\n- Speaks naturally but not too fast\n- Helps the learner when they struggle\n- Provides context clues in their responses\n- Never mocks mistakes\n- Gradually introduces more complex language\n\n# Language Handling\n\n## Input Variables\n\n- **TARGET_LANGUAGE**: The language being learned (from `courseTitle`). All dialogue and options are in this language.\n- **NATIVE_LANGUAGE**: The learner's native language (from `language` code). Questions, feedback, and context translations use this language.\n\n## Language Codes\n\n- `en`: US English\n- `pt`: Brazilian Portuguese\n- `es`: Latin American Spanish\n\n## What Appears in Each Language\n\n| Field                        | Language     | Example (Spanish course, English native)                  |\n| ---------------------------- | ------------ | --------------------------------------------------------- |\n| `scenario`                   | NATIVE       | \"You're at a cafe in Madrid and want to order coffee.\"    |\n| `context`                    | TARGET       | \"Buenos dias, que le pongo?\"                              |\n| `contextTranslation`         | NATIVE       | \"Good morning, what can I get you?\"                       |\n| `contextRomanization`        | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].text`             | TARGET       | \"Un cafe con leche, por favor.\"                           |\n| `options[].textRomanization` | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].feedback`         | NATIVE       | \"A coffee with milk, please - Perfect! Polite and clear.\" |\n\n# Options Design\n\n## No Translations in Options\n\nThis is the most critical design decision. Options show ONLY:\n\n- `text`: The phrase in TARGET language\n- `textRomanization`: Romanization for non-Roman scripts (empty string for Roman scripts)\n\n**NO translation is shown**. This forces the learner to:\n\n1. Parse the target language directly\n2. Use patterns they've learned\n3. Make educated guesses based on context\n4. Experience the productive struggle of real communication\n\n## Option Quality\n\nAll 4 options must be:\n\n- **Grammatically correct** in the target language\n- **Contextually plausible** (something a learner might say in this situation)\n- **Distinct in meaning** (not just word variations)\n- **Level-appropriate** (using vocabulary/structures the learner knows)\n\n## Distractor Design\n\n**CRITICAL**: Wrong options must be genuinely inappropriate for the situation - they should lead to miscommunication or confusion if used. Do NOT create distractors that are merely \"less polished\" versions of the correct answer.\n\nWrong options should be **clearly wrong** because they:\n\n1. **Answer a different question**: Respond to something the speaker didn't ask (asking about price when asked about quantity)\n2. **Request the wrong thing**: Order/ask for something different than intended (one-way ticket when you need round-trip)\n3. **Are off-topic**: Say something unrelated to the current conversation point (asking for the check when you just arrived)\n4. **Would cause confusion**: Use words that change the meaning entirely (saying \"no\" when you mean \"yes\")\n\n**DO NOT** create distractors that are:\n\n- Just more/less formal versions of the correct answer\n- Slightly different phrasings that would still work\n- Grammatically awkward but still understandable\n\n# Feedback Design\n\nFeedback appears AFTER the learner selects an option. Every feedback message MUST include:\n\n1. **Translation**: What the option actually means in the native language\n2. **Explanation**: Why this choice is correct or incorrect for the situation\n\n## Feedback Structure\n\nFor **correct** options:\n\n```\n\"[Translation of what they said] - [Why this works in context]\"\n```\n\nExample: \"A coffee with milk, please - Perfect! This is polite and clearly communicates what you want.\"\n\nFor **incorrect** options:\n\n```\n\"[Translation of what they said] - [Why this doesn't work and what would be better]\"\n```\n\nExample: \"Where is the bathroom? - You're trying to order coffee, not find the restroom. Tell the barista what you'd like to drink.\"\n\n# Romanization Requirements\n\nFor languages using non-Roman writing systems (Japanese, Chinese, Korean, Arabic, Russian, Greek, Hebrew, Thai, Hindi, etc.), provide romanization for both context and options.\n\n## Standard Systems\n\n- **Japanese**: Romaji using Hepburn romanization\n- **Chinese**: Pinyin with tone marks\n- **Korean**: Revised Romanization of Korean\n- **Russian**: ISO 9 or BGN/PCGN transliteration\n- **Arabic**: Standard romanization\n- **Greek**: Standard transliteration\n- **Thai**: Royal Thai General System\n- **Hindi**: IAST or Hunterian transliteration\n\n## Roman Scripts\n\nFor languages using Roman letters (Spanish, French, German, Portuguese, Italian, etc.), set both `contextRomanization` and `textRomanization` to empty strings `\"\"`.\n\n# Story Arc\n\nEach story should have 5-10 steps following a natural arc:\n\n## Step Progression\n\n1. **Opening** (1-2 steps): Arrive at the location, initial greeting\n2. **Building** (2-4 steps): Main interaction, making requests, clarifying\n3. **Complication** (0-2 steps): Optional challenge that adds realism\n4. **Resolution** (1-2 steps): Complete the transaction\n5. **Closing** (1 step): Thank and goodbye\n\n## Complication Ideas (Recommended)\n\nAdding a complication makes the story more realistic and teaches learners to handle unexpected situations:\n\n- **Item unavailable**: \"Sorry, we're out of that. Would you like something else?\"\n- **Misunderstanding**: \"Did you say two or twelve?\"\n- **Additional requirement**: \"I'll need to see your ID for that.\"\n- **Clarification needed**: \"Which size did you want?\"\n\n## Pacing Guidelines\n\n- Steps should feel like natural conversation beats\n- Each step presents ONE decision point\n- Context should flow naturally from the previous step\n- The native speaker's response should acknowledge what the learner said\n\n# Output Format\n\nReturn an object with this structure (abbreviated examples shown):\n\n**Non-Roman script example (Japanese):**\n\n```json\n{\n  \"scenario\": \"You're at a train station in Tokyo...\",\n  \"steps\": [\n    {\n      \"context\": \"いらっしゃいませ。どちらまで？\",\n      \"contextTranslation\": \"Welcome. Where to?\",\n      \"contextRomanization\": \"Irasshaimase. Dochira made?\",\n      \"options\": [\n        {\n          \"text\": \"京都までお願いします。\",\n          \"textRomanization\": \"Kyouto made onegaishimasu.\",\n          \"isCorrect\": true,\n          \"feedback\": \"To Kyoto, please - Perfect!\"\n        },\n        {\n          \"text\": \"京都は遠いですか？\",\n          \"textRomanization\": \"Kyouto wa tooi desu ka?\",\n          \"isCorrect\": false,\n          \"feedback\": \"Is Kyoto far? - This asks about distance, not for a ticket.\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n**Roman script example (Spanish) - empty romanization fields:**\n\n```json\n{\n  \"scenario\": \"You're at a restaurant in Barcelona...\",\n  \"steps\": [\n    {\n      \"context\": \"Buenas noches. Estan listos para pedir?\",\n      \"contextTranslation\": \"Good evening. Are you ready to order?\",\n      \"contextRomanization\": \"\",\n      \"options\": [\n        {\n          \"text\": \"Si, me gustaria la paella, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": true,\n          \"feedback\": \"Yes, I would like the paella, please - Perfect!\"\n        },\n        {\n          \"text\": \"La cuenta, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": false,\n          \"feedback\": \"The check, please - You haven't eaten yet!\"\n        }\n      ]\n    }\n  ]\n}\n```\n\nNote: Examples above are abbreviated. Actual output must have 4 options per step and 5-10 steps total.\n\n# Quality Checklist\n\nBefore finalizing, verify:\n\n1. **Grammar accuracy**: All target language text is grammatically correct\n2. **Natural dialogue**: Conversations flow like real interactions\n3. **Appropriate register**: Formality matches the situation (casual cafe vs formal office)\n4. **Cultural accuracy**: Interactions reflect how things work in that culture\n5. **Clear progression**: Steps follow a logical narrative arc\n6. **Distinct options**: Each option represents a meaningfully different choice\n7. **Helpful feedback**: Translations and explanations clarify meaning and context\n8. **Correct romanization**: Follows standard systems for non-Roman scripts, empty for Roman scripts\n9. **Scenario relevance**: The story matches the lesson topic\n10. **Appropriate difficulty**: Language complexity matches learner level\n\n# Common Mistakes to Avoid\n\n1. **Including translations in options**: Options must show TARGET language only\n2. **Trivial distractors**: Options that are obviously wrong or nonsensical\n3. **Inconsistent register**: Mixing formal and informal inappropriately\n4. **Unnatural responses**: Things a native speaker would never actually say\n5. **Missing romanization**: Forgetting to add romanization for non-Roman scripts\n6. **Adding romanization to Roman scripts**: Spanish, French, etc. should have empty strings\n7. **Feedback without translation**: Always include what the option means\n8. **Disconnected steps**: Each step should follow logically from the previous one\n",
      "testCaseId": "en-japanese-hotel-checkin-1",
      "userPrompt": "TARGET_LANGUAGE: Japanese\nNATIVE_LANGUAGE: en\nCHAPTER_TITLE: Travel and Accommodation\nLESSON_TITLE: Hotel Check-in\nLESSON_DESCRIPTION: Learn to check into a hotel, confirm reservations, and ask about room amenities\n\nGenerate an immersive dialogue-driven story activity for this language lesson. Create a realistic everyday scenario where learners practice language production in situations they'd face in a foreign country."
    },
    {
      "duration": 35718.03900000002,
      "inputTokens": 2678,
      "output": "{\n  \"scenario\": \"Você está em um 'Wochenmarkt' (mercado semanal) em Berlim. Você quer comprar maçãs e batatas para o jantar.\",\n  \"steps\": [\n    {\n      \"context\": \"Guten Morgen! Was darf es sein?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Bom dia! O que vai querer?\",\n      \"options\": [\n        {\n          \"feedback\": \"Bom dia. Eu gostaria de comprar maçãs - Perfeito! Você respondeu ao cumprimento e disse o que queria.\",\n          \"isCorrect\": true,\n          \"text\": \"Guten Morgen. Ich möchte Äpfel kaufen.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"A conta, por favor - Você acabou de chegar, ainda não comprou nada para pedir a conta.\",\n          \"isCorrect\": false,\n          \"text\": \"Die Rechnung, bitte.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Uma mesa para dois - Isso é um mercado de rua, não um restaurante com mesas.\",\n          \"isCorrect\": false,\n          \"text\": \"Einen Tisch für zwei, bitte.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Eu não falo alemão - Embora útil, isso não ajuda você a comprar o que precisa.\",\n          \"isCorrect\": false,\n          \"text\": \"Ich spreche kein Deutsch.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Gerne. Wir haben heute sehr schöne rote Äpfel aus der Region. Wie viele möchten Sie?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Com prazer. Temos maçãs vermelhas da região muito bonitas hoje. Quantas você quer?\",\n      \"options\": [\n        {\n          \"feedback\": \"Um quilo, por favor - Correto! Esta é a maneira padrão de pedir quantidades no mercado.\",\n          \"isCorrect\": true,\n          \"text\": \"Ein Kilo, bitte.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"São três horas - O vendedor perguntou a quantidade, não as horas.\",\n          \"isCorrect\": false,\n          \"text\": \"Es ist drei Uhr.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Eu sou uma maçã - Gramaticalmente correto, mas semanticamente sem sentido aqui.\",\n          \"isCorrect\": false,\n          \"text\": \"Ich bin ein Apfel.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Elas são vermelhas - O vendedor já disse que são vermelhas; ele perguntou quantas você quer.\",\n          \"isCorrect\": false,\n          \"text\": \"Sie sind rot.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Alles klar, ein Kilo Äpfel. Brauchen Sie auch Gemüse? Die Kartoffeln sind ganz frisch.\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Certo, um quilo de maçãs. Precisa de legumes também? As batatas estão bem frescas.\",\n      \"options\": [\n        {\n          \"feedback\": \"Sim, eu levo dois quilos de batatas - Ótimo! Você aceitou a sugestão e especificou a quantidade.\",\n          \"isCorrect\": true,\n          \"text\": \"Ja, ich nehme zwei Kilo Kartoffeln.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Onde fica o metrô? - Você mudou de assunto repentinamente sem responder à pergunta do vendedor.\",\n          \"isCorrect\": false,\n          \"text\": \"Wo ist die U-Bahn?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Desculpe, eu não tenho batatas - Você é o cliente, o vendedor é quem tem as batatas.\",\n          \"isCorrect\": false,\n          \"text\": \"Entschuldigung, ich habe keine Kartoffeln.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Eu gosto de banana - Isso não responde se você quer as batatas que ele ofereceu.\",\n          \"isCorrect\": false,\n          \"text\": \"Ich mag Bananen.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Wunderbar. Darf es sonst noch etwas sein?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Maravilha. Vai querer mais alguma coisa?\",\n      \"options\": [\n        {\n          \"feedback\": \"Não, isso é tudo. Quanto custa? - Perfeito. Você indicou que terminou as compras e pediu o preço.\",\n          \"isCorrect\": true,\n          \"text\": \"Nein, das ist alles. Wie viel kostet das?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Sim, eu gosto muito - 'Sim' sugere que você quer mais coisas, mas você não disse o quê.\",\n          \"isCorrect\": false,\n          \"text\": \"Ja, ich mag es sehr.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Meu nome é Pedro - O vendedor perguntou se você quer comprar mais itens, não o seu nome.\",\n          \"isCorrect\": false,\n          \"text\": \"Ich heiße Pedro.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"De nada - Esta é a resposta para 'obrigado', o que não cabe aqui.\",\n          \"isCorrect\": false,\n          \"text\": \"Bitte sehr.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Das macht zusammen 6 Euro 50, bitte.\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Isso dá um total de 6 euros e 50, por favor.\",\n      \"options\": [\n        {\n          \"feedback\": \"Aqui estão 10 euros. Pode ficar com o troco - Excelente! Uma frase muito comum e natural.\",\n          \"isCorrect\": true,\n          \"text\": \"Hier sind 10 Euro. Stimmt so.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"O que você recomenda? - Tarde demais, você já comprou e precisa pagar.\",\n          \"isCorrect\": false,\n          \"text\": \"Was empfehlen Sie?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Está muito frio hoje - Comentário sobre o tempo, mas ignora o pagamento solicitado.\",\n          \"isCorrect\": false,\n          \"text\": \"Es ist sehr kalt heute.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Eu como carne - Informação irrelevante no momento de pagar por frutas e legumes.\",\n          \"isCorrect\": false,\n          \"text\": \"Ich esse Fleisch.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Vielen Dank! Einen schönen Tag noch.\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Muito obrigado! Tenha um bom dia.\",\n      \"options\": [\n        {\n          \"feedback\": \"Obrigado, para você também. Tchau! - A despedida perfeita e educada.\",\n          \"isCorrect\": true,\n          \"text\": \"Danke, gleichfalls. Auf Wiedersehen!\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Eu não sei - Não faz sentido responder 'eu não sei' a um desejo de bom dia.\",\n          \"isCorrect\": false,\n          \"text\": \"Ich weiß nicht.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Boa noite - O contexto inicial estabeleceu que é de manhã ('Guten Morgen').\",\n          \"isCorrect\": false,\n          \"text\": \"Gute Nacht.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Por favor - 'Bitte' sozinho não é uma boa resposta de despedida.\",\n          \"isCorrect\": false,\n          \"text\": \"Bitte.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    }\n  ]\n}",
      "outputTokens": 3741,
      "systemPrompt": "# Role\n\nYou are an expert language immersion designer specializing in creating realistic, dialogue-driven scenarios that help learners practice language production in authentic contexts. You design experiences that simulate situations learners would encounter when living or traveling in a country where the target language is spoken.\n\n# Goal\n\nCreate an immersive story activity where learners are placed in an everyday situation and must choose appropriate phrases to communicate. The activity simulates real conversations with native speakers, forcing learners to engage with the target language directly rather than relying on translations.\n\nThe activity places learners in a specific scenario (ordering food, asking for directions, checking into a hotel) and guides them through a dialogue where they must select appropriate responses at each step.\n\n# Key Design Principles\n\n## Immersion Over Translation\n\nUnlike other activities where translations help comprehension, this activity intentionally withholds translations from the options. Learners see:\n\n- **Context**: What the native speaker says (in TARGET language with translation)\n- **Options**: Four possible responses (in TARGET language ONLY - no translations)\n\nThis forces learners to:\n\n1. Engage with the target language sounds and patterns\n2. Use context clues to infer meaning\n3. Build recognition before relying on translations\n4. Experience the \"productive uncertainty\" of real conversations\n\nThe translation appears only in the feedback AFTER selection, revealing whether they understood correctly.\n\n## Authentic Scenarios\n\nFocus on situations learners will actually encounter:\n\n| Category       | Example Scenarios                                  |\n| -------------- | -------------------------------------------------- |\n| Food & Dining  | Ordering at a restaurant, asking about ingredients |\n| Transportation | Buying train tickets, asking for directions        |\n| Shopping       | Bargaining at a market, returning an item          |\n| Accommodation  | Checking into a hotel, reporting a problem         |\n| Healthcare     | Describing symptoms at a pharmacy, doctor's visit  |\n| Social         | Meeting neighbors, small talk at a cafe            |\n| Services       | Opening a bank account, getting a phone plan       |\n| Emergencies    | Reporting lost items, asking for help              |\n\n## Supportive Native Speaker\n\nThe character in the story is a friendly native speaker who:\n\n- Speaks naturally but not too fast\n- Helps the learner when they struggle\n- Provides context clues in their responses\n- Never mocks mistakes\n- Gradually introduces more complex language\n\n# Language Handling\n\n## Input Variables\n\n- **TARGET_LANGUAGE**: The language being learned (from `courseTitle`). All dialogue and options are in this language.\n- **NATIVE_LANGUAGE**: The learner's native language (from `language` code). Questions, feedback, and context translations use this language.\n\n## Language Codes\n\n- `en`: US English\n- `pt`: Brazilian Portuguese\n- `es`: Latin American Spanish\n\n## What Appears in Each Language\n\n| Field                        | Language     | Example (Spanish course, English native)                  |\n| ---------------------------- | ------------ | --------------------------------------------------------- |\n| `scenario`                   | NATIVE       | \"You're at a cafe in Madrid and want to order coffee.\"    |\n| `context`                    | TARGET       | \"Buenos dias, que le pongo?\"                              |\n| `contextTranslation`         | NATIVE       | \"Good morning, what can I get you?\"                       |\n| `contextRomanization`        | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].text`             | TARGET       | \"Un cafe con leche, por favor.\"                           |\n| `options[].textRomanization` | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].feedback`         | NATIVE       | \"A coffee with milk, please - Perfect! Polite and clear.\" |\n\n# Options Design\n\n## No Translations in Options\n\nThis is the most critical design decision. Options show ONLY:\n\n- `text`: The phrase in TARGET language\n- `textRomanization`: Romanization for non-Roman scripts (empty string for Roman scripts)\n\n**NO translation is shown**. This forces the learner to:\n\n1. Parse the target language directly\n2. Use patterns they've learned\n3. Make educated guesses based on context\n4. Experience the productive struggle of real communication\n\n## Option Quality\n\nAll 4 options must be:\n\n- **Grammatically correct** in the target language\n- **Contextually plausible** (something a learner might say in this situation)\n- **Distinct in meaning** (not just word variations)\n- **Level-appropriate** (using vocabulary/structures the learner knows)\n\n## Distractor Design\n\n**CRITICAL**: Wrong options must be genuinely inappropriate for the situation - they should lead to miscommunication or confusion if used. Do NOT create distractors that are merely \"less polished\" versions of the correct answer.\n\nWrong options should be **clearly wrong** because they:\n\n1. **Answer a different question**: Respond to something the speaker didn't ask (asking about price when asked about quantity)\n2. **Request the wrong thing**: Order/ask for something different than intended (one-way ticket when you need round-trip)\n3. **Are off-topic**: Say something unrelated to the current conversation point (asking for the check when you just arrived)\n4. **Would cause confusion**: Use words that change the meaning entirely (saying \"no\" when you mean \"yes\")\n\n**DO NOT** create distractors that are:\n\n- Just more/less formal versions of the correct answer\n- Slightly different phrasings that would still work\n- Grammatically awkward but still understandable\n\n# Feedback Design\n\nFeedback appears AFTER the learner selects an option. Every feedback message MUST include:\n\n1. **Translation**: What the option actually means in the native language\n2. **Explanation**: Why this choice is correct or incorrect for the situation\n\n## Feedback Structure\n\nFor **correct** options:\n\n```\n\"[Translation of what they said] - [Why this works in context]\"\n```\n\nExample: \"A coffee with milk, please - Perfect! This is polite and clearly communicates what you want.\"\n\nFor **incorrect** options:\n\n```\n\"[Translation of what they said] - [Why this doesn't work and what would be better]\"\n```\n\nExample: \"Where is the bathroom? - You're trying to order coffee, not find the restroom. Tell the barista what you'd like to drink.\"\n\n# Romanization Requirements\n\nFor languages using non-Roman writing systems (Japanese, Chinese, Korean, Arabic, Russian, Greek, Hebrew, Thai, Hindi, etc.), provide romanization for both context and options.\n\n## Standard Systems\n\n- **Japanese**: Romaji using Hepburn romanization\n- **Chinese**: Pinyin with tone marks\n- **Korean**: Revised Romanization of Korean\n- **Russian**: ISO 9 or BGN/PCGN transliteration\n- **Arabic**: Standard romanization\n- **Greek**: Standard transliteration\n- **Thai**: Royal Thai General System\n- **Hindi**: IAST or Hunterian transliteration\n\n## Roman Scripts\n\nFor languages using Roman letters (Spanish, French, German, Portuguese, Italian, etc.), set both `contextRomanization` and `textRomanization` to empty strings `\"\"`.\n\n# Story Arc\n\nEach story should have 5-10 steps following a natural arc:\n\n## Step Progression\n\n1. **Opening** (1-2 steps): Arrive at the location, initial greeting\n2. **Building** (2-4 steps): Main interaction, making requests, clarifying\n3. **Complication** (0-2 steps): Optional challenge that adds realism\n4. **Resolution** (1-2 steps): Complete the transaction\n5. **Closing** (1 step): Thank and goodbye\n\n## Complication Ideas (Recommended)\n\nAdding a complication makes the story more realistic and teaches learners to handle unexpected situations:\n\n- **Item unavailable**: \"Sorry, we're out of that. Would you like something else?\"\n- **Misunderstanding**: \"Did you say two or twelve?\"\n- **Additional requirement**: \"I'll need to see your ID for that.\"\n- **Clarification needed**: \"Which size did you want?\"\n\n## Pacing Guidelines\n\n- Steps should feel like natural conversation beats\n- Each step presents ONE decision point\n- Context should flow naturally from the previous step\n- The native speaker's response should acknowledge what the learner said\n\n# Output Format\n\nReturn an object with this structure (abbreviated examples shown):\n\n**Non-Roman script example (Japanese):**\n\n```json\n{\n  \"scenario\": \"You're at a train station in Tokyo...\",\n  \"steps\": [\n    {\n      \"context\": \"いらっしゃいませ。どちらまで？\",\n      \"contextTranslation\": \"Welcome. Where to?\",\n      \"contextRomanization\": \"Irasshaimase. Dochira made?\",\n      \"options\": [\n        {\n          \"text\": \"京都までお願いします。\",\n          \"textRomanization\": \"Kyouto made onegaishimasu.\",\n          \"isCorrect\": true,\n          \"feedback\": \"To Kyoto, please - Perfect!\"\n        },\n        {\n          \"text\": \"京都は遠いですか？\",\n          \"textRomanization\": \"Kyouto wa tooi desu ka?\",\n          \"isCorrect\": false,\n          \"feedback\": \"Is Kyoto far? - This asks about distance, not for a ticket.\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n**Roman script example (Spanish) - empty romanization fields:**\n\n```json\n{\n  \"scenario\": \"You're at a restaurant in Barcelona...\",\n  \"steps\": [\n    {\n      \"context\": \"Buenas noches. Estan listos para pedir?\",\n      \"contextTranslation\": \"Good evening. Are you ready to order?\",\n      \"contextRomanization\": \"\",\n      \"options\": [\n        {\n          \"text\": \"Si, me gustaria la paella, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": true,\n          \"feedback\": \"Yes, I would like the paella, please - Perfect!\"\n        },\n        {\n          \"text\": \"La cuenta, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": false,\n          \"feedback\": \"The check, please - You haven't eaten yet!\"\n        }\n      ]\n    }\n  ]\n}\n```\n\nNote: Examples above are abbreviated. Actual output must have 4 options per step and 5-10 steps total.\n\n# Quality Checklist\n\nBefore finalizing, verify:\n\n1. **Grammar accuracy**: All target language text is grammatically correct\n2. **Natural dialogue**: Conversations flow like real interactions\n3. **Appropriate register**: Formality matches the situation (casual cafe vs formal office)\n4. **Cultural accuracy**: Interactions reflect how things work in that culture\n5. **Clear progression**: Steps follow a logical narrative arc\n6. **Distinct options**: Each option represents a meaningfully different choice\n7. **Helpful feedback**: Translations and explanations clarify meaning and context\n8. **Correct romanization**: Follows standard systems for non-Roman scripts, empty for Roman scripts\n9. **Scenario relevance**: The story matches the lesson topic\n10. **Appropriate difficulty**: Language complexity matches learner level\n\n# Common Mistakes to Avoid\n\n1. **Including translations in options**: Options must show TARGET language only\n2. **Trivial distractors**: Options that are obviously wrong or nonsensical\n3. **Inconsistent register**: Mixing formal and informal inappropriately\n4. **Unnatural responses**: Things a native speaker would never actually say\n5. **Missing romanization**: Forgetting to add romanization for non-Roman scripts\n6. **Adding romanization to Roman scripts**: Spanish, French, etc. should have empty strings\n7. **Feedback without translation**: Always include what the option means\n8. **Disconnected steps**: Each step should follow logically from the previous one\n",
      "testCaseId": "pt-german-market-shopping-1",
      "userPrompt": "TARGET_LANGUAGE: German\nNATIVE_LANGUAGE: pt\nCHAPTER_TITLE: Fazendo Compras\nLESSON_TITLE: No Mercado\nLESSON_DESCRIPTION: Aprenda a comprar frutas, verduras e outros itens em um mercado alemao\n\nGenerate an immersive dialogue-driven story activity for this language lesson. Create a realistic everyday scenario where learners practice language production in situations they'd face in a foreign country."
    },
    {
      "duration": 45401.720084,
      "inputTokens": 2676,
      "output": "{\n  \"scenario\": \"Estás caminando por el distrito de Gangnam en Seúl y necesitas encontrar la estación de metro más cercana para volver a tu hotel. Ves a una persona amable esperando en un paso de peatones y decides pedir ayuda.\",\n  \"steps\": [\n    {\n      \"context\": \"안녕하세요! 혹시 길을 찾고 계신가요?\",\n      \"contextRomanization\": \"Annyeonghaseyo! Hoksi gireul chatgo gyesingayo?\",\n      \"contextTranslation\": \"¡Hola! ¿Por casualidad está buscando alguna dirección?\",\n      \"options\": [\n        {\n          \"feedback\": \"Sí, disculpe. Me gustaría preguntar por una dirección - ¡Perfecto! Es una forma muy educada de iniciar la interacción.\",\n          \"isCorrect\": true,\n          \"text\": \"네, 실례합니다. 길 좀 묻겠습니다.\",\n          \"textRomanization\": \"Ne, sillyehamnida. Gil jom mutgetseumnida.\"\n        },\n        {\n          \"feedback\": \"No, soy coreano - Esto niega que necesites ayuda y afirma una nacionalidad incorrecta.\",\n          \"isCorrect\": false,\n          \"text\": \"아니요, 저는 한국 사람이에요.\",\n          \"textRomanization\": \"Aniyo, jeoneun hanguk saramieyo.\"\n        },\n        {\n          \"feedback\": \"¿Qué hora es ahora? - Esto cambia el tema en lugar de aceptar la oferta de ayuda.\",\n          \"isCorrect\": false,\n          \"text\": \"지금 몇 시예요?\",\n          \"textRomanization\": \"Jigeum myeot siyeyo?\"\n        },\n        {\n          \"feedback\": \"¿Cómo te llamas? - Demasiado personal para una interacción rápida en la calle.\",\n          \"isCorrect\": false,\n          \"text\": \"이름이 뭐예요?\",\n          \"textRomanization\": \"Ireumi mwoyeyo?\"\n        }\n      ]\n    },\n    {\n      \"context\": \"네, 도와드릴게요. 어디로 가시나요?\",\n      \"contextRomanization\": \"Ne, dowadeurilgeyo. Eodiro gasinayo?\",\n      \"contextTranslation\": \"Sí, le ayudaré. ¿A dónde va?\",\n      \"options\": [\n        {\n          \"feedback\": \"¿Dónde está la estación de metro más cercana? - ¡Excelente! Preguntas exactamente por lo que necesitas.\",\n          \"isCorrect\": true,\n          \"text\": \"가장 가까운 지하철역이 어디예요?\",\n          \"textRomanization\": \"Gajang gakkaun jihacheolyeogi eodiyeyo?\"\n        },\n        {\n          \"feedback\": \"Quiero comer bibimbap - Esto expresa un deseo de comida, no de transporte.\",\n          \"isCorrect\": false,\n          \"text\": \"비빔밥을 먹고 싶어요.\",\n          \"textRomanization\": \"Bibimbabeul meokgo sipeoyo.\"\n        },\n        {\n          \"feedback\": \"¿Cuánto cuesta el taxi? - Estás buscando el metro, no un taxi.\",\n          \"isCorrect\": false,\n          \"text\": \"택시 요금은 얼마예요?\",\n          \"textRomanization\": \"Taeksi yogeumeun eolmayeyo?\"\n        },\n        {\n          \"feedback\": \"El autobús ya se fue - Esto es una afirmación sobre un autobús, no una pregunta de dirección.\",\n          \"isCorrect\": false,\n          \"text\": \"버스가 이미 떠났어요.\",\n          \"textRomanization\": \"Beoseuga imi tteonasseoyo.\"\n        }\n      ]\n    },\n    {\n      \"context\": \"저기 편의점 보이시죠? 저기서 쭉 직진하세요.\",\n      \"contextRomanization\": \"Jeogi pyeonuijeom boisijyo? Jeogiseo jjuk jikjinhaseyo.\",\n      \"contextTranslation\": \"¿Ve esa tienda de conveniencia de allá? Vaya todo recto desde allí.\",\n      \"options\": [\n        {\n          \"feedback\": \"Ah, ¿recto desde la tienda de conveniencia? - ¡Bien! Confirmas la instrucción clave para asegurar que entendiste.\",\n          \"isCorrect\": true,\n          \"text\": \"아, 편의점에서 직진이요?\",\n          \"textRomanization\": \"A, pyeonuijeomeseo jikjinyo?\"\n        },\n        {\n          \"feedback\": \"No me gusta la tienda de conveniencia - Irrelevante, la tienda es solo un punto de referencia.\",\n          \"isCorrect\": false,\n          \"text\": \"편의점은 별로예요.\",\n          \"textRomanization\": \"Pyeonuijeomeun byeolloyeyo.\"\n        },\n        {\n          \"feedback\": \"¿Debo volver atrás? - La instrucción fue 'recto', no volver.\",\n          \"isCorrect\": false,\n          \"text\": \"뒤로 돌아갈까요?\",\n          \"textRomanization\": \"Dwiro doragalkkayo?\"\n        },\n        {\n          \"feedback\": \"Por favor, pare aquí - Esto es lo que le dirías a un taxista, no a un peatón.\",\n          \"isCorrect\": false,\n          \"text\": \"여기서 세워 주세요.\",\n          \"textRomanization\": \"Yeogiseo sewo juseyo.\"\n        }\n      ]\n    },\n    {\n      \"context\": \"맞아요. 그리고 사거리에서 오른쪽으로 도세요. 그러면 역이 보일 거예요.\",\n      \"contextRomanization\": \"Majayo. Geurigo sageorieseo oreunjjugeuro doseyo. Geureomyeon yeogi boil geoyeyo.\",\n      \"contextTranslation\": \"Correcto. Y en el cruce, gire a la derecha. Entonces verá la estación.\",\n      \"options\": [\n        {\n          \"feedback\": \"Girar a la derecha en el cruce. Entendido - ¡Perfecto! Repites la dirección crítica para confirmar.\",\n          \"isCorrect\": true,\n          \"text\": \"사거리에서 오른쪽으로요. 알겠습니다.\",\n          \"textRomanization\": \"Sageorieseo oreunjjugeuroyo. Algetseumnida.\"\n        },\n        {\n          \"feedback\": \"¿Girar a la izquierda? - Te dijeron a la derecha (oreunjjok), no a la izquierda (oenjjok).\",\n          \"isCorrect\": false,\n          \"text\": \"왼쪽으로 돌아요?\",\n          \"textRomanization\": \"Oenjjugeuro dorayo?\"\n        },\n        {\n          \"feedback\": \"No tengo tiempo - Grosero e irrelevante después de pedir ayuda.\",\n          \"isCorrect\": false,\n          \"text\": \"저는 시간이 없어요.\",\n          \"textRomanization\": \"Jeoneun sigani eopseoyo.\"\n        },\n        {\n          \"feedback\": \"¿Dónde está el baño? - Ahora no es el momento de cambiar de tema repentinamente.\",\n          \"isCorrect\": false,\n          \"text\": \"화장실은 어디에 있어요?\",\n          \"textRomanization\": \"Hwajangsireun eodie isseoyo?\"\n        }\n      ]\n    },\n    {\n      \"context\": \"네, 여기서 5분 정도 걸려요. 조심히 가세요!\",\n      \"contextRomanization\": \"Ne, yeogiseo obun jeongdo geollyeoyo. Josimhi gaseyo!\",\n      \"contextTranslation\": \"Sí, se tarda unos 5 minutos desde aquí. ¡Vaya con cuidado!\",\n      \"options\": [\n        {\n          \"feedback\": \"Muchas gracias por su ayuda - ¡Excelente! Una despedida educada y agradecida.\",\n          \"isCorrect\": true,\n          \"text\": \"도와주셔서 감사합니다.\",\n          \"textRomanization\": \"Dowajusyeoseo gamsahamnida.\"\n        },\n        {\n          \"feedback\": \"Es demasiado caro - No estás comprando nada, solo pediste direcciones.\",\n          \"isCorrect\": false,\n          \"text\": \"너무 비싸요.\",\n          \"textRomanization\": \"Neomu bissayo.\"\n        },\n        {\n          \"feedback\": \"Hola (informal) - 'Annyeong' es demasiado informal y se usa para saludar, no para despedirse de un extraño.\",\n          \"isCorrect\": false,\n          \"text\": \"안녕.\",\n          \"textRomanization\": \"Annyeong.\"\n        },\n        {\n          \"feedback\": \"Bienvenido - Esto es lo que se dice cuando alguien llega, no cuando tú te vas.\",\n          \"isCorrect\": false,\n          \"text\": \"어서 오세요.\",\n          \"textRomanization\": \"Eoseo oseyo.\"\n        }\n      ]\n    }\n  ]\n}",
      "outputTokens": 4540,
      "systemPrompt": "# Role\n\nYou are an expert language immersion designer specializing in creating realistic, dialogue-driven scenarios that help learners practice language production in authentic contexts. You design experiences that simulate situations learners would encounter when living or traveling in a country where the target language is spoken.\n\n# Goal\n\nCreate an immersive story activity where learners are placed in an everyday situation and must choose appropriate phrases to communicate. The activity simulates real conversations with native speakers, forcing learners to engage with the target language directly rather than relying on translations.\n\nThe activity places learners in a specific scenario (ordering food, asking for directions, checking into a hotel) and guides them through a dialogue where they must select appropriate responses at each step.\n\n# Key Design Principles\n\n## Immersion Over Translation\n\nUnlike other activities where translations help comprehension, this activity intentionally withholds translations from the options. Learners see:\n\n- **Context**: What the native speaker says (in TARGET language with translation)\n- **Options**: Four possible responses (in TARGET language ONLY - no translations)\n\nThis forces learners to:\n\n1. Engage with the target language sounds and patterns\n2. Use context clues to infer meaning\n3. Build recognition before relying on translations\n4. Experience the \"productive uncertainty\" of real conversations\n\nThe translation appears only in the feedback AFTER selection, revealing whether they understood correctly.\n\n## Authentic Scenarios\n\nFocus on situations learners will actually encounter:\n\n| Category       | Example Scenarios                                  |\n| -------------- | -------------------------------------------------- |\n| Food & Dining  | Ordering at a restaurant, asking about ingredients |\n| Transportation | Buying train tickets, asking for directions        |\n| Shopping       | Bargaining at a market, returning an item          |\n| Accommodation  | Checking into a hotel, reporting a problem         |\n| Healthcare     | Describing symptoms at a pharmacy, doctor's visit  |\n| Social         | Meeting neighbors, small talk at a cafe            |\n| Services       | Opening a bank account, getting a phone plan       |\n| Emergencies    | Reporting lost items, asking for help              |\n\n## Supportive Native Speaker\n\nThe character in the story is a friendly native speaker who:\n\n- Speaks naturally but not too fast\n- Helps the learner when they struggle\n- Provides context clues in their responses\n- Never mocks mistakes\n- Gradually introduces more complex language\n\n# Language Handling\n\n## Input Variables\n\n- **TARGET_LANGUAGE**: The language being learned (from `courseTitle`). All dialogue and options are in this language.\n- **NATIVE_LANGUAGE**: The learner's native language (from `language` code). Questions, feedback, and context translations use this language.\n\n## Language Codes\n\n- `en`: US English\n- `pt`: Brazilian Portuguese\n- `es`: Latin American Spanish\n\n## What Appears in Each Language\n\n| Field                        | Language     | Example (Spanish course, English native)                  |\n| ---------------------------- | ------------ | --------------------------------------------------------- |\n| `scenario`                   | NATIVE       | \"You're at a cafe in Madrid and want to order coffee.\"    |\n| `context`                    | TARGET       | \"Buenos dias, que le pongo?\"                              |\n| `contextTranslation`         | NATIVE       | \"Good morning, what can I get you?\"                       |\n| `contextRomanization`        | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].text`             | TARGET       | \"Un cafe con leche, por favor.\"                           |\n| `options[].textRomanization` | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].feedback`         | NATIVE       | \"A coffee with milk, please - Perfect! Polite and clear.\" |\n\n# Options Design\n\n## No Translations in Options\n\nThis is the most critical design decision. Options show ONLY:\n\n- `text`: The phrase in TARGET language\n- `textRomanization`: Romanization for non-Roman scripts (empty string for Roman scripts)\n\n**NO translation is shown**. This forces the learner to:\n\n1. Parse the target language directly\n2. Use patterns they've learned\n3. Make educated guesses based on context\n4. Experience the productive struggle of real communication\n\n## Option Quality\n\nAll 4 options must be:\n\n- **Grammatically correct** in the target language\n- **Contextually plausible** (something a learner might say in this situation)\n- **Distinct in meaning** (not just word variations)\n- **Level-appropriate** (using vocabulary/structures the learner knows)\n\n## Distractor Design\n\n**CRITICAL**: Wrong options must be genuinely inappropriate for the situation - they should lead to miscommunication or confusion if used. Do NOT create distractors that are merely \"less polished\" versions of the correct answer.\n\nWrong options should be **clearly wrong** because they:\n\n1. **Answer a different question**: Respond to something the speaker didn't ask (asking about price when asked about quantity)\n2. **Request the wrong thing**: Order/ask for something different than intended (one-way ticket when you need round-trip)\n3. **Are off-topic**: Say something unrelated to the current conversation point (asking for the check when you just arrived)\n4. **Would cause confusion**: Use words that change the meaning entirely (saying \"no\" when you mean \"yes\")\n\n**DO NOT** create distractors that are:\n\n- Just more/less formal versions of the correct answer\n- Slightly different phrasings that would still work\n- Grammatically awkward but still understandable\n\n# Feedback Design\n\nFeedback appears AFTER the learner selects an option. Every feedback message MUST include:\n\n1. **Translation**: What the option actually means in the native language\n2. **Explanation**: Why this choice is correct or incorrect for the situation\n\n## Feedback Structure\n\nFor **correct** options:\n\n```\n\"[Translation of what they said] - [Why this works in context]\"\n```\n\nExample: \"A coffee with milk, please - Perfect! This is polite and clearly communicates what you want.\"\n\nFor **incorrect** options:\n\n```\n\"[Translation of what they said] - [Why this doesn't work and what would be better]\"\n```\n\nExample: \"Where is the bathroom? - You're trying to order coffee, not find the restroom. Tell the barista what you'd like to drink.\"\n\n# Romanization Requirements\n\nFor languages using non-Roman writing systems (Japanese, Chinese, Korean, Arabic, Russian, Greek, Hebrew, Thai, Hindi, etc.), provide romanization for both context and options.\n\n## Standard Systems\n\n- **Japanese**: Romaji using Hepburn romanization\n- **Chinese**: Pinyin with tone marks\n- **Korean**: Revised Romanization of Korean\n- **Russian**: ISO 9 or BGN/PCGN transliteration\n- **Arabic**: Standard romanization\n- **Greek**: Standard transliteration\n- **Thai**: Royal Thai General System\n- **Hindi**: IAST or Hunterian transliteration\n\n## Roman Scripts\n\nFor languages using Roman letters (Spanish, French, German, Portuguese, Italian, etc.), set both `contextRomanization` and `textRomanization` to empty strings `\"\"`.\n\n# Story Arc\n\nEach story should have 5-10 steps following a natural arc:\n\n## Step Progression\n\n1. **Opening** (1-2 steps): Arrive at the location, initial greeting\n2. **Building** (2-4 steps): Main interaction, making requests, clarifying\n3. **Complication** (0-2 steps): Optional challenge that adds realism\n4. **Resolution** (1-2 steps): Complete the transaction\n5. **Closing** (1 step): Thank and goodbye\n\n## Complication Ideas (Recommended)\n\nAdding a complication makes the story more realistic and teaches learners to handle unexpected situations:\n\n- **Item unavailable**: \"Sorry, we're out of that. Would you like something else?\"\n- **Misunderstanding**: \"Did you say two or twelve?\"\n- **Additional requirement**: \"I'll need to see your ID for that.\"\n- **Clarification needed**: \"Which size did you want?\"\n\n## Pacing Guidelines\n\n- Steps should feel like natural conversation beats\n- Each step presents ONE decision point\n- Context should flow naturally from the previous step\n- The native speaker's response should acknowledge what the learner said\n\n# Output Format\n\nReturn an object with this structure (abbreviated examples shown):\n\n**Non-Roman script example (Japanese):**\n\n```json\n{\n  \"scenario\": \"You're at a train station in Tokyo...\",\n  \"steps\": [\n    {\n      \"context\": \"いらっしゃいませ。どちらまで？\",\n      \"contextTranslation\": \"Welcome. Where to?\",\n      \"contextRomanization\": \"Irasshaimase. Dochira made?\",\n      \"options\": [\n        {\n          \"text\": \"京都までお願いします。\",\n          \"textRomanization\": \"Kyouto made onegaishimasu.\",\n          \"isCorrect\": true,\n          \"feedback\": \"To Kyoto, please - Perfect!\"\n        },\n        {\n          \"text\": \"京都は遠いですか？\",\n          \"textRomanization\": \"Kyouto wa tooi desu ka?\",\n          \"isCorrect\": false,\n          \"feedback\": \"Is Kyoto far? - This asks about distance, not for a ticket.\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n**Roman script example (Spanish) - empty romanization fields:**\n\n```json\n{\n  \"scenario\": \"You're at a restaurant in Barcelona...\",\n  \"steps\": [\n    {\n      \"context\": \"Buenas noches. Estan listos para pedir?\",\n      \"contextTranslation\": \"Good evening. Are you ready to order?\",\n      \"contextRomanization\": \"\",\n      \"options\": [\n        {\n          \"text\": \"Si, me gustaria la paella, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": true,\n          \"feedback\": \"Yes, I would like the paella, please - Perfect!\"\n        },\n        {\n          \"text\": \"La cuenta, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": false,\n          \"feedback\": \"The check, please - You haven't eaten yet!\"\n        }\n      ]\n    }\n  ]\n}\n```\n\nNote: Examples above are abbreviated. Actual output must have 4 options per step and 5-10 steps total.\n\n# Quality Checklist\n\nBefore finalizing, verify:\n\n1. **Grammar accuracy**: All target language text is grammatically correct\n2. **Natural dialogue**: Conversations flow like real interactions\n3. **Appropriate register**: Formality matches the situation (casual cafe vs formal office)\n4. **Cultural accuracy**: Interactions reflect how things work in that culture\n5. **Clear progression**: Steps follow a logical narrative arc\n6. **Distinct options**: Each option represents a meaningfully different choice\n7. **Helpful feedback**: Translations and explanations clarify meaning and context\n8. **Correct romanization**: Follows standard systems for non-Roman scripts, empty for Roman scripts\n9. **Scenario relevance**: The story matches the lesson topic\n10. **Appropriate difficulty**: Language complexity matches learner level\n\n# Common Mistakes to Avoid\n\n1. **Including translations in options**: Options must show TARGET language only\n2. **Trivial distractors**: Options that are obviously wrong or nonsensical\n3. **Inconsistent register**: Mixing formal and informal inappropriately\n4. **Unnatural responses**: Things a native speaker would never actually say\n5. **Missing romanization**: Forgetting to add romanization for non-Roman scripts\n6. **Adding romanization to Roman scripts**: Spanish, French, etc. should have empty strings\n7. **Feedback without translation**: Always include what the option means\n8. **Disconnected steps**: Each step should follow logically from the previous one\n",
      "testCaseId": "es-korean-asking-directions-1",
      "userPrompt": "TARGET_LANGUAGE: Korean\nNATIVE_LANGUAGE: es\nCHAPTER_TITLE: Transporte y Direcciones\nLESSON_TITLE: Pidiendo Direcciones\nLESSON_DESCRIPTION: Como pedir direcciones y entender indicaciones basicas en coreano\n\nGenerate an immersive dialogue-driven story activity for this language lesson. Create a realistic everyday scenario where learners practice language production in situations they'd face in a foreign country."
    },
    {
      "duration": 28346.878582999983,
      "inputTokens": 2674,
      "output": "{\n  \"scenario\": \"You are on vacation in Mexico City and have developed a splitting headache. You decide to visit a local pharmacy to find some relief. You need to describe your symptoms to the pharmacist and purchase the appropriate medicine.\",\n  \"steps\": [\n    {\n      \"context\": \"¡Buenos días! Bienvenido a la Farmacia Central. ¿En qué puedo ayudarle hoy?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Good morning! Welcome to the Central Pharmacy. How can I help you today?\",\n      \"options\": [\n        {\n          \"feedback\": \"Good morning. I don't feel well - Correct! This sets the context immediately.\",\n          \"isCorrect\": true,\n          \"text\": \"Buenos días. No me siento bien.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I would like a table for two - This is what you say at a restaurant, not a pharmacy.\",\n          \"isCorrect\": false,\n          \"text\": \"Quisiera una mesa para dos.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"How much is the ticket? - You are at a pharmacy, not a train station or cinema.\",\n          \"isCorrect\": false,\n          \"text\": \"¿Cuánto cuesta el boleto?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I am looking for the beach - While you might want to go to the beach, this doesn't explain why you entered a pharmacy.\",\n          \"isCorrect\": false,\n          \"text\": \"Estoy buscando la playa.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Lo siento mucho. ¿Qué síntomas tiene exactamente?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"I am very sorry. What symptoms do you have exactly?\",\n      \"options\": [\n        {\n          \"feedback\": \"I have a lot of hunger - This means you are hungry. You should go to a restaurant instead.\",\n          \"isCorrect\": false,\n          \"text\": \"Tengo mucha hambre.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I have a terrible headache - Perfect! This directly answers the pharmacist's question about symptoms.\",\n          \"isCorrect\": true,\n          \"text\": \"Tengo un dolor de cabeza terrible.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"My passport is lost - This is a serious problem, but a pharmacist cannot help you with legal documents.\",\n          \"isCorrect\": false,\n          \"text\": \"Mi pasaporte está perdido.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I like spicy food - This expresses a preference, not a medical symptom.\",\n          \"isCorrect\": false,\n          \"text\": \"Me gusta la comida picante.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Entiendo. ¿Y tiene fiebre también?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"I understand. And do you have a fever as well?\",\n      \"options\": [\n        {\n          \"feedback\": \"The check, please - You are answering a medical question with a request for a restaurant bill.\",\n          \"isCorrect\": false,\n          \"text\": \"La cuenta, por favor.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I am thirty years old - The pharmacist asked about fever, not your age.\",\n          \"isCorrect\": false,\n          \"text\": \"Tengo treinta años.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Yes, a little bit - Good. This directly answers the specific question about fever.\",\n          \"isCorrect\": true,\n          \"text\": \"Sí, un poco.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I am from the United States - Providing your nationality doesn't help diagnose your condition.\",\n          \"isCorrect\": false,\n          \"text\": \"Soy de los Estados Unidos.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Comprendo. Para recomendarle algo, necesito saber si es alérgico a algún medicamento.\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"I understand. To recommend something, I need to know if you are allergic to any medication.\",\n      \"options\": [\n        {\n          \"feedback\": \"No, I don't have allergies - Excellent. This is crucial safety information for the pharmacist.\",\n          \"isCorrect\": true,\n          \"text\": \"No, no tengo alergias.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Yes, I have a cat - Having a pet is nice, but the pharmacist asked about medication allergies.\",\n          \"isCorrect\": false,\n          \"text\": \"Sí, tengo un gato.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I don't like rain - This is a weather preference, not medical information.\",\n          \"isCorrect\": false,\n          \"text\": \"No me gusta la lluvia.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"My name is John - While polite, you didn't answer the question about allergies.\",\n          \"isCorrect\": false,\n          \"text\": \"Me llamo John.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Muy bien. Le recomiendo estas pastillas. Tome una cada ocho horas. Son doscientos pesos.\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Very well. I recommend these pills. Take one every eight hours. That will be 200 pesos.\",\n      \"options\": [\n        {\n          \"feedback\": \"I'll take it, here is the cash - Perfect! You accepted the recommendation and offered payment.\",\n          \"isCorrect\": true,\n          \"text\": \"Me lo llevo, aquí tiene el efectivo.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Where is the bathroom? - It's a bit late to ask this now, right when you are supposed to pay.\",\n          \"isCorrect\": false,\n          \"text\": \"¿Dónde está el baño?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I don't speak Spanish - You've been having a whole conversation! This contradicts the interaction so far.\",\n          \"isCorrect\": false,\n          \"text\": \"No hablo español.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I want a coffee with milk - You are at a pharmacy counter, not a cafe.\",\n          \"isCorrect\": false,\n          \"text\": \"Quiero un café con leche.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Aquí tiene su cambio y el recibo. ¡Que se mejore pronto!\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Here is your change and the receipt. Get well soon!\",\n      \"options\": [\n        {\n          \"feedback\": \"Thank you very much, goodbye - A polite and appropriate closing.\",\n          \"isCorrect\": true,\n          \"text\": \"Muchas gracias, adiós.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Good morning - It's strange to say \\\"Good morning\\\" when you are leaving and saying goodbye.\",\n          \"isCorrect\": false,\n          \"text\": \"Buenos días.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"The menu, please - The transaction is finished; asking for a menu now makes no sense.\",\n          \"isCorrect\": false,\n          \"text\": \"El menú, por favor.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I'm lost - If you were lost, you should have mentioned that before buying medicine.\",\n          \"isCorrect\": false,\n          \"text\": \"Estoy perdido.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    }\n  ]\n}",
      "outputTokens": 2999,
      "systemPrompt": "# Role\n\nYou are an expert language immersion designer specializing in creating realistic, dialogue-driven scenarios that help learners practice language production in authentic contexts. You design experiences that simulate situations learners would encounter when living or traveling in a country where the target language is spoken.\n\n# Goal\n\nCreate an immersive story activity where learners are placed in an everyday situation and must choose appropriate phrases to communicate. The activity simulates real conversations with native speakers, forcing learners to engage with the target language directly rather than relying on translations.\n\nThe activity places learners in a specific scenario (ordering food, asking for directions, checking into a hotel) and guides them through a dialogue where they must select appropriate responses at each step.\n\n# Key Design Principles\n\n## Immersion Over Translation\n\nUnlike other activities where translations help comprehension, this activity intentionally withholds translations from the options. Learners see:\n\n- **Context**: What the native speaker says (in TARGET language with translation)\n- **Options**: Four possible responses (in TARGET language ONLY - no translations)\n\nThis forces learners to:\n\n1. Engage with the target language sounds and patterns\n2. Use context clues to infer meaning\n3. Build recognition before relying on translations\n4. Experience the \"productive uncertainty\" of real conversations\n\nThe translation appears only in the feedback AFTER selection, revealing whether they understood correctly.\n\n## Authentic Scenarios\n\nFocus on situations learners will actually encounter:\n\n| Category       | Example Scenarios                                  |\n| -------------- | -------------------------------------------------- |\n| Food & Dining  | Ordering at a restaurant, asking about ingredients |\n| Transportation | Buying train tickets, asking for directions        |\n| Shopping       | Bargaining at a market, returning an item          |\n| Accommodation  | Checking into a hotel, reporting a problem         |\n| Healthcare     | Describing symptoms at a pharmacy, doctor's visit  |\n| Social         | Meeting neighbors, small talk at a cafe            |\n| Services       | Opening a bank account, getting a phone plan       |\n| Emergencies    | Reporting lost items, asking for help              |\n\n## Supportive Native Speaker\n\nThe character in the story is a friendly native speaker who:\n\n- Speaks naturally but not too fast\n- Helps the learner when they struggle\n- Provides context clues in their responses\n- Never mocks mistakes\n- Gradually introduces more complex language\n\n# Language Handling\n\n## Input Variables\n\n- **TARGET_LANGUAGE**: The language being learned (from `courseTitle`). All dialogue and options are in this language.\n- **NATIVE_LANGUAGE**: The learner's native language (from `language` code). Questions, feedback, and context translations use this language.\n\n## Language Codes\n\n- `en`: US English\n- `pt`: Brazilian Portuguese\n- `es`: Latin American Spanish\n\n## What Appears in Each Language\n\n| Field                        | Language     | Example (Spanish course, English native)                  |\n| ---------------------------- | ------------ | --------------------------------------------------------- |\n| `scenario`                   | NATIVE       | \"You're at a cafe in Madrid and want to order coffee.\"    |\n| `context`                    | TARGET       | \"Buenos dias, que le pongo?\"                              |\n| `contextTranslation`         | NATIVE       | \"Good morning, what can I get you?\"                       |\n| `contextRomanization`        | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].text`             | TARGET       | \"Un cafe con leche, por favor.\"                           |\n| `options[].textRomanization` | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].feedback`         | NATIVE       | \"A coffee with milk, please - Perfect! Polite and clear.\" |\n\n# Options Design\n\n## No Translations in Options\n\nThis is the most critical design decision. Options show ONLY:\n\n- `text`: The phrase in TARGET language\n- `textRomanization`: Romanization for non-Roman scripts (empty string for Roman scripts)\n\n**NO translation is shown**. This forces the learner to:\n\n1. Parse the target language directly\n2. Use patterns they've learned\n3. Make educated guesses based on context\n4. Experience the productive struggle of real communication\n\n## Option Quality\n\nAll 4 options must be:\n\n- **Grammatically correct** in the target language\n- **Contextually plausible** (something a learner might say in this situation)\n- **Distinct in meaning** (not just word variations)\n- **Level-appropriate** (using vocabulary/structures the learner knows)\n\n## Distractor Design\n\n**CRITICAL**: Wrong options must be genuinely inappropriate for the situation - they should lead to miscommunication or confusion if used. Do NOT create distractors that are merely \"less polished\" versions of the correct answer.\n\nWrong options should be **clearly wrong** because they:\n\n1. **Answer a different question**: Respond to something the speaker didn't ask (asking about price when asked about quantity)\n2. **Request the wrong thing**: Order/ask for something different than intended (one-way ticket when you need round-trip)\n3. **Are off-topic**: Say something unrelated to the current conversation point (asking for the check when you just arrived)\n4. **Would cause confusion**: Use words that change the meaning entirely (saying \"no\" when you mean \"yes\")\n\n**DO NOT** create distractors that are:\n\n- Just more/less formal versions of the correct answer\n- Slightly different phrasings that would still work\n- Grammatically awkward but still understandable\n\n# Feedback Design\n\nFeedback appears AFTER the learner selects an option. Every feedback message MUST include:\n\n1. **Translation**: What the option actually means in the native language\n2. **Explanation**: Why this choice is correct or incorrect for the situation\n\n## Feedback Structure\n\nFor **correct** options:\n\n```\n\"[Translation of what they said] - [Why this works in context]\"\n```\n\nExample: \"A coffee with milk, please - Perfect! This is polite and clearly communicates what you want.\"\n\nFor **incorrect** options:\n\n```\n\"[Translation of what they said] - [Why this doesn't work and what would be better]\"\n```\n\nExample: \"Where is the bathroom? - You're trying to order coffee, not find the restroom. Tell the barista what you'd like to drink.\"\n\n# Romanization Requirements\n\nFor languages using non-Roman writing systems (Japanese, Chinese, Korean, Arabic, Russian, Greek, Hebrew, Thai, Hindi, etc.), provide romanization for both context and options.\n\n## Standard Systems\n\n- **Japanese**: Romaji using Hepburn romanization\n- **Chinese**: Pinyin with tone marks\n- **Korean**: Revised Romanization of Korean\n- **Russian**: ISO 9 or BGN/PCGN transliteration\n- **Arabic**: Standard romanization\n- **Greek**: Standard transliteration\n- **Thai**: Royal Thai General System\n- **Hindi**: IAST or Hunterian transliteration\n\n## Roman Scripts\n\nFor languages using Roman letters (Spanish, French, German, Portuguese, Italian, etc.), set both `contextRomanization` and `textRomanization` to empty strings `\"\"`.\n\n# Story Arc\n\nEach story should have 5-10 steps following a natural arc:\n\n## Step Progression\n\n1. **Opening** (1-2 steps): Arrive at the location, initial greeting\n2. **Building** (2-4 steps): Main interaction, making requests, clarifying\n3. **Complication** (0-2 steps): Optional challenge that adds realism\n4. **Resolution** (1-2 steps): Complete the transaction\n5. **Closing** (1 step): Thank and goodbye\n\n## Complication Ideas (Recommended)\n\nAdding a complication makes the story more realistic and teaches learners to handle unexpected situations:\n\n- **Item unavailable**: \"Sorry, we're out of that. Would you like something else?\"\n- **Misunderstanding**: \"Did you say two or twelve?\"\n- **Additional requirement**: \"I'll need to see your ID for that.\"\n- **Clarification needed**: \"Which size did you want?\"\n\n## Pacing Guidelines\n\n- Steps should feel like natural conversation beats\n- Each step presents ONE decision point\n- Context should flow naturally from the previous step\n- The native speaker's response should acknowledge what the learner said\n\n# Output Format\n\nReturn an object with this structure (abbreviated examples shown):\n\n**Non-Roman script example (Japanese):**\n\n```json\n{\n  \"scenario\": \"You're at a train station in Tokyo...\",\n  \"steps\": [\n    {\n      \"context\": \"いらっしゃいませ。どちらまで？\",\n      \"contextTranslation\": \"Welcome. Where to?\",\n      \"contextRomanization\": \"Irasshaimase. Dochira made?\",\n      \"options\": [\n        {\n          \"text\": \"京都までお願いします。\",\n          \"textRomanization\": \"Kyouto made onegaishimasu.\",\n          \"isCorrect\": true,\n          \"feedback\": \"To Kyoto, please - Perfect!\"\n        },\n        {\n          \"text\": \"京都は遠いですか？\",\n          \"textRomanization\": \"Kyouto wa tooi desu ka?\",\n          \"isCorrect\": false,\n          \"feedback\": \"Is Kyoto far? - This asks about distance, not for a ticket.\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n**Roman script example (Spanish) - empty romanization fields:**\n\n```json\n{\n  \"scenario\": \"You're at a restaurant in Barcelona...\",\n  \"steps\": [\n    {\n      \"context\": \"Buenas noches. Estan listos para pedir?\",\n      \"contextTranslation\": \"Good evening. Are you ready to order?\",\n      \"contextRomanization\": \"\",\n      \"options\": [\n        {\n          \"text\": \"Si, me gustaria la paella, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": true,\n          \"feedback\": \"Yes, I would like the paella, please - Perfect!\"\n        },\n        {\n          \"text\": \"La cuenta, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": false,\n          \"feedback\": \"The check, please - You haven't eaten yet!\"\n        }\n      ]\n    }\n  ]\n}\n```\n\nNote: Examples above are abbreviated. Actual output must have 4 options per step and 5-10 steps total.\n\n# Quality Checklist\n\nBefore finalizing, verify:\n\n1. **Grammar accuracy**: All target language text is grammatically correct\n2. **Natural dialogue**: Conversations flow like real interactions\n3. **Appropriate register**: Formality matches the situation (casual cafe vs formal office)\n4. **Cultural accuracy**: Interactions reflect how things work in that culture\n5. **Clear progression**: Steps follow a logical narrative arc\n6. **Distinct options**: Each option represents a meaningfully different choice\n7. **Helpful feedback**: Translations and explanations clarify meaning and context\n8. **Correct romanization**: Follows standard systems for non-Roman scripts, empty for Roman scripts\n9. **Scenario relevance**: The story matches the lesson topic\n10. **Appropriate difficulty**: Language complexity matches learner level\n\n# Common Mistakes to Avoid\n\n1. **Including translations in options**: Options must show TARGET language only\n2. **Trivial distractors**: Options that are obviously wrong or nonsensical\n3. **Inconsistent register**: Mixing formal and informal inappropriately\n4. **Unnatural responses**: Things a native speaker would never actually say\n5. **Missing romanization**: Forgetting to add romanization for non-Roman scripts\n6. **Adding romanization to Roman scripts**: Spanish, French, etc. should have empty strings\n7. **Feedback without translation**: Always include what the option means\n8. **Disconnected steps**: Each step should follow logically from the previous one\n",
      "testCaseId": "en-spanish-pharmacy-visit-1",
      "userPrompt": "TARGET_LANGUAGE: Spanish\nNATIVE_LANGUAGE: en\nCHAPTER_TITLE: Health and Wellness\nLESSON_TITLE: At the Pharmacy\nLESSON_DESCRIPTION: Learn to describe symptoms and buy medicine at a Spanish pharmacy\n\nGenerate an immersive dialogue-driven story activity for this language lesson. Create a realistic everyday scenario where learners practice language production in situations they'd face in a foreign country."
    }
  ],
  "taskId": "activity-story-language"
}
