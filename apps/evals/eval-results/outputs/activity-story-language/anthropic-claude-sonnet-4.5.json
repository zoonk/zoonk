{
  "generatedAt": "2026-01-21T21:30:55.758Z",
  "modelId": "anthropic/claude-sonnet-4.5",
  "outputs": [
    {
      "duration": 50304.25008299999,
      "inputTokens": 3735,
      "output": "{\n  \"scenario\": \"You're at a charming cafe in Paris on a sunny afternoon. You'd like to order something to drink and eat. The waiter approaches your table with a friendly smile.\",\n  \"steps\": [\n    {\n      \"context\": \"Bonjour! Bienvenue. Vous désirez?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Hello! Welcome. What would you like?\",\n      \"options\": [\n        {\n          \"feedback\": \"Hello. I would like to see the menu, please. - Perfect! Polite and appropriate for starting your order when you need to see what's available.\",\n          \"isCorrect\": true,\n          \"text\": \"Bonjour. Je voudrais voir la carte, s'il vous plaît.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"The check, please. - You just sat down and haven't ordered anything yet! First, you need to see the menu and order.\",\n          \"isCorrect\": false,\n          \"text\": \"L'addition, s'il vous plaît.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Where is the bathroom? - The waiter is asking what you'd like to order, not offering to help you find something. Respond to their question first.\",\n          \"isCorrect\": false,\n          \"text\": \"Où sont les toilettes?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"No thank you, I'm just looking. - This is something you'd say in a shop, not at a cafe where you've sat down at a table. The waiter expects you to order.\",\n          \"isCorrect\": false,\n          \"text\": \"Non merci, je regarde seulement.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Bien sûr, voilà. Prenez votre temps.\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Of course, here you are. Take your time.\",\n      \"options\": [\n        {\n          \"feedback\": \"Thank you very much. - Great! A polite acknowledgment while you look at the menu.\",\n          \"isCorrect\": true,\n          \"text\": \"Merci beaucoup.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I'm ready to order now. - But the waiter just handed you the menu! You haven't had time to look at it yet.\",\n          \"isCorrect\": false,\n          \"text\": \"Je suis prêt à commander maintenant.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"What time is it? - This is unrelated to the situation. The waiter just gave you the menu to look at.\",\n          \"isCorrect\": false,\n          \"text\": \"Quelle heure est-il?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"How much is it? - You haven't ordered anything yet, so there's nothing to ask the price of. Look at the menu first.\",\n          \"isCorrect\": false,\n          \"text\": \"C'est combien?\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Vous avez choisi?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Have you decided?\",\n      \"options\": [\n        {\n          \"feedback\": \"Yes. I would like a coffee with cream, please. - Excellent! Clear and polite way to order your drink.\",\n          \"isCorrect\": true,\n          \"text\": \"Oui. Je voudrais un café crème, s'il vous plaît.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Yes. Do you have coffee? - This is a cafe in Paris - of course they have coffee! Instead of asking if they have it, just order what you want.\",\n          \"isCorrect\": false,\n          \"text\": \"Oui. Vous avez du café?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"No, I don't want anything. - Then why are you sitting at a cafe table? If you don't want to order, you shouldn't occupy a table.\",\n          \"isCorrect\": false,\n          \"text\": \"Non, je ne veux rien.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Is the coffee good here? - The waiter is asking if you're ready to order, not inviting you to ask questions about quality. Just order what you'd like.\",\n          \"isCorrect\": false,\n          \"text\": \"Le café est bon ici?\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Un café crème. Très bien. Et avec ça?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"A coffee with cream. Very good. And with that?\",\n      \"options\": [\n        {\n          \"feedback\": \"A croissant, please. - Perfect! You're adding a pastry to go with your coffee.\",\n          \"isCorrect\": true,\n          \"text\": \"Un croissant, s'il vous plaît.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"That's all, thank you. - Also correct! You're indicating you don't want anything else.\",\n          \"isCorrect\": true,\n          \"text\": \"C'est tout, merci.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"With milk and sugar. - The waiter is asking if you want to order anything else, not how you want your coffee prepared. A café crème already comes with milk.\",\n          \"isCorrect\": false,\n          \"text\": \"Avec du lait et du sucre.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I'm not hungry. - This doesn't answer the question. Simply say you don't want anything else rather than explaining why.\",\n          \"isCorrect\": false,\n          \"text\": \"Je n'ai pas faim.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Parfait. Un café crème et un croissant. Tout de suite.\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Perfect. A coffee with cream and a croissant. Right away.\",\n      \"options\": [\n        {\n          \"feedback\": \"Thank you. - Great! A simple, polite acknowledgment.\",\n          \"isCorrect\": true,\n          \"text\": \"Merci.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Wait! I want to change my order. - You just ordered a coffee and croissant. Why would you suddenly change your mind?\",\n          \"isCorrect\": false,\n          \"text\": \"Attendez! Je veux changer ma commande.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"No, that's not correct. - But the waiter just repeated exactly what you ordered. There's nothing wrong.\",\n          \"isCorrect\": false,\n          \"text\": \"Non, ce n'est pas correct.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Do you accept credit cards? - This is a question for when you're paying, not right after ordering. Wait until your food arrives and you're ready for the check.\",\n          \"isCorrect\": false,\n          \"text\": \"Vous acceptez les cartes de crédit?\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Voilà, un café crème et un croissant. Bon appétit!\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Here you are, a coffee with cream and a croissant. Enjoy your meal!\",\n      \"options\": [\n        {\n          \"feedback\": \"Thank you very much! - Perfect! A warm thank you as the waiter brings your order.\",\n          \"isCorrect\": true,\n          \"text\": \"Merci beaucoup!\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"This isn't what I ordered. - But it is exactly what you ordered - a café crème and a croissant!\",\n          \"isCorrect\": false,\n          \"text\": \"Ce n'est pas ce que j'ai commandé.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Can I order now? - You already ordered! The waiter is bringing you what you asked for.\",\n          \"isCorrect\": false,\n          \"text\": \"Je peux commander maintenant?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Do you have tea? - Too late - you already ordered coffee and it's being served to you now.\",\n          \"isCorrect\": false,\n          \"text\": \"Vous avez du thé?\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Excusez-moi, je peux vous apporter autre chose?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Excuse me, can I bring you anything else?\",\n      \"options\": [\n        {\n          \"feedback\": \"No thank you, but I would like the check, please. - Excellent! You're indicating you're finished and ready to pay.\",\n          \"isCorrect\": true,\n          \"text\": \"Non merci, mais je voudrais l'addition, s'il vous plaît.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Yes, a glass of water, please. - Also correct! You're asking for water before you finish.\",\n          \"isCorrect\": true,\n          \"text\": \"Oui, un verre d'eau, s'il vous plaît.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Yes, I would like to see the menu. - You already looked at the menu and ordered. If you want something else, just ask for it directly.\",\n          \"isCorrect\": false,\n          \"text\": \"Oui, je voudrais voir la carte.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"The croissant is delicious, thank you. - While this is a nice compliment, it doesn't answer the waiter's question about whether you want anything else.\",\n          \"isCorrect\": false,\n          \"text\": \"Le croissant est délicieux, merci.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Bien sûr. Voici l'addition. Vous payez comment?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Of course. Here is the check. How will you be paying?\",\n      \"options\": [\n        {\n          \"feedback\": \"By card, please. - Perfect! You're clearly indicating your payment method.\",\n          \"isCorrect\": true,\n          \"text\": \"Par carte, s'il vous plaît.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"In cash, please. - Also correct! Another clear way to indicate how you'll pay.\",\n          \"isCorrect\": true,\n          \"text\": \"En espèces, s'il vous plaît.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"How much is the coffee? - The waiter just gave you the check with the total on it. The question is about how you want to pay, not how much it costs.\",\n          \"isCorrect\": false,\n          \"text\": \"C'est combien le café?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I don't have any money. - This would be a serious problem! You just ate at a cafe - you need to be able to pay.\",\n          \"isCorrect\": false,\n          \"text\": \"Je n'ai pas d'argent.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Parfait. Voilà le terminal. Merci et bonne journée!\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Perfect. Here's the terminal. Thank you and have a nice day!\",\n      \"options\": [\n        {\n          \"feedback\": \"Thank you, have a nice day to you too! - Excellent! A polite way to end the interaction.\",\n          \"isCorrect\": true,\n          \"text\": \"Merci, bonne journée à vous aussi!\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Goodbye and thank you! - Also perfect! A friendly farewell.\",\n          \"isCorrect\": true,\n          \"text\": \"Au revoir et merci!\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Wait, I haven't eaten yet! - But you have! You already had your croissant and coffee and asked for the check.\",\n          \"isCorrect\": false,\n          \"text\": \"Attendez, je n'ai pas encore mangé!\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Hello! - You're leaving, not arriving. Use 'au revoir' (goodbye) instead of 'bonjour' (hello).\",\n          \"isCorrect\": false,\n          \"text\": \"Bonjour!\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    }\n  ]\n}",
      "outputTokens": 3377,
      "systemPrompt": "# Role\n\nYou are an expert language immersion designer specializing in creating realistic, dialogue-driven scenarios that help learners practice language production in authentic contexts. You design experiences that simulate situations learners would encounter when living or traveling in a country where the target language is spoken.\n\n# Goal\n\nCreate an immersive story activity where learners are placed in an everyday situation and must choose appropriate phrases to communicate. The activity simulates real conversations with native speakers, forcing learners to engage with the target language directly rather than relying on translations.\n\nThe activity places learners in a specific scenario (ordering food, asking for directions, checking into a hotel) and guides them through a dialogue where they must select appropriate responses at each step.\n\n# Key Design Principles\n\n## Immersion Over Translation\n\nUnlike other activities where translations help comprehension, this activity intentionally withholds translations from the options. Learners see:\n\n- **Context**: What the native speaker says (in TARGET language with translation)\n- **Options**: Four possible responses (in TARGET language ONLY - no translations)\n\nThis forces learners to:\n\n1. Engage with the target language sounds and patterns\n2. Use context clues to infer meaning\n3. Build recognition before relying on translations\n4. Experience the \"productive uncertainty\" of real conversations\n\nThe translation appears only in the feedback AFTER selection, revealing whether they understood correctly.\n\n## Authentic Scenarios\n\nFocus on situations learners will actually encounter:\n\n| Category       | Example Scenarios                                  |\n| -------------- | -------------------------------------------------- |\n| Food & Dining  | Ordering at a restaurant, asking about ingredients |\n| Transportation | Buying train tickets, asking for directions        |\n| Shopping       | Bargaining at a market, returning an item          |\n| Accommodation  | Checking into a hotel, reporting a problem         |\n| Healthcare     | Describing symptoms at a pharmacy, doctor's visit  |\n| Social         | Meeting neighbors, small talk at a cafe            |\n| Services       | Opening a bank account, getting a phone plan       |\n| Emergencies    | Reporting lost items, asking for help              |\n\n## Supportive Native Speaker\n\nThe character in the story is a friendly native speaker who:\n\n- Speaks naturally but not too fast\n- Helps the learner when they struggle\n- Provides context clues in their responses\n- Never mocks mistakes\n- Gradually introduces more complex language\n\n# Language Handling\n\n## Input Variables\n\n- **TARGET_LANGUAGE**: The language being learned (from `courseTitle`). All dialogue and options are in this language.\n- **NATIVE_LANGUAGE**: The learner's native language (from `language` code). Questions, feedback, and context translations use this language.\n\n## Language Codes\n\n- `en`: US English\n- `pt`: Brazilian Portuguese\n- `es`: Latin American Spanish\n\n## What Appears in Each Language\n\n| Field                        | Language     | Example (Spanish course, English native)                  |\n| ---------------------------- | ------------ | --------------------------------------------------------- |\n| `scenario`                   | NATIVE       | \"You're at a cafe in Madrid and want to order coffee.\"    |\n| `context`                    | TARGET       | \"Buenos dias, que le pongo?\"                              |\n| `contextTranslation`         | NATIVE       | \"Good morning, what can I get you?\"                       |\n| `contextRomanization`        | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].text`             | TARGET       | \"Un cafe con leche, por favor.\"                           |\n| `options[].textRomanization` | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].feedback`         | NATIVE       | \"A coffee with milk, please - Perfect! Polite and clear.\" |\n\n# Options Design\n\n## No Translations in Options\n\nThis is the most critical design decision. Options show ONLY:\n\n- `text`: The phrase in TARGET language\n- `textRomanization`: Romanization for non-Roman scripts (empty string for Roman scripts)\n\n**NO translation is shown**. This forces the learner to:\n\n1. Parse the target language directly\n2. Use patterns they've learned\n3. Make educated guesses based on context\n4. Experience the productive struggle of real communication\n\n## Option Quality\n\nAll 4 options must be:\n\n- **Grammatically correct** in the target language\n- **Contextually plausible** (something a learner might say in this situation)\n- **Distinct in meaning** (not just word variations)\n- **Level-appropriate** (using vocabulary/structures the learner knows)\n\n## Distractor Design\n\n**CRITICAL**: Wrong options must be genuinely inappropriate for the situation - they should lead to miscommunication or confusion if used. Do NOT create distractors that are merely \"less polished\" versions of the correct answer.\n\nWrong options should be **clearly wrong** because they:\n\n1. **Answer a different question**: Respond to something the speaker didn't ask (asking about price when asked about quantity)\n2. **Request the wrong thing**: Order/ask for something different than intended (one-way ticket when you need round-trip)\n3. **Are off-topic**: Say something unrelated to the current conversation point (asking for the check when you just arrived)\n4. **Would cause confusion**: Use words that change the meaning entirely (saying \"no\" when you mean \"yes\")\n\n**DO NOT** create distractors that are:\n\n- Just more/less formal versions of the correct answer\n- Slightly different phrasings that would still work\n- Grammatically awkward but still understandable\n\n# Feedback Design\n\nFeedback appears AFTER the learner selects an option. Every feedback message MUST include:\n\n1. **Translation**: What the option actually means in the native language\n2. **Explanation**: Why this choice is correct or incorrect for the situation\n\n## Feedback Structure\n\nFor **correct** options:\n\n```\n\"[Translation of what they said] - [Why this works in context]\"\n```\n\nExample: \"A coffee with milk, please - Perfect! This is polite and clearly communicates what you want.\"\n\nFor **incorrect** options:\n\n```\n\"[Translation of what they said] - [Why this doesn't work and what would be better]\"\n```\n\nExample: \"Where is the bathroom? - You're trying to order coffee, not find the restroom. Tell the barista what you'd like to drink.\"\n\n# Romanization Requirements\n\nFor languages using non-Roman writing systems (Japanese, Chinese, Korean, Arabic, Russian, Greek, Hebrew, Thai, Hindi, etc.), provide romanization for both context and options.\n\n## Standard Systems\n\n- **Japanese**: Romaji using Hepburn romanization\n- **Chinese**: Pinyin with tone marks\n- **Korean**: Revised Romanization of Korean\n- **Russian**: ISO 9 or BGN/PCGN transliteration\n- **Arabic**: Standard romanization\n- **Greek**: Standard transliteration\n- **Thai**: Royal Thai General System\n- **Hindi**: IAST or Hunterian transliteration\n\n## Roman Scripts\n\nFor languages using Roman letters (Spanish, French, German, Portuguese, Italian, etc.), set both `contextRomanization` and `textRomanization` to empty strings `\"\"`.\n\n# Story Arc\n\nEach story should have 5-10 steps following a natural arc:\n\n## Step Progression\n\n1. **Opening** (1-2 steps): Arrive at the location, initial greeting\n2. **Building** (2-4 steps): Main interaction, making requests, clarifying\n3. **Complication** (0-2 steps): Optional challenge that adds realism\n4. **Resolution** (1-2 steps): Complete the transaction\n5. **Closing** (1 step): Thank and goodbye\n\n## Complication Ideas (Recommended)\n\nAdding a complication makes the story more realistic and teaches learners to handle unexpected situations:\n\n- **Item unavailable**: \"Sorry, we're out of that. Would you like something else?\"\n- **Misunderstanding**: \"Did you say two or twelve?\"\n- **Additional requirement**: \"I'll need to see your ID for that.\"\n- **Clarification needed**: \"Which size did you want?\"\n\n## Pacing Guidelines\n\n- Steps should feel like natural conversation beats\n- Each step presents ONE decision point\n- Context should flow naturally from the previous step\n- The native speaker's response should acknowledge what the learner said\n\n# Output Format\n\nReturn an object with this structure (abbreviated examples shown):\n\n**Non-Roman script example (Japanese):**\n\n```json\n{\n  \"scenario\": \"You're at a train station in Tokyo...\",\n  \"steps\": [\n    {\n      \"context\": \"いらっしゃいませ。どちらまで？\",\n      \"contextTranslation\": \"Welcome. Where to?\",\n      \"contextRomanization\": \"Irasshaimase. Dochira made?\",\n      \"options\": [\n        {\n          \"text\": \"京都までお願いします。\",\n          \"textRomanization\": \"Kyouto made onegaishimasu.\",\n          \"isCorrect\": true,\n          \"feedback\": \"To Kyoto, please - Perfect!\"\n        },\n        {\n          \"text\": \"京都は遠いですか？\",\n          \"textRomanization\": \"Kyouto wa tooi desu ka?\",\n          \"isCorrect\": false,\n          \"feedback\": \"Is Kyoto far? - This asks about distance, not for a ticket.\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n**Roman script example (Spanish) - empty romanization fields:**\n\n```json\n{\n  \"scenario\": \"You're at a restaurant in Barcelona...\",\n  \"steps\": [\n    {\n      \"context\": \"Buenas noches. Estan listos para pedir?\",\n      \"contextTranslation\": \"Good evening. Are you ready to order?\",\n      \"contextRomanization\": \"\",\n      \"options\": [\n        {\n          \"text\": \"Si, me gustaria la paella, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": true,\n          \"feedback\": \"Yes, I would like the paella, please - Perfect!\"\n        },\n        {\n          \"text\": \"La cuenta, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": false,\n          \"feedback\": \"The check, please - You haven't eaten yet!\"\n        }\n      ]\n    }\n  ]\n}\n```\n\nNote: Examples above are abbreviated. Actual output must have 4 options per step and 5-10 steps total.\n\n# Quality Checklist\n\nBefore finalizing, verify:\n\n1. **Grammar accuracy**: All target language text is grammatically correct\n2. **Natural dialogue**: Conversations flow like real interactions\n3. **Appropriate register**: Formality matches the situation (casual cafe vs formal office)\n4. **Cultural accuracy**: Interactions reflect how things work in that culture\n5. **Clear progression**: Steps follow a logical narrative arc\n6. **Distinct options**: Each option represents a meaningfully different choice\n7. **Helpful feedback**: Translations and explanations clarify meaning and context\n8. **Correct romanization**: Follows standard systems for non-Roman scripts, empty for Roman scripts\n9. **Scenario relevance**: The story matches the lesson topic\n10. **Appropriate difficulty**: Language complexity matches learner level\n\n# Common Mistakes to Avoid\n\n1. **Including translations in options**: Options must show TARGET language only\n2. **Trivial distractors**: Options that are obviously wrong or nonsensical\n3. **Inconsistent register**: Mixing formal and informal inappropriately\n4. **Unnatural responses**: Things a native speaker would never actually say\n5. **Missing romanization**: Forgetting to add romanization for non-Roman scripts\n6. **Adding romanization to Roman scripts**: Spanish, French, etc. should have empty strings\n7. **Feedback without translation**: Always include what the option means\n8. **Disconnected steps**: Each step should follow logically from the previous one\n",
      "testCaseId": "en-french-cafe-ordering-1",
      "userPrompt": "TARGET_LANGUAGE: French\nNATIVE_LANGUAGE: en\nCHAPTER_TITLE: At the Cafe\nLESSON_TITLE: Ordering at a Cafe\nLESSON_DESCRIPTION: Practice ordering drinks and food at a French cafe, including asking for the menu and paying\n\nGenerate an immersive dialogue-driven story activity for this language lesson. Create a realistic everyday scenario where learners practice language production in situations they'd face in a foreign country."
    },
    {
      "duration": 65494.963917000015,
      "inputTokens": 3733,
      "output": "{\n  \"scenario\": \"You're checking into a hotel in Osaka after a long flight. You have a reservation for two nights and need to confirm your booking and get information about your room.\",\n  \"steps\": [\n    {\n      \"context\": \"いらっしゃいませ。ご予約はございますか？\",\n      \"contextRomanization\": \"Irasshaimase. Goyoyaku wa gozaimasu ka?\",\n      \"contextTranslation\": \"Welcome. Do you have a reservation?\",\n      \"options\": [\n        {\n          \"feedback\": \"Yes, I have a reservation - Perfect! This clearly confirms you have a booking.\",\n          \"isCorrect\": true,\n          \"text\": \"はい、予約しています。\",\n          \"textRomanization\": \"Hai, yoyaku shiteimasu.\"\n        },\n        {\n          \"feedback\": \"No, do you have rooms available? - You're saying you don't have a reservation and asking about availability. Since you made a booking, you should confirm it instead.\",\n          \"isCorrect\": false,\n          \"text\": \"いいえ、部屋はありますか？\",\n          \"textRomanization\": \"Iie, heya wa arimasu ka?\"\n        },\n        {\n          \"feedback\": \"What time is checkout? - You haven't even checked in yet! First, you need to confirm your reservation.\",\n          \"isCorrect\": false,\n          \"text\": \"チェックアウトは何時ですか？\",\n          \"textRomanization\": \"Chekkuauto wa nanji desu ka?\"\n        },\n        {\n          \"feedback\": \"Thank you. Goodbye - You're leaving before checking in! You need to confirm your reservation first.\",\n          \"isCorrect\": false,\n          \"text\": \"ありがとうございます。さようなら。\",\n          \"textRomanization\": \"Arigatou gozaimasu. Sayounara.\"\n        }\n      ]\n    },\n    {\n      \"context\": \"かしこまりました。お名前をお願いします。\",\n      \"contextRomanization\": \"Kashikomarimashita. Onamae wo onegaishimasu.\",\n      \"contextTranslation\": \"Understood. May I have your name, please?\",\n      \"options\": [\n        {\n          \"feedback\": \"I'm Tanaka - Perfect! You've given your name clearly. (Note: In a real situation, you'd use your actual name)\",\n          \"isCorrect\": true,\n          \"text\": \"田中です。\",\n          \"textRomanization\": \"Tanaka desu.\"\n        },\n        {\n          \"feedback\": \"It's two nights - The staff asked for your name, not the length of your stay. You need to introduce yourself first.\",\n          \"isCorrect\": false,\n          \"text\": \"二泊です。\",\n          \"textRomanization\": \"Nihaku desu.\"\n        },\n        {\n          \"feedback\": \"Where is the room? - They need your name to find your reservation first. They can't tell you where your room is until they verify your booking.\",\n          \"isCorrect\": false,\n          \"text\": \"部屋はどこですか？\",\n          \"textRomanization\": \"Heya wa doko desu ka?\"\n        },\n        {\n          \"feedback\": \"Is breakfast included? - The staff asked for your name to look up your reservation, not about meal options. Answer their question first.\",\n          \"isCorrect\": false,\n          \"text\": \"朝食は含まれていますか？\",\n          \"textRomanization\": \"Choushoku wa fukumareteimasu ka?\"\n        }\n      ]\n    },\n    {\n      \"context\": \"田中様ですね。二泊のご予約を承っております。パスポートを拝見できますか？\",\n      \"contextRomanization\": \"Tanaka-sama desu ne. Nihaku no goyoyaku wo uketamawatte orimasu. Pasupooto wo haiken dekimasu ka?\",\n      \"contextTranslation\": \"Mr./Ms. Tanaka, yes. We have your reservation for two nights. May I see your passport?\",\n      \"options\": [\n        {\n          \"feedback\": \"Yes, here you are - Perfect! You're politely providing your passport as requested.\",\n          \"isCorrect\": true,\n          \"text\": \"はい、どうぞ。\",\n          \"textRomanization\": \"Hai, douzo.\"\n        },\n        {\n          \"feedback\": \"No, I don't have it - You need your passport to check into a hotel in Japan. Saying you don't have it would create a serious problem.\",\n          \"isCorrect\": false,\n          \"text\": \"いいえ、持っていません。\",\n          \"textRomanization\": \"Iie, motte imasen.\"\n        },\n        {\n          \"feedback\": \"How much is the reservation? - The staff asked for your passport to verify your identity, not about the price. You need to provide your passport first.\",\n          \"isCorrect\": false,\n          \"text\": \"予約はいくらですか？\",\n          \"textRomanization\": \"Yoyaku wa ikura desu ka?\"\n        },\n        {\n          \"feedback\": \"I want to change rooms - You haven't even seen your room yet! First, complete the check-in process by showing your passport.\",\n          \"isCorrect\": false,\n          \"text\": \"部屋を変えたいです。\",\n          \"textRomanization\": \"Heya wo kaetai desu.\"\n        }\n      ]\n    },\n    {\n      \"context\": \"ありがとうございます。お部屋は三階の三〇五号室です。申し訳ございませんが、禁煙室しか空いていないのですが、よろしいでしょうか？\",\n      \"contextRomanization\": \"Arigatou gozaimasu. Oheya wa sankai no sanmarugo-goushitsu desu. Moushiwake gozaimasen ga, kin'en-shitsu shika aite inai no desu ga, yoroshii deshou ka?\",\n      \"contextTranslation\": \"Thank you. Your room is 305 on the third floor. I apologize, but we only have non-smoking rooms available. Is that alright?\",\n      \"options\": [\n        {\n          \"feedback\": \"Yes, that's fine - Perfect! You're accepting the non-smoking room arrangement.\",\n          \"isCorrect\": true,\n          \"text\": \"はい、大丈夫です。\",\n          \"textRomanization\": \"Hai, daijoubu desu.\"\n        },\n        {\n          \"feedback\": \"No, I need a smoking room - They just told you that only non-smoking rooms are available. Insisting on a smoking room won't help since they don't have any.\",\n          \"isCorrect\": false,\n          \"text\": \"いいえ、喫煙室が必要です。\",\n          \"textRomanization\": \"Iie, kitsuen-shitsu ga hitsuyou desu.\"\n        },\n        {\n          \"feedback\": \"Please give me the key - The staff asked if you're okay with a non-smoking room. You should answer their question before asking for the key.\",\n          \"isCorrect\": false,\n          \"text\": \"鍵をください。\",\n          \"textRomanization\": \"Kagi wo kudasai.\"\n        },\n        {\n          \"feedback\": \"What time does check-in start? - You're already checking in right now! The staff asked if you're okay with a non-smoking room.\",\n          \"isCorrect\": false,\n          \"text\": \"チェックインは何時からですか？\",\n          \"textRomanization\": \"Chekkuin wa nanji kara desu ka?\"\n        }\n      ]\n    },\n    {\n      \"context\": \"かしこまりました。では、こちらのカードにご記入ください。WiFiのパスワードはカードに書いてあります。\",\n      \"contextRomanization\": \"Kashikomarimashita. Dewa, kochira no kaado ni gokinyuu kudasai. WiFi no pasuwaado wa kaado ni kaite arimasu.\",\n      \"contextTranslation\": \"Understood. Please fill out this card. The WiFi password is written on the card.\",\n      \"options\": [\n        {\n          \"feedback\": \"I understand. Thank you - Perfect! You're acknowledging the instructions and showing appreciation.\",\n          \"isCorrect\": true,\n          \"text\": \"わかりました。ありがとうございます。\",\n          \"textRomanization\": \"Wakarimashita. Arigatou gozaimasu.\"\n        },\n        {\n          \"feedback\": \"I don't need the card - You're refusing to fill out the registration card, which is required for check-in. You need to complete it.\",\n          \"isCorrect\": false,\n          \"text\": \"カードは要りません。\",\n          \"textRomanization\": \"Kaado wa irimasen.\"\n        },\n        {\n          \"feedback\": \"Please return my passport - The staff asked you to fill out a form. They'll return your passport soon, but first acknowledge their current instruction.\",\n          \"isCorrect\": false,\n          \"text\": \"パスポートを返してください。\",\n          \"textRomanization\": \"Pasupooto wo kaeshite kudasai.\"\n        },\n        {\n          \"feedback\": \"What floor is breakfast on? - The staff just gave you instructions about filling out the registration card. Complete that task before asking about breakfast.\",\n          \"isCorrect\": false,\n          \"text\": \"朝食は何階ですか？\",\n          \"textRomanization\": \"Choushoku wa nankai desu ka?\"\n        }\n      ]\n    },\n    {\n      \"context\": \"朝食についてご案内します。朝食は一階のレストランで、七時から十時までです。ご利用になりますか？\",\n      \"contextRomanization\": \"Choushoku ni tsuite goannai shimasu. Choushoku wa ikkai no resutoran de, shichiji kara juuji made desu. Goriyou ni narimasu ka?\",\n      \"contextTranslation\": \"Let me inform you about breakfast. Breakfast is in the restaurant on the first floor, from 7:00 to 10:00. Will you be using it?\",\n      \"options\": [\n        {\n          \"feedback\": \"Yes, please - Perfect! You're indicating that you'd like to have breakfast at the hotel.\",\n          \"isCorrect\": true,\n          \"text\": \"はい、お願いします。\",\n          \"textRomanization\": \"Hai, onegaishimasu.\"\n        },\n        {\n          \"feedback\": \"I want to eat breakfast at 10:00 - Breakfast service ends at 10:00, so arriving exactly at that time would be too late. Simply say yes if you want breakfast.\",\n          \"isCorrect\": false,\n          \"text\": \"十時に朝食を食べたいです。\",\n          \"textRomanization\": \"Juuji ni choushoku wo tabetai desu.\"\n        },\n        {\n          \"feedback\": \"Where is the restaurant? - They just told you it's on the first floor. The question is whether you want to use the breakfast service or not.\",\n          \"isCorrect\": false,\n          \"text\": \"レストランはどこですか？\",\n          \"textRomanization\": \"Resutoran wa doko desu ka?\"\n        },\n        {\n          \"feedback\": \"Is there a refrigerator in the room? - The staff asked if you want breakfast service. Answer their question first before asking about room amenities.\",\n          \"isCorrect\": false,\n          \"text\": \"部屋に冷蔵庫はありますか？\",\n          \"textRomanization\": \"Heya ni reizouko wa arimasu ka?\"\n        }\n      ]\n    },\n    {\n      \"context\": \"かしこまりました。朝食は一人二千円です。お部屋の設備についてご質問はございますか？\",\n      \"contextRomanization\": \"Kashikomarimashita. Choushoku wa hitori nisen'en desu. Oheya no setsubi ni tsuite goshitsumon wa gozaimasu ka?\",\n      \"contextTranslation\": \"Understood. Breakfast is 2,000 yen per person. Do you have any questions about the room facilities?\",\n      \"options\": [\n        {\n          \"feedback\": \"Can I use WiFi in the room? - Good question! Though they mentioned the password earlier, confirming WiFi access in the room is appropriate.\",\n          \"isCorrect\": true,\n          \"text\": \"WiFiは部屋で使えますか？\",\n          \"textRomanization\": \"WiFi wa heya de tsukaemasu ka?\"\n        },\n        {\n          \"feedback\": \"I want to change my reservation - You're in the middle of checking in. They asked about room facilities, not about changing your booking.\",\n          \"isCorrect\": false,\n          \"text\": \"予約を変更したいです。\",\n          \"textRomanization\": \"Yoyaku wo henkou shitai desu.\"\n        },\n        {\n          \"feedback\": \"Please tell me your name - You're asking the staff for their name, which is odd when they're asking if you have questions about the room.\",\n          \"isCorrect\": false,\n          \"text\": \"名前を教えてください。\",\n          \"textRomanization\": \"Namae wo oshiete kudasai.\"\n        },\n        {\n          \"feedback\": \"Check-in please - You're already in the process of checking in! The staff asked if you have questions about room facilities.\",\n          \"isCorrect\": false,\n          \"text\": \"チェックインお願いします。\",\n          \"textRomanization\": \"Chekkuin onegaishimasu.\"\n        }\n      ]\n    },\n    {\n      \"context\": \"はい、部屋で無料でご利用いただけます。エレベーターは右手にございます。何かございましたら、フロントまでお電話ください。\",\n      \"contextRomanization\": \"Hai, heya de muryou de goriyou itadakemasu. Erebeetaa wa migite ni gozaimasu. Nanika gozaimashitara, furonto made odenwa kudasai.\",\n      \"contextTranslation\": \"Yes, you can use it for free in your room. The elevator is on your right. If you need anything, please call the front desk.\",\n      \"options\": [\n        {\n          \"feedback\": \"I understand. Thank you very much - Perfect! This politely concludes the check-in process and shows appreciation for the help.\",\n          \"isCorrect\": true,\n          \"text\": \"わかりました。ありがとうございました。\",\n          \"textRomanization\": \"Wakarimashita. Arigatou gozaimashita.\"\n        },\n        {\n          \"feedback\": \"Is the elevator broken? - They just told you where the elevator is, implying it's working. This question doesn't make sense in context.\",\n          \"isCorrect\": false,\n          \"text\": \"エレベーターは壊れていますか？\",\n          \"textRomanization\": \"Erebeetaa wa kowarete imasu ka?\"\n        },\n        {\n          \"feedback\": \"Where is the front desk? - You're standing at the front desk right now talking to the receptionist! This question is inappropriate.\",\n          \"isCorrect\": false,\n          \"text\": \"フロントはどこですか？\",\n          \"textRomanization\": \"Furonto wa doko desu ka?\"\n        },\n        {\n          \"feedback\": \"How much is the room? - You already made a reservation, so you know the price. The staff just finished helping you check in, so you should thank them.\",\n          \"isCorrect\": false,\n          \"text\": \"部屋はいくらですか？\",\n          \"textRomanization\": \"Heya wa ikura desu ka?\"\n        }\n      ]\n    }\n  ]\n}",
      "outputTokens": 4010,
      "systemPrompt": "# Role\n\nYou are an expert language immersion designer specializing in creating realistic, dialogue-driven scenarios that help learners practice language production in authentic contexts. You design experiences that simulate situations learners would encounter when living or traveling in a country where the target language is spoken.\n\n# Goal\n\nCreate an immersive story activity where learners are placed in an everyday situation and must choose appropriate phrases to communicate. The activity simulates real conversations with native speakers, forcing learners to engage with the target language directly rather than relying on translations.\n\nThe activity places learners in a specific scenario (ordering food, asking for directions, checking into a hotel) and guides them through a dialogue where they must select appropriate responses at each step.\n\n# Key Design Principles\n\n## Immersion Over Translation\n\nUnlike other activities where translations help comprehension, this activity intentionally withholds translations from the options. Learners see:\n\n- **Context**: What the native speaker says (in TARGET language with translation)\n- **Options**: Four possible responses (in TARGET language ONLY - no translations)\n\nThis forces learners to:\n\n1. Engage with the target language sounds and patterns\n2. Use context clues to infer meaning\n3. Build recognition before relying on translations\n4. Experience the \"productive uncertainty\" of real conversations\n\nThe translation appears only in the feedback AFTER selection, revealing whether they understood correctly.\n\n## Authentic Scenarios\n\nFocus on situations learners will actually encounter:\n\n| Category       | Example Scenarios                                  |\n| -------------- | -------------------------------------------------- |\n| Food & Dining  | Ordering at a restaurant, asking about ingredients |\n| Transportation | Buying train tickets, asking for directions        |\n| Shopping       | Bargaining at a market, returning an item          |\n| Accommodation  | Checking into a hotel, reporting a problem         |\n| Healthcare     | Describing symptoms at a pharmacy, doctor's visit  |\n| Social         | Meeting neighbors, small talk at a cafe            |\n| Services       | Opening a bank account, getting a phone plan       |\n| Emergencies    | Reporting lost items, asking for help              |\n\n## Supportive Native Speaker\n\nThe character in the story is a friendly native speaker who:\n\n- Speaks naturally but not too fast\n- Helps the learner when they struggle\n- Provides context clues in their responses\n- Never mocks mistakes\n- Gradually introduces more complex language\n\n# Language Handling\n\n## Input Variables\n\n- **TARGET_LANGUAGE**: The language being learned (from `courseTitle`). All dialogue and options are in this language.\n- **NATIVE_LANGUAGE**: The learner's native language (from `language` code). Questions, feedback, and context translations use this language.\n\n## Language Codes\n\n- `en`: US English\n- `pt`: Brazilian Portuguese\n- `es`: Latin American Spanish\n\n## What Appears in Each Language\n\n| Field                        | Language     | Example (Spanish course, English native)                  |\n| ---------------------------- | ------------ | --------------------------------------------------------- |\n| `scenario`                   | NATIVE       | \"You're at a cafe in Madrid and want to order coffee.\"    |\n| `context`                    | TARGET       | \"Buenos dias, que le pongo?\"                              |\n| `contextTranslation`         | NATIVE       | \"Good morning, what can I get you?\"                       |\n| `contextRomanization`        | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].text`             | TARGET       | \"Un cafe con leche, por favor.\"                           |\n| `options[].textRomanization` | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].feedback`         | NATIVE       | \"A coffee with milk, please - Perfect! Polite and clear.\" |\n\n# Options Design\n\n## No Translations in Options\n\nThis is the most critical design decision. Options show ONLY:\n\n- `text`: The phrase in TARGET language\n- `textRomanization`: Romanization for non-Roman scripts (empty string for Roman scripts)\n\n**NO translation is shown**. This forces the learner to:\n\n1. Parse the target language directly\n2. Use patterns they've learned\n3. Make educated guesses based on context\n4. Experience the productive struggle of real communication\n\n## Option Quality\n\nAll 4 options must be:\n\n- **Grammatically correct** in the target language\n- **Contextually plausible** (something a learner might say in this situation)\n- **Distinct in meaning** (not just word variations)\n- **Level-appropriate** (using vocabulary/structures the learner knows)\n\n## Distractor Design\n\n**CRITICAL**: Wrong options must be genuinely inappropriate for the situation - they should lead to miscommunication or confusion if used. Do NOT create distractors that are merely \"less polished\" versions of the correct answer.\n\nWrong options should be **clearly wrong** because they:\n\n1. **Answer a different question**: Respond to something the speaker didn't ask (asking about price when asked about quantity)\n2. **Request the wrong thing**: Order/ask for something different than intended (one-way ticket when you need round-trip)\n3. **Are off-topic**: Say something unrelated to the current conversation point (asking for the check when you just arrived)\n4. **Would cause confusion**: Use words that change the meaning entirely (saying \"no\" when you mean \"yes\")\n\n**DO NOT** create distractors that are:\n\n- Just more/less formal versions of the correct answer\n- Slightly different phrasings that would still work\n- Grammatically awkward but still understandable\n\n# Feedback Design\n\nFeedback appears AFTER the learner selects an option. Every feedback message MUST include:\n\n1. **Translation**: What the option actually means in the native language\n2. **Explanation**: Why this choice is correct or incorrect for the situation\n\n## Feedback Structure\n\nFor **correct** options:\n\n```\n\"[Translation of what they said] - [Why this works in context]\"\n```\n\nExample: \"A coffee with milk, please - Perfect! This is polite and clearly communicates what you want.\"\n\nFor **incorrect** options:\n\n```\n\"[Translation of what they said] - [Why this doesn't work and what would be better]\"\n```\n\nExample: \"Where is the bathroom? - You're trying to order coffee, not find the restroom. Tell the barista what you'd like to drink.\"\n\n# Romanization Requirements\n\nFor languages using non-Roman writing systems (Japanese, Chinese, Korean, Arabic, Russian, Greek, Hebrew, Thai, Hindi, etc.), provide romanization for both context and options.\n\n## Standard Systems\n\n- **Japanese**: Romaji using Hepburn romanization\n- **Chinese**: Pinyin with tone marks\n- **Korean**: Revised Romanization of Korean\n- **Russian**: ISO 9 or BGN/PCGN transliteration\n- **Arabic**: Standard romanization\n- **Greek**: Standard transliteration\n- **Thai**: Royal Thai General System\n- **Hindi**: IAST or Hunterian transliteration\n\n## Roman Scripts\n\nFor languages using Roman letters (Spanish, French, German, Portuguese, Italian, etc.), set both `contextRomanization` and `textRomanization` to empty strings `\"\"`.\n\n# Story Arc\n\nEach story should have 5-10 steps following a natural arc:\n\n## Step Progression\n\n1. **Opening** (1-2 steps): Arrive at the location, initial greeting\n2. **Building** (2-4 steps): Main interaction, making requests, clarifying\n3. **Complication** (0-2 steps): Optional challenge that adds realism\n4. **Resolution** (1-2 steps): Complete the transaction\n5. **Closing** (1 step): Thank and goodbye\n\n## Complication Ideas (Recommended)\n\nAdding a complication makes the story more realistic and teaches learners to handle unexpected situations:\n\n- **Item unavailable**: \"Sorry, we're out of that. Would you like something else?\"\n- **Misunderstanding**: \"Did you say two or twelve?\"\n- **Additional requirement**: \"I'll need to see your ID for that.\"\n- **Clarification needed**: \"Which size did you want?\"\n\n## Pacing Guidelines\n\n- Steps should feel like natural conversation beats\n- Each step presents ONE decision point\n- Context should flow naturally from the previous step\n- The native speaker's response should acknowledge what the learner said\n\n# Output Format\n\nReturn an object with this structure (abbreviated examples shown):\n\n**Non-Roman script example (Japanese):**\n\n```json\n{\n  \"scenario\": \"You're at a train station in Tokyo...\",\n  \"steps\": [\n    {\n      \"context\": \"いらっしゃいませ。どちらまで？\",\n      \"contextTranslation\": \"Welcome. Where to?\",\n      \"contextRomanization\": \"Irasshaimase. Dochira made?\",\n      \"options\": [\n        {\n          \"text\": \"京都までお願いします。\",\n          \"textRomanization\": \"Kyouto made onegaishimasu.\",\n          \"isCorrect\": true,\n          \"feedback\": \"To Kyoto, please - Perfect!\"\n        },\n        {\n          \"text\": \"京都は遠いですか？\",\n          \"textRomanization\": \"Kyouto wa tooi desu ka?\",\n          \"isCorrect\": false,\n          \"feedback\": \"Is Kyoto far? - This asks about distance, not for a ticket.\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n**Roman script example (Spanish) - empty romanization fields:**\n\n```json\n{\n  \"scenario\": \"You're at a restaurant in Barcelona...\",\n  \"steps\": [\n    {\n      \"context\": \"Buenas noches. Estan listos para pedir?\",\n      \"contextTranslation\": \"Good evening. Are you ready to order?\",\n      \"contextRomanization\": \"\",\n      \"options\": [\n        {\n          \"text\": \"Si, me gustaria la paella, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": true,\n          \"feedback\": \"Yes, I would like the paella, please - Perfect!\"\n        },\n        {\n          \"text\": \"La cuenta, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": false,\n          \"feedback\": \"The check, please - You haven't eaten yet!\"\n        }\n      ]\n    }\n  ]\n}\n```\n\nNote: Examples above are abbreviated. Actual output must have 4 options per step and 5-10 steps total.\n\n# Quality Checklist\n\nBefore finalizing, verify:\n\n1. **Grammar accuracy**: All target language text is grammatically correct\n2. **Natural dialogue**: Conversations flow like real interactions\n3. **Appropriate register**: Formality matches the situation (casual cafe vs formal office)\n4. **Cultural accuracy**: Interactions reflect how things work in that culture\n5. **Clear progression**: Steps follow a logical narrative arc\n6. **Distinct options**: Each option represents a meaningfully different choice\n7. **Helpful feedback**: Translations and explanations clarify meaning and context\n8. **Correct romanization**: Follows standard systems for non-Roman scripts, empty for Roman scripts\n9. **Scenario relevance**: The story matches the lesson topic\n10. **Appropriate difficulty**: Language complexity matches learner level\n\n# Common Mistakes to Avoid\n\n1. **Including translations in options**: Options must show TARGET language only\n2. **Trivial distractors**: Options that are obviously wrong or nonsensical\n3. **Inconsistent register**: Mixing formal and informal inappropriately\n4. **Unnatural responses**: Things a native speaker would never actually say\n5. **Missing romanization**: Forgetting to add romanization for non-Roman scripts\n6. **Adding romanization to Roman scripts**: Spanish, French, etc. should have empty strings\n7. **Feedback without translation**: Always include what the option means\n8. **Disconnected steps**: Each step should follow logically from the previous one\n",
      "testCaseId": "en-japanese-hotel-checkin-1",
      "userPrompt": "TARGET_LANGUAGE: Japanese\nNATIVE_LANGUAGE: en\nCHAPTER_TITLE: Travel and Accommodation\nLESSON_TITLE: Hotel Check-in\nLESSON_DESCRIPTION: Learn to check into a hotel, confirm reservations, and ask about room amenities\n\nGenerate an immersive dialogue-driven story activity for this language lesson. Create a realistic everyday scenario where learners practice language production in situations they'd face in a foreign country."
    },
    {
      "duration": 65492.993707999995,
      "inputTokens": 3739,
      "output": "{\n  \"scenario\": \"Você está em um mercado ao ar livre em Berlim e quer comprar frutas frescas para o café da manhã. Um vendedor simpático se aproxima para ajudá-lo.\",\n  \"steps\": [\n    {\n      \"context\": \"Guten Morgen! Kann ich Ihnen helfen?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Bom dia! Posso ajudá-lo?\",\n      \"options\": [\n        {\n          \"feedback\": \"Sim, eu gostaria de comprar maçãs - Perfeito! Você educadamente expressou o que deseja comprar.\",\n          \"isCorrect\": true,\n          \"text\": \"Ja, ich möchte gerne Äpfel kaufen.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Não, eu vendo maçãs - Você está dizendo que VOCÊ vende maçãs, não que quer comprá-las. Use 'möchte kaufen' (gostaria de comprar).\",\n          \"isCorrect\": false,\n          \"text\": \"Nein, ich verkaufe Äpfel.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Onde fica o banheiro? - O vendedor está oferecendo ajuda para comprar, não perguntando se você precisa do banheiro. Diga o que você quer comprar.\",\n          \"isCorrect\": false,\n          \"text\": \"Wo ist die Toilette?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"A conta, por favor - Você ainda não comprou nada! Primeiro, diga ao vendedor o que você quer.\",\n          \"isCorrect\": false,\n          \"text\": \"Die Rechnung, bitte.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Sehr gerne! Wie viele Äpfel möchten Sie?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Com prazer! Quantas maçãs você gostaria?\",\n      \"options\": [\n        {\n          \"feedback\": \"Eu levo um quilo, por favor - Excelente! Você especificou claramente a quantidade que deseja.\",\n          \"isCorrect\": true,\n          \"text\": \"Ich nehme ein Kilo, bitte.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Quanto custam as peras? - O vendedor perguntou quantas MAÇÃS você quer, não sobre peras. Responda com uma quantidade.\",\n          \"isCorrect\": false,\n          \"text\": \"Wie viel kosten die Birnen?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Eu sou do Brasil - Esta informação não responde à pergunta sobre quantas maçãs você quer. Diga a quantidade.\",\n          \"isCorrect\": false,\n          \"text\": \"Ich bin aus Brasilien.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Não, eu não quero maçãs - Mas você acabou de dizer que queria comprar maçãs! Isso confundiria o vendedor. Diga quantas você quer.\",\n          \"isCorrect\": false,\n          \"text\": \"Nein, ich möchte keine Äpfel.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Ein Kilo Äpfel, perfekt! Die hier sind sehr frisch. Möchten Sie noch etwas anderes?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Um quilo de maçãs, perfeito! Estas aqui são muito frescas. Você gostaria de mais alguma coisa?\",\n      \"options\": [\n        {\n          \"feedback\": \"Sim, eu também preciso de tomates - Ótimo! Você aproveitou a oportunidade para pedir outro item.\",\n          \"isCorrect\": true,\n          \"text\": \"Ja, ich brauche auch Tomaten.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Não obrigado, isso é tudo - Embora seja gramaticalmente correto, você ainda precisa de mais itens para o café da manhã. Aproveite para comprar mais coisas.\",\n          \"isCorrect\": false,\n          \"text\": \"Nein danke, das ist alles.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Onde posso comprar pão? - Você está em uma barraca de frutas e verduras. Pergunte sobre produtos que este vendedor tem.\",\n          \"isCorrect\": false,\n          \"text\": \"Wo kann ich Brot kaufen?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Que horas são? - O vendedor perguntou se você quer mais produtos, não as horas. Responda à pergunta dele.\",\n          \"isCorrect\": false,\n          \"text\": \"Wie spät ist es?\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Natürlich! Wie viele Tomaten hätten Sie gern?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Claro! Quantos tomates você gostaria?\",\n      \"options\": [\n        {\n          \"feedback\": \"Meio quilo, por favor - Perfeito! Você especificou uma quantidade apropriada de forma educada.\",\n          \"isCorrect\": true,\n          \"text\": \"Ein halbes Kilo, bitte.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Os tomates estão frescos? - Embora seja uma pergunta válida, o vendedor está esperando que você diga QUANTOS tomates quer. Responda com uma quantidade primeiro.\",\n          \"isCorrect\": false,\n          \"text\": \"Sind die Tomaten frisch?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Eu não quero tomates - Mas você acabou de dizer que precisa de tomates! Isso confundiria o vendedor completamente.\",\n          \"isCorrect\": false,\n          \"text\": \"Ich möchte keine Tomaten.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Você tem bananas? - O vendedor está perguntando quantos TOMATES você quer. Responda primeiro sobre os tomates antes de perguntar sobre outro produto.\",\n          \"isCorrect\": false,\n          \"text\": \"Haben Sie Bananen?\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Ein halbes Kilo Tomaten, sehr gut. Oh, tut mir leid, aber die Tomaten sind heute aus. Möchten Sie stattdessen Gurken?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Meio quilo de tomates, muito bom. Oh, me desculpe, mas os tomates acabaram hoje. Você gostaria de pepinos no lugar?\",\n      \"options\": [\n        {\n          \"feedback\": \"Sim, com prazer. Eu levo um pepino - Excelente! Você aceitou a alternativa de forma educada e específica.\",\n          \"isCorrect\": true,\n          \"text\": \"Ja, gerne. Ich nehme eine Gurke.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Onde encontro tomates? - O vendedor já disse que os tomates acabaram e ofereceu pepinos como alternativa. Responda se aceita ou não os pepinos.\",\n          \"isCorrect\": false,\n          \"text\": \"Wo finde ich Tomaten?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Eu quero comprar maçãs - Você já comprou maçãs! O vendedor está perguntando se você quer pepinos NO LUGAR dos tomates que acabaram.\",\n          \"isCorrect\": false,\n          \"text\": \"Ich möchte Äpfel kaufen.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Você não tem mais tomates? - Ele acabou de dizer que os tomates acabaram. Repetir a pergunta seria estranho. Responda se você aceita a alternativa dos pepinos.\",\n          \"isCorrect\": false,\n          \"text\": \"Haben Sie keine Tomaten mehr?\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Wunderbar! Eine schöne Gurke für Sie. Brauchen Sie noch etwas?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Maravilhoso! Um belo pepino para você. Você precisa de mais alguma coisa?\",\n      \"options\": [\n        {\n          \"feedback\": \"Você tem morangos frescos? - Perfeito! Você perguntou educadamente sobre outro produto disponível.\",\n          \"isCorrect\": true,\n          \"text\": \"Haben Sie frische Erdbeeren?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Quanto custa o pepino? - Você deveria perguntar o preço NO FINAL, quando terminar de escolher todos os produtos. O vendedor perguntou se você quer mais alguma coisa.\",\n          \"isCorrect\": false,\n          \"text\": \"Wie viel kostet die Gurke?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Não, eu preciso de um pepino - Você já pegou o pepino! Esta resposta não faz sentido. Diga se quer mais produtos ou se já terminou.\",\n          \"isCorrect\": false,\n          \"text\": \"Nein, ich brauche eine Gurke.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Eu quero pagar - Você pode aproveitar para comprar mais frutas frescas para o café da manhã antes de pagar.\",\n          \"isCorrect\": false,\n          \"text\": \"Ich möchte bezahlen.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Ja, natürlich! Die Erdbeeren sind heute Morgen angekommen, sehr süß. Wie viel möchten Sie?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Sim, claro! Os morangos chegaram hoje de manhã, muito doces. Quanto você gostaria?\",\n      \"options\": [\n        {\n          \"feedback\": \"Uma cesta, por favor - Excelente! Você usou a medida apropriada para morangos (Schale = cesta/bandeja).\",\n          \"isCorrect\": true,\n          \"text\": \"Eine Schale, bitte.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Dois quilos de morangos, por favor - Isso é uma quantidade muito grande de morangos! Seria mais natural pedir uma cesta (Schale).\",\n          \"isCorrect\": false,\n          \"text\": \"Zwei Kilo Erdbeeren, bitte.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Os morangos são caros? - O vendedor perguntou QUANTO você quer, não sobre o preço. Responda com uma quantidade primeiro.\",\n          \"isCorrect\": false,\n          \"text\": \"Sind die Erdbeeren teuer?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Eu não gosto de morangos - Mas você acabou de perguntar sobre eles! Por que perguntaria se não gosta? Isso confundiria o vendedor.\",\n          \"isCorrect\": false,\n          \"text\": \"Ich mag keine Erdbeeren.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Perfekt! Eine Schale Erdbeeren. So, das macht zusammen 8 Euro 50. Sonst noch etwas?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Perfeito! Uma cesta de morangos. Então, isso dá 8 euros e 50 no total. Mais alguma coisa?\",\n      \"options\": [\n        {\n          \"feedback\": \"Não obrigado, isso é tudo - Perfeito! Você educadamente indicou que terminou suas compras.\",\n          \"isCorrect\": true,\n          \"text\": \"Nein danke, das ist alles.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Quanto custa? - O vendedor acabou de dizer o preço total: 8 euros e 50. Você não estava prestando atenção?\",\n          \"isCorrect\": false,\n          \"text\": \"Wie viel kostet das?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Eu também preciso de maçãs - Você já comprou maçãs no início! Seria estranho pedir de novo.\",\n          \"isCorrect\": false,\n          \"text\": \"Ich brauche auch Äpfel.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Onde fica a saída? - Você ainda precisa pagar! O vendedor perguntou se você quer mais alguma coisa, não sobre a saída.\",\n          \"isCorrect\": false,\n          \"text\": \"Wo ist der Ausgang?\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Gut! Hier ist eine Tüte für Ihr Obst und Gemüse. Möchten Sie bar oder mit Karte bezahlen?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Bom! Aqui está uma sacola para suas frutas e verduras. Você quer pagar em dinheiro ou com cartão?\",\n      \"options\": [\n        {\n          \"feedback\": \"Com cartão, por favor - Perfeito! Você claramente indicou seu método de pagamento preferido.\",\n          \"isCorrect\": true,\n          \"text\": \"Mit Karte, bitte.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Sim, eu quero pagar - Isso não responde à pergunta sobre COMO você quer pagar (dinheiro ou cartão).\",\n          \"isCorrect\": false,\n          \"text\": \"Ja, ich möchte bezahlen.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Quanto custa uma sacola? - O vendedor está perguntando sobre o método de pagamento, não sobre o preço da sacola. Responda como você quer pagar.\",\n          \"isCorrect\": false,\n          \"text\": \"Wie viel kostet eine Tüte?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Você tem troco? - Perguntar sobre troco só faz sentido se você for pagar em dinheiro. Primeiro, responda COMO você quer pagar.\",\n          \"isCorrect\": false,\n          \"text\": \"Haben Sie Wechselgeld?\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Sehr gut, hier ist das Kartenlesegerät. Vielen Dank für Ihren Einkauf und einen schönen Tag noch!\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Muito bom, aqui está a maquininha de cartão. Muito obrigado pela sua compra e tenha um bom dia!\",\n      \"options\": [\n        {\n          \"feedback\": \"Obrigado, para você também! Até logo! - Perfeito! Você finalizou a conversa de forma educada e apropriada.\",\n          \"isCorrect\": true,\n          \"text\": \"Danke, Ihnen auch! Auf Wiedersehen!\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Onde encontro leite? - Você já terminou suas compras e o vendedor está se despedindo. É hora de agradecer e se despedir também.\",\n          \"isCorrect\": false,\n          \"text\": \"Wo finde ich Milch?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Eu ainda quero bananas - Tarde demais! Você já confirmou que não queria mais nada e está pagando. Deveria ter pedido antes.\",\n          \"isCorrect\": false,\n          \"text\": \"Ich möchte noch Bananen.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Bom dia! - Você já disse 'bom dia' no início da conversa. Agora é hora de se despedir com 'auf Wiedersehen' (até logo).\",\n          \"isCorrect\": false,\n          \"text\": \"Guten Morgen!\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    }\n  ]\n}",
      "outputTokens": 4467,
      "systemPrompt": "# Role\n\nYou are an expert language immersion designer specializing in creating realistic, dialogue-driven scenarios that help learners practice language production in authentic contexts. You design experiences that simulate situations learners would encounter when living or traveling in a country where the target language is spoken.\n\n# Goal\n\nCreate an immersive story activity where learners are placed in an everyday situation and must choose appropriate phrases to communicate. The activity simulates real conversations with native speakers, forcing learners to engage with the target language directly rather than relying on translations.\n\nThe activity places learners in a specific scenario (ordering food, asking for directions, checking into a hotel) and guides them through a dialogue where they must select appropriate responses at each step.\n\n# Key Design Principles\n\n## Immersion Over Translation\n\nUnlike other activities where translations help comprehension, this activity intentionally withholds translations from the options. Learners see:\n\n- **Context**: What the native speaker says (in TARGET language with translation)\n- **Options**: Four possible responses (in TARGET language ONLY - no translations)\n\nThis forces learners to:\n\n1. Engage with the target language sounds and patterns\n2. Use context clues to infer meaning\n3. Build recognition before relying on translations\n4. Experience the \"productive uncertainty\" of real conversations\n\nThe translation appears only in the feedback AFTER selection, revealing whether they understood correctly.\n\n## Authentic Scenarios\n\nFocus on situations learners will actually encounter:\n\n| Category       | Example Scenarios                                  |\n| -------------- | -------------------------------------------------- |\n| Food & Dining  | Ordering at a restaurant, asking about ingredients |\n| Transportation | Buying train tickets, asking for directions        |\n| Shopping       | Bargaining at a market, returning an item          |\n| Accommodation  | Checking into a hotel, reporting a problem         |\n| Healthcare     | Describing symptoms at a pharmacy, doctor's visit  |\n| Social         | Meeting neighbors, small talk at a cafe            |\n| Services       | Opening a bank account, getting a phone plan       |\n| Emergencies    | Reporting lost items, asking for help              |\n\n## Supportive Native Speaker\n\nThe character in the story is a friendly native speaker who:\n\n- Speaks naturally but not too fast\n- Helps the learner when they struggle\n- Provides context clues in their responses\n- Never mocks mistakes\n- Gradually introduces more complex language\n\n# Language Handling\n\n## Input Variables\n\n- **TARGET_LANGUAGE**: The language being learned (from `courseTitle`). All dialogue and options are in this language.\n- **NATIVE_LANGUAGE**: The learner's native language (from `language` code). Questions, feedback, and context translations use this language.\n\n## Language Codes\n\n- `en`: US English\n- `pt`: Brazilian Portuguese\n- `es`: Latin American Spanish\n\n## What Appears in Each Language\n\n| Field                        | Language     | Example (Spanish course, English native)                  |\n| ---------------------------- | ------------ | --------------------------------------------------------- |\n| `scenario`                   | NATIVE       | \"You're at a cafe in Madrid and want to order coffee.\"    |\n| `context`                    | TARGET       | \"Buenos dias, que le pongo?\"                              |\n| `contextTranslation`         | NATIVE       | \"Good morning, what can I get you?\"                       |\n| `contextRomanization`        | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].text`             | TARGET       | \"Un cafe con leche, por favor.\"                           |\n| `options[].textRomanization` | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].feedback`         | NATIVE       | \"A coffee with milk, please - Perfect! Polite and clear.\" |\n\n# Options Design\n\n## No Translations in Options\n\nThis is the most critical design decision. Options show ONLY:\n\n- `text`: The phrase in TARGET language\n- `textRomanization`: Romanization for non-Roman scripts (empty string for Roman scripts)\n\n**NO translation is shown**. This forces the learner to:\n\n1. Parse the target language directly\n2. Use patterns they've learned\n3. Make educated guesses based on context\n4. Experience the productive struggle of real communication\n\n## Option Quality\n\nAll 4 options must be:\n\n- **Grammatically correct** in the target language\n- **Contextually plausible** (something a learner might say in this situation)\n- **Distinct in meaning** (not just word variations)\n- **Level-appropriate** (using vocabulary/structures the learner knows)\n\n## Distractor Design\n\n**CRITICAL**: Wrong options must be genuinely inappropriate for the situation - they should lead to miscommunication or confusion if used. Do NOT create distractors that are merely \"less polished\" versions of the correct answer.\n\nWrong options should be **clearly wrong** because they:\n\n1. **Answer a different question**: Respond to something the speaker didn't ask (asking about price when asked about quantity)\n2. **Request the wrong thing**: Order/ask for something different than intended (one-way ticket when you need round-trip)\n3. **Are off-topic**: Say something unrelated to the current conversation point (asking for the check when you just arrived)\n4. **Would cause confusion**: Use words that change the meaning entirely (saying \"no\" when you mean \"yes\")\n\n**DO NOT** create distractors that are:\n\n- Just more/less formal versions of the correct answer\n- Slightly different phrasings that would still work\n- Grammatically awkward but still understandable\n\n# Feedback Design\n\nFeedback appears AFTER the learner selects an option. Every feedback message MUST include:\n\n1. **Translation**: What the option actually means in the native language\n2. **Explanation**: Why this choice is correct or incorrect for the situation\n\n## Feedback Structure\n\nFor **correct** options:\n\n```\n\"[Translation of what they said] - [Why this works in context]\"\n```\n\nExample: \"A coffee with milk, please - Perfect! This is polite and clearly communicates what you want.\"\n\nFor **incorrect** options:\n\n```\n\"[Translation of what they said] - [Why this doesn't work and what would be better]\"\n```\n\nExample: \"Where is the bathroom? - You're trying to order coffee, not find the restroom. Tell the barista what you'd like to drink.\"\n\n# Romanization Requirements\n\nFor languages using non-Roman writing systems (Japanese, Chinese, Korean, Arabic, Russian, Greek, Hebrew, Thai, Hindi, etc.), provide romanization for both context and options.\n\n## Standard Systems\n\n- **Japanese**: Romaji using Hepburn romanization\n- **Chinese**: Pinyin with tone marks\n- **Korean**: Revised Romanization of Korean\n- **Russian**: ISO 9 or BGN/PCGN transliteration\n- **Arabic**: Standard romanization\n- **Greek**: Standard transliteration\n- **Thai**: Royal Thai General System\n- **Hindi**: IAST or Hunterian transliteration\n\n## Roman Scripts\n\nFor languages using Roman letters (Spanish, French, German, Portuguese, Italian, etc.), set both `contextRomanization` and `textRomanization` to empty strings `\"\"`.\n\n# Story Arc\n\nEach story should have 5-10 steps following a natural arc:\n\n## Step Progression\n\n1. **Opening** (1-2 steps): Arrive at the location, initial greeting\n2. **Building** (2-4 steps): Main interaction, making requests, clarifying\n3. **Complication** (0-2 steps): Optional challenge that adds realism\n4. **Resolution** (1-2 steps): Complete the transaction\n5. **Closing** (1 step): Thank and goodbye\n\n## Complication Ideas (Recommended)\n\nAdding a complication makes the story more realistic and teaches learners to handle unexpected situations:\n\n- **Item unavailable**: \"Sorry, we're out of that. Would you like something else?\"\n- **Misunderstanding**: \"Did you say two or twelve?\"\n- **Additional requirement**: \"I'll need to see your ID for that.\"\n- **Clarification needed**: \"Which size did you want?\"\n\n## Pacing Guidelines\n\n- Steps should feel like natural conversation beats\n- Each step presents ONE decision point\n- Context should flow naturally from the previous step\n- The native speaker's response should acknowledge what the learner said\n\n# Output Format\n\nReturn an object with this structure (abbreviated examples shown):\n\n**Non-Roman script example (Japanese):**\n\n```json\n{\n  \"scenario\": \"You're at a train station in Tokyo...\",\n  \"steps\": [\n    {\n      \"context\": \"いらっしゃいませ。どちらまで？\",\n      \"contextTranslation\": \"Welcome. Where to?\",\n      \"contextRomanization\": \"Irasshaimase. Dochira made?\",\n      \"options\": [\n        {\n          \"text\": \"京都までお願いします。\",\n          \"textRomanization\": \"Kyouto made onegaishimasu.\",\n          \"isCorrect\": true,\n          \"feedback\": \"To Kyoto, please - Perfect!\"\n        },\n        {\n          \"text\": \"京都は遠いですか？\",\n          \"textRomanization\": \"Kyouto wa tooi desu ka?\",\n          \"isCorrect\": false,\n          \"feedback\": \"Is Kyoto far? - This asks about distance, not for a ticket.\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n**Roman script example (Spanish) - empty romanization fields:**\n\n```json\n{\n  \"scenario\": \"You're at a restaurant in Barcelona...\",\n  \"steps\": [\n    {\n      \"context\": \"Buenas noches. Estan listos para pedir?\",\n      \"contextTranslation\": \"Good evening. Are you ready to order?\",\n      \"contextRomanization\": \"\",\n      \"options\": [\n        {\n          \"text\": \"Si, me gustaria la paella, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": true,\n          \"feedback\": \"Yes, I would like the paella, please - Perfect!\"\n        },\n        {\n          \"text\": \"La cuenta, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": false,\n          \"feedback\": \"The check, please - You haven't eaten yet!\"\n        }\n      ]\n    }\n  ]\n}\n```\n\nNote: Examples above are abbreviated. Actual output must have 4 options per step and 5-10 steps total.\n\n# Quality Checklist\n\nBefore finalizing, verify:\n\n1. **Grammar accuracy**: All target language text is grammatically correct\n2. **Natural dialogue**: Conversations flow like real interactions\n3. **Appropriate register**: Formality matches the situation (casual cafe vs formal office)\n4. **Cultural accuracy**: Interactions reflect how things work in that culture\n5. **Clear progression**: Steps follow a logical narrative arc\n6. **Distinct options**: Each option represents a meaningfully different choice\n7. **Helpful feedback**: Translations and explanations clarify meaning and context\n8. **Correct romanization**: Follows standard systems for non-Roman scripts, empty for Roman scripts\n9. **Scenario relevance**: The story matches the lesson topic\n10. **Appropriate difficulty**: Language complexity matches learner level\n\n# Common Mistakes to Avoid\n\n1. **Including translations in options**: Options must show TARGET language only\n2. **Trivial distractors**: Options that are obviously wrong or nonsensical\n3. **Inconsistent register**: Mixing formal and informal inappropriately\n4. **Unnatural responses**: Things a native speaker would never actually say\n5. **Missing romanization**: Forgetting to add romanization for non-Roman scripts\n6. **Adding romanization to Roman scripts**: Spanish, French, etc. should have empty strings\n7. **Feedback without translation**: Always include what the option means\n8. **Disconnected steps**: Each step should follow logically from the previous one\n",
      "testCaseId": "pt-german-market-shopping-1",
      "userPrompt": "TARGET_LANGUAGE: German\nNATIVE_LANGUAGE: pt\nCHAPTER_TITLE: Fazendo Compras\nLESSON_TITLE: No Mercado\nLESSON_DESCRIPTION: Aprenda a comprar frutas, verduras e outros itens em um mercado alemao\n\nGenerate an immersive dialogue-driven story activity for this language lesson. Create a realistic everyday scenario where learners practice language production in situations they'd face in a foreign country."
    },
    {
      "duration": 134747.490375,
      "inputTokens": 3737,
      "output": "{\n  \"scenario\": \"Estás en Seúl, perdido en el barrio de Hongdae, y necesitas llegar a la estación de metro. Decides preguntarle a un transeúnte amable que está esperando en un cruce.\",\n  \"steps\": [\n    {\n      \"context\": \"안녕하세요! 도와드릴까요?\",\n      \"contextRomanization\": \"Annyeonghaseyo! Dowa deurilkkayo?\",\n      \"contextTranslation\": \"¡Hola! ¿Puedo ayudarte?\",\n      \"options\": [\n        {\n          \"feedback\": \"Sí, ¿dónde está la estación Hongdae-ipgu? - ¡Perfecto! Has preguntado educadamente por la ubicación de la estación de metro.\",\n          \"isCorrect\": true,\n          \"text\": \"네, 홍대입구역이 어디예요?\",\n          \"textRomanization\": \"Ne, Hongdae-ipgu-yeogi eodiyeyo?\"\n        },\n        {\n          \"feedback\": \"Soy turista - Esta información es cierta, pero no responde a su oferta de ayuda. Deberías preguntar específicamente por la estación.\",\n          \"isCorrect\": false,\n          \"text\": \"저는 관광객이에요.\",\n          \"textRomanization\": \"Jeoneun gwangwanggaegieyo.\"\n        },\n        {\n          \"feedback\": \"No, estoy bien - Esto rechaza su ayuda cuando realmente necesitas direcciones. Di que sí y pregunta por la estación.\",\n          \"isCorrect\": false,\n          \"text\": \"아니요, 괜찮아요.\",\n          \"textRomanization\": \"Aniyo, gwaenchanayo.\"\n        },\n        {\n          \"feedback\": \"Gracias, adiós - Estás despidiéndote antes de obtener las direcciones que necesitas. Primero pregunta por la estación.\",\n          \"isCorrect\": false,\n          \"text\": \"감사합니다, 안녕히 가세요.\",\n          \"textRomanization\": \"Gamsahamnida, annyeonghi gaseyo.\"\n        }\n      ]\n    },\n    {\n      \"context\": \"아, 홍대입구역이요? 여기서 가까워요. 이 길로 쭉 가세요.\",\n      \"contextRomanization\": \"A, Hongdae-ipgu-yeogiyo? Yeogiseo gakkaweoyo. I gillo jjuk gaseyo.\",\n      \"contextTranslation\": \"¿Ah, la estación Hongdae-ipgu? Está cerca de aquí. Sigue recto por esta calle.\",\n      \"options\": [\n        {\n          \"feedback\": \"¿Cuánto tiempo toma? - ¡Excelente! Estás pidiendo más detalles para entender mejor cómo llegar.\",\n          \"isCorrect\": true,\n          \"text\": \"얼마나 걸려요?\",\n          \"textRomanization\": \"Eolmana geollyeoyo?\"\n        },\n        {\n          \"feedback\": \"Quiero tomar un taxi - La persona acaba de decirte que está cerca. Es innecesario tomar un taxi para una distancia corta. Pregunta cuánto tiempo toma caminar.\",\n          \"isCorrect\": false,\n          \"text\": \"택시를 타고 싶어요.\",\n          \"textRomanization\": \"Taeksireul tago sipeoyo.\"\n        },\n        {\n          \"feedback\": \"¿Dónde está el metro? - Ya preguntaste esto y te están dando direcciones. Escucha sus instrucciones y pide clarificación sobre el tiempo.\",\n          \"isCorrect\": false,\n          \"text\": \"지하철은 어디예요?\",\n          \"textRomanization\": \"Jihacheoreun eodiyeyo?\"\n        },\n        {\n          \"feedback\": \"Me perdí - Esto ya es obvio y no avanza la conversación. Ya te están dando direcciones, así que pregunta algo útil como el tiempo de caminata.\",\n          \"isCorrect\": false,\n          \"text\": \"길을 잃었어요.\",\n          \"textRomanization\": \"Gireul ireosseoyo.\"\n        }\n      ]\n    },\n    {\n      \"context\": \"걸어서 한 5분 정도요. 신호등이 보이죠?\",\n      \"contextRomanization\": \"Georeoseo han 5-bun jeongdoyo. Sinhodeungi boijyo?\",\n      \"contextTranslation\": \"Unos 5 minutos caminando. ¿Ves el semáforo?\",\n      \"options\": [\n        {\n          \"feedback\": \"Sí, lo veo - ¡Bien! Confirmas que ves el punto de referencia que te está indicando.\",\n          \"isCorrect\": true,\n          \"text\": \"네, 보여요.\",\n          \"textRomanization\": \"Ne, boyeoyo.\"\n        },\n        {\n          \"feedback\": \"No, son 10 minutos - La persona te está diciendo el tiempo, no preguntando. Además, contradecir su estimación no tiene sentido. Confirma si ves el semáforo.\",\n          \"isCorrect\": false,\n          \"text\": \"아니요, 10분이에요.\",\n          \"textRomanization\": \"Aniyo, 10-bunieyo.\"\n        },\n        {\n          \"feedback\": \"5 minutos es demasiado largo - Cinco minutos es muy poco tiempo. Esta queja es innecesaria. Responde si ves el semáforo que te indica.\",\n          \"isCorrect\": false,\n          \"text\": \"5분은 너무 길어요.\",\n          \"textRomanization\": \"5-buneun neomu gireoyo.\"\n        },\n        {\n          \"feedback\": \"¿Qué hora es? - La persona te está dando direcciones, no hablando del horario. Concéntrate en las indicaciones y confirma si ves el semáforo.\",\n          \"isCorrect\": false,\n          \"text\": \"지금 몇 시예요?\",\n          \"textRomanization\": \"Jigeum myeot siyeyo?\"\n        }\n      ]\n    },\n    {\n      \"context\": \"좋아요. 신호등에서 왼쪽으로 도세요.\",\n      \"contextRomanization\": \"Joayo. Sinhodeungeseo oenjjogeuro doseyo.\",\n      \"contextTranslation\": \"Bien. En el semáforo, gira a la izquierda.\",\n      \"options\": [\n        {\n          \"feedback\": \"¿A la izquierda? Entiendo - ¡Perfecto! Confirmas la dirección para asegurarte de haber entendido correctamente.\",\n          \"isCorrect\": true,\n          \"text\": \"왼쪽이요? 알겠습니다.\",\n          \"textRomanization\": \"Oenjjogieyo? Algesseumnida.\"\n        },\n        {\n          \"feedback\": \"Iré a la derecha - La persona dijo izquierda, no derecha. Esto te llevará en la dirección equivocada. Confirma que entendiste: a la izquierda.\",\n          \"isCorrect\": false,\n          \"text\": \"오른쪽으로 갈게요.\",\n          \"textRomanization\": \"Oreunjjogeuro galgeyo.\"\n        },\n        {\n          \"feedback\": \"¿Qué es un semáforo? - Acabas de confirmar que lo veías. Esta pregunta no tiene sentido ahora. Confirma la dirección: izquierda.\",\n          \"isCorrect\": false,\n          \"text\": \"신호등이 뭐예요?\",\n          \"textRomanization\": \"Sinhodeungi mwoyeyo?\"\n        },\n        {\n          \"feedback\": \"¿Debería seguir recto? - No, la persona claramente dijo que gires a la izquierda. Confirma que entendiste la dirección correcta.\",\n          \"isCorrect\": false,\n          \"text\": \"직진하면 돼요?\",\n          \"textRomanization\": \"Jikjinhamyeon dwaeyo?\"\n        }\n      ]\n    },\n    {\n      \"context\": \"네, 맞아요. 그리고 조금만 더 가면 큰 건물이 있어요.\",\n      \"contextRomanization\": \"Ne, majayo. Geurigo jogeumman deo gamyeon keun geonmuri isseoyo.\",\n      \"contextTranslation\": \"Sí, correcto. Y si caminas un poco más, hay un edificio grande.\",\n      \"options\": [\n        {\n          \"feedback\": \"¿Qué edificio es? - ¡Bien! Pides más detalles para identificar mejor el punto de referencia.\",\n          \"isCorrect\": true,\n          \"text\": \"무슨 건물이에요?\",\n          \"textRomanization\": \"Museun geonmurieyo?\"\n        },\n        {\n          \"feedback\": \"¿Entro al edificio? - El edificio es solo un punto de referencia, no tu destino. La estación de metro es tu objetivo. Pregunta qué edificio es.\",\n          \"isCorrect\": false,\n          \"text\": \"건물 안으로 들어가요?\",\n          \"textRomanization\": \"Geonmul aneuro deureogayo?\"\n        },\n        {\n          \"feedback\": \"No me gustan los edificios grandes - Esta es una respuesta extraña e irrelevante. El edificio es solo una referencia para ayudarte a encontrar la estación.\",\n          \"isCorrect\": false,\n          \"text\": \"큰 건물이 싫어요.\",\n          \"textRomanization\": \"Keun geonmuri sireoyo.\"\n        },\n        {\n          \"feedback\": \"¿Dónde está un edificio pequeño? - Esto no tiene relación con las direcciones a la estación. Pregunta qué edificio grande es el que menciona.\",\n          \"isCorrect\": false,\n          \"text\": \"작은 건물은 어디예요?\",\n          \"textRomanization\": \"Jageun geonmureun eodiyeyo?\"\n        }\n      ]\n    },\n    {\n      \"context\": \"스타벅스예요. 그 옆이 바로 지하철역이에요.\",\n      \"contextRomanization\": \"Seutabeokseu-yeyo. Geu yeopi baro jihacheol-yeogieyo.\",\n      \"contextTranslation\": \"Es un Starbucks. Justo al lado está la estación de metro.\",\n      \"options\": [\n        {\n          \"feedback\": \"Ah, al lado del Starbucks. ¡Gracias! - ¡Excelente! Has confirmado que entendiste y agradeces la ayuda de forma educada.\",\n          \"isCorrect\": true,\n          \"text\": \"아, 스타벅스 옆이군요. 감사합니다!\",\n          \"textRomanization\": \"A, Seutabeokseu yeopigunyo. Gamsahamnida!\"\n        },\n        {\n          \"feedback\": \"¿Tomamos café en Starbucks? - Esto suena como una invitación inadecuada a un extraño cuando solo necesitas llegar a la estación. Agradece las direcciones.\",\n          \"isCorrect\": false,\n          \"text\": \"스타벅스에서 커피 마실까요?\",\n          \"textRomanization\": \"Seutabeokeseueseo keopi masilkkayo?\"\n        },\n        {\n          \"feedback\": \"¿El Starbucks está lejos? - Ya te dijeron que son 5 minutos caminando. No hagas preguntas que ya fueron respondidas. Solo agradece.\",\n          \"isCorrect\": false,\n          \"text\": \"스타벅스는 멀어요?\",\n          \"textRomanization\": \"Seutabeogseuneun meoreoyo?\"\n        },\n        {\n          \"feedback\": \"Por favor, repítalo una vez más - Las instrucciones fueron claras: recto, izquierda en el semáforo, Starbucks, estación al lado. No necesitas que las repita. Agradece la ayuda.\",\n          \"isCorrect\": false,\n          \"text\": \"다시 한번 말씀해 주세요.\",\n          \"textRomanization\": \"Dasi hanbeon malsseum hae juseyo.\"\n        }\n      ]\n    },\n    {\n      \"context\": \"천만에요. 혹시 길을 잃으면 다른 사람에게 물어보세요.\",\n      \"contextRomanization\": \"Cheonmaneyo. Hoksi gireul ireumyeon dareun saramege mureoboseyo.\",\n      \"contextTranslation\": \"De nada. Si te pierdes, pregúntale a otra persona.\",\n      \"options\": [\n        {\n          \"feedback\": \"Sí, entiendo. ¡Que tenga un buen día! - ¡Perfecto! Terminas la conversación de manera educada y positiva.\",\n          \"isCorrect\": true,\n          \"text\": \"네, 알겠어요. 좋은 하루 되세요!\",\n          \"textRomanization\": \"Ne, algesseoyo. Joeun haru doeseyo!\"\n        },\n        {\n          \"feedback\": \"Me voy a perder - Esta es una respuesta negativa e innecesaria. Las direcciones fueron claras. Simplemente despídete educadamente.\",\n          \"isCorrect\": false,\n          \"text\": \"저는 길을 잃을 거예요.\",\n          \"textRomanization\": \"Jeoneun gireul ireul geoyeyo.\"\n        },\n        {\n          \"feedback\": \"¿Dónde está otra persona? - Es un consejo general para el futuro, no una instrucción de buscar a alguien ahora. Despídete amablemente.\",\n          \"isCorrect\": false,\n          \"text\": \"다른 사람은 어디 있어요?\",\n          \"textRomanization\": \"Dareun sarameun eodi isseoyo?\"\n        },\n        {\n          \"feedback\": \"¿Por qué me ayudaste? - Esta pregunta suena extraña y desconfiada cuando alguien fue amable. Simplemente agradece y despídete.\",\n          \"isCorrect\": false,\n          \"text\": \"왜 도와줬어요?\",\n          \"textRomanization\": \"Wae dowajwosseoyo?\"\n        }\n      ]\n    }\n  ]\n}",
      "outputTokens": 3850,
      "systemPrompt": "# Role\n\nYou are an expert language immersion designer specializing in creating realistic, dialogue-driven scenarios that help learners practice language production in authentic contexts. You design experiences that simulate situations learners would encounter when living or traveling in a country where the target language is spoken.\n\n# Goal\n\nCreate an immersive story activity where learners are placed in an everyday situation and must choose appropriate phrases to communicate. The activity simulates real conversations with native speakers, forcing learners to engage with the target language directly rather than relying on translations.\n\nThe activity places learners in a specific scenario (ordering food, asking for directions, checking into a hotel) and guides them through a dialogue where they must select appropriate responses at each step.\n\n# Key Design Principles\n\n## Immersion Over Translation\n\nUnlike other activities where translations help comprehension, this activity intentionally withholds translations from the options. Learners see:\n\n- **Context**: What the native speaker says (in TARGET language with translation)\n- **Options**: Four possible responses (in TARGET language ONLY - no translations)\n\nThis forces learners to:\n\n1. Engage with the target language sounds and patterns\n2. Use context clues to infer meaning\n3. Build recognition before relying on translations\n4. Experience the \"productive uncertainty\" of real conversations\n\nThe translation appears only in the feedback AFTER selection, revealing whether they understood correctly.\n\n## Authentic Scenarios\n\nFocus on situations learners will actually encounter:\n\n| Category       | Example Scenarios                                  |\n| -------------- | -------------------------------------------------- |\n| Food & Dining  | Ordering at a restaurant, asking about ingredients |\n| Transportation | Buying train tickets, asking for directions        |\n| Shopping       | Bargaining at a market, returning an item          |\n| Accommodation  | Checking into a hotel, reporting a problem         |\n| Healthcare     | Describing symptoms at a pharmacy, doctor's visit  |\n| Social         | Meeting neighbors, small talk at a cafe            |\n| Services       | Opening a bank account, getting a phone plan       |\n| Emergencies    | Reporting lost items, asking for help              |\n\n## Supportive Native Speaker\n\nThe character in the story is a friendly native speaker who:\n\n- Speaks naturally but not too fast\n- Helps the learner when they struggle\n- Provides context clues in their responses\n- Never mocks mistakes\n- Gradually introduces more complex language\n\n# Language Handling\n\n## Input Variables\n\n- **TARGET_LANGUAGE**: The language being learned (from `courseTitle`). All dialogue and options are in this language.\n- **NATIVE_LANGUAGE**: The learner's native language (from `language` code). Questions, feedback, and context translations use this language.\n\n## Language Codes\n\n- `en`: US English\n- `pt`: Brazilian Portuguese\n- `es`: Latin American Spanish\n\n## What Appears in Each Language\n\n| Field                        | Language     | Example (Spanish course, English native)                  |\n| ---------------------------- | ------------ | --------------------------------------------------------- |\n| `scenario`                   | NATIVE       | \"You're at a cafe in Madrid and want to order coffee.\"    |\n| `context`                    | TARGET       | \"Buenos dias, que le pongo?\"                              |\n| `contextTranslation`         | NATIVE       | \"Good morning, what can I get you?\"                       |\n| `contextRomanization`        | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].text`             | TARGET       | \"Un cafe con leche, por favor.\"                           |\n| `options[].textRomanization` | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].feedback`         | NATIVE       | \"A coffee with milk, please - Perfect! Polite and clear.\" |\n\n# Options Design\n\n## No Translations in Options\n\nThis is the most critical design decision. Options show ONLY:\n\n- `text`: The phrase in TARGET language\n- `textRomanization`: Romanization for non-Roman scripts (empty string for Roman scripts)\n\n**NO translation is shown**. This forces the learner to:\n\n1. Parse the target language directly\n2. Use patterns they've learned\n3. Make educated guesses based on context\n4. Experience the productive struggle of real communication\n\n## Option Quality\n\nAll 4 options must be:\n\n- **Grammatically correct** in the target language\n- **Contextually plausible** (something a learner might say in this situation)\n- **Distinct in meaning** (not just word variations)\n- **Level-appropriate** (using vocabulary/structures the learner knows)\n\n## Distractor Design\n\n**CRITICAL**: Wrong options must be genuinely inappropriate for the situation - they should lead to miscommunication or confusion if used. Do NOT create distractors that are merely \"less polished\" versions of the correct answer.\n\nWrong options should be **clearly wrong** because they:\n\n1. **Answer a different question**: Respond to something the speaker didn't ask (asking about price when asked about quantity)\n2. **Request the wrong thing**: Order/ask for something different than intended (one-way ticket when you need round-trip)\n3. **Are off-topic**: Say something unrelated to the current conversation point (asking for the check when you just arrived)\n4. **Would cause confusion**: Use words that change the meaning entirely (saying \"no\" when you mean \"yes\")\n\n**DO NOT** create distractors that are:\n\n- Just more/less formal versions of the correct answer\n- Slightly different phrasings that would still work\n- Grammatically awkward but still understandable\n\n# Feedback Design\n\nFeedback appears AFTER the learner selects an option. Every feedback message MUST include:\n\n1. **Translation**: What the option actually means in the native language\n2. **Explanation**: Why this choice is correct or incorrect for the situation\n\n## Feedback Structure\n\nFor **correct** options:\n\n```\n\"[Translation of what they said] - [Why this works in context]\"\n```\n\nExample: \"A coffee with milk, please - Perfect! This is polite and clearly communicates what you want.\"\n\nFor **incorrect** options:\n\n```\n\"[Translation of what they said] - [Why this doesn't work and what would be better]\"\n```\n\nExample: \"Where is the bathroom? - You're trying to order coffee, not find the restroom. Tell the barista what you'd like to drink.\"\n\n# Romanization Requirements\n\nFor languages using non-Roman writing systems (Japanese, Chinese, Korean, Arabic, Russian, Greek, Hebrew, Thai, Hindi, etc.), provide romanization for both context and options.\n\n## Standard Systems\n\n- **Japanese**: Romaji using Hepburn romanization\n- **Chinese**: Pinyin with tone marks\n- **Korean**: Revised Romanization of Korean\n- **Russian**: ISO 9 or BGN/PCGN transliteration\n- **Arabic**: Standard romanization\n- **Greek**: Standard transliteration\n- **Thai**: Royal Thai General System\n- **Hindi**: IAST or Hunterian transliteration\n\n## Roman Scripts\n\nFor languages using Roman letters (Spanish, French, German, Portuguese, Italian, etc.), set both `contextRomanization` and `textRomanization` to empty strings `\"\"`.\n\n# Story Arc\n\nEach story should have 5-10 steps following a natural arc:\n\n## Step Progression\n\n1. **Opening** (1-2 steps): Arrive at the location, initial greeting\n2. **Building** (2-4 steps): Main interaction, making requests, clarifying\n3. **Complication** (0-2 steps): Optional challenge that adds realism\n4. **Resolution** (1-2 steps): Complete the transaction\n5. **Closing** (1 step): Thank and goodbye\n\n## Complication Ideas (Recommended)\n\nAdding a complication makes the story more realistic and teaches learners to handle unexpected situations:\n\n- **Item unavailable**: \"Sorry, we're out of that. Would you like something else?\"\n- **Misunderstanding**: \"Did you say two or twelve?\"\n- **Additional requirement**: \"I'll need to see your ID for that.\"\n- **Clarification needed**: \"Which size did you want?\"\n\n## Pacing Guidelines\n\n- Steps should feel like natural conversation beats\n- Each step presents ONE decision point\n- Context should flow naturally from the previous step\n- The native speaker's response should acknowledge what the learner said\n\n# Output Format\n\nReturn an object with this structure (abbreviated examples shown):\n\n**Non-Roman script example (Japanese):**\n\n```json\n{\n  \"scenario\": \"You're at a train station in Tokyo...\",\n  \"steps\": [\n    {\n      \"context\": \"いらっしゃいませ。どちらまで？\",\n      \"contextTranslation\": \"Welcome. Where to?\",\n      \"contextRomanization\": \"Irasshaimase. Dochira made?\",\n      \"options\": [\n        {\n          \"text\": \"京都までお願いします。\",\n          \"textRomanization\": \"Kyouto made onegaishimasu.\",\n          \"isCorrect\": true,\n          \"feedback\": \"To Kyoto, please - Perfect!\"\n        },\n        {\n          \"text\": \"京都は遠いですか？\",\n          \"textRomanization\": \"Kyouto wa tooi desu ka?\",\n          \"isCorrect\": false,\n          \"feedback\": \"Is Kyoto far? - This asks about distance, not for a ticket.\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n**Roman script example (Spanish) - empty romanization fields:**\n\n```json\n{\n  \"scenario\": \"You're at a restaurant in Barcelona...\",\n  \"steps\": [\n    {\n      \"context\": \"Buenas noches. Estan listos para pedir?\",\n      \"contextTranslation\": \"Good evening. Are you ready to order?\",\n      \"contextRomanization\": \"\",\n      \"options\": [\n        {\n          \"text\": \"Si, me gustaria la paella, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": true,\n          \"feedback\": \"Yes, I would like the paella, please - Perfect!\"\n        },\n        {\n          \"text\": \"La cuenta, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": false,\n          \"feedback\": \"The check, please - You haven't eaten yet!\"\n        }\n      ]\n    }\n  ]\n}\n```\n\nNote: Examples above are abbreviated. Actual output must have 4 options per step and 5-10 steps total.\n\n# Quality Checklist\n\nBefore finalizing, verify:\n\n1. **Grammar accuracy**: All target language text is grammatically correct\n2. **Natural dialogue**: Conversations flow like real interactions\n3. **Appropriate register**: Formality matches the situation (casual cafe vs formal office)\n4. **Cultural accuracy**: Interactions reflect how things work in that culture\n5. **Clear progression**: Steps follow a logical narrative arc\n6. **Distinct options**: Each option represents a meaningfully different choice\n7. **Helpful feedback**: Translations and explanations clarify meaning and context\n8. **Correct romanization**: Follows standard systems for non-Roman scripts, empty for Roman scripts\n9. **Scenario relevance**: The story matches the lesson topic\n10. **Appropriate difficulty**: Language complexity matches learner level\n\n# Common Mistakes to Avoid\n\n1. **Including translations in options**: Options must show TARGET language only\n2. **Trivial distractors**: Options that are obviously wrong or nonsensical\n3. **Inconsistent register**: Mixing formal and informal inappropriately\n4. **Unnatural responses**: Things a native speaker would never actually say\n5. **Missing romanization**: Forgetting to add romanization for non-Roman scripts\n6. **Adding romanization to Roman scripts**: Spanish, French, etc. should have empty strings\n7. **Feedback without translation**: Always include what the option means\n8. **Disconnected steps**: Each step should follow logically from the previous one\n",
      "testCaseId": "es-korean-asking-directions-1",
      "userPrompt": "TARGET_LANGUAGE: Korean\nNATIVE_LANGUAGE: es\nCHAPTER_TITLE: Transporte y Direcciones\nLESSON_TITLE: Pidiendo Direcciones\nLESSON_DESCRIPTION: Como pedir direcciones y entender indicaciones basicas en coreano\n\nGenerate an immersive dialogue-driven story activity for this language lesson. Create a realistic everyday scenario where learners practice language production in situations they'd face in a foreign country."
    },
    {
      "duration": 51467.369917,
      "inputTokens": 3727,
      "output": "{\n  \"scenario\": \"You're at a pharmacy in Buenos Aires feeling unwell. You need to explain your symptoms to the pharmacist and get medicine to feel better.\",\n  \"steps\": [\n    {\n      \"context\": \"Buenas tardes. ¿En qué puedo ayudarle?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Good afternoon. How can I help you?\",\n      \"options\": [\n        {\n          \"feedback\": \"I don't feel well. My throat hurts. - Perfect! You've clearly explained that you're not feeling well and identified your symptom.\",\n          \"isCorrect\": true,\n          \"text\": \"No me siento bien. Me duele la garganta.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Where is the bathroom? - This doesn't explain why you're at the pharmacy. Tell the pharmacist about your symptoms first.\",\n          \"isCorrect\": false,\n          \"text\": \"¿Dónde está el baño?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"How much does this shampoo cost? - You're asking about shampoo when you came here because you're sick. Explain your health problem instead.\",\n          \"isCorrect\": false,\n          \"text\": \"¿Cuánto cuesta este champú?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I work in a hospital. - This is random information that doesn't explain why you need help. Describe your symptoms to get assistance.\",\n          \"isCorrect\": false,\n          \"text\": \"Trabajo en un hospital.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Entiendo. ¿Desde cuándo le duele?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"I understand. How long has it been hurting?\",\n      \"options\": [\n        {\n          \"feedback\": \"Since yesterday morning. - Excellent! You've given specific timing that helps the pharmacist understand your condition.\",\n          \"isCorrect\": true,\n          \"text\": \"Desde ayer por la mañana.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I need vitamins. - The pharmacist asked when your pain started, not what you think you need. Answer the question about timing.\",\n          \"isCorrect\": false,\n          \"text\": \"Necesito vitaminas.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I like coffee. - This is completely off-topic. The pharmacist needs to know how long you've been experiencing symptoms.\",\n          \"isCorrect\": false,\n          \"text\": \"Me gusta el café.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"The hospital is nearby. - This doesn't answer when your throat started hurting. Provide the time information the pharmacist needs.\",\n          \"isCorrect\": false,\n          \"text\": \"El hospital está cerca.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Ya veo. ¿Tiene otros síntomas? ¿Fiebre, tos?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"I see. Do you have other symptoms? Fever, cough?\",\n      \"options\": [\n        {\n          \"feedback\": \"Yes, I also have a cough and a bit of fever. - Great! You've provided important additional symptoms that will help the pharmacist recommend the right medicine.\",\n          \"isCorrect\": true,\n          \"text\": \"Sí, también tengo tos y un poco de fiebre.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"No, I prefer green tea. - This doesn't make sense as a response about symptoms. Tell the pharmacist about your cough and fever.\",\n          \"isCorrect\": false,\n          \"text\": \"No, prefiero té verde.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Do you accept credit cards? - You're asking about payment when the pharmacist is trying to understand your symptoms. Answer the medical question first.\",\n          \"isCorrect\": false,\n          \"text\": \"¿Acepta tarjetas de crédito?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"My sister is a doctor. - This is irrelevant information. The pharmacist asked about your symptoms, not your family members' professions.\",\n          \"isCorrect\": false,\n          \"text\": \"Mi hermana es médica.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Parece un resfriado. Le recomiendo este jarabe para la tos y estas pastillas para la fiebre. ¿Es alérgico a algún medicamento?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"It sounds like a cold. I recommend this cough syrup and these pills for the fever. Are you allergic to any medication?\",\n      \"options\": [\n        {\n          \"feedback\": \"No, I'm not allergic to anything. - Perfect! This is important safety information the pharmacist needs before selling you medicine.\",\n          \"isCorrect\": true,\n          \"text\": \"No, no soy alérgico a nada.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Yes, I like pills. - The pharmacist asked about allergies, not your preferences. This could be dangerous if you actually have allergies.\",\n          \"isCorrect\": false,\n          \"text\": \"Sí, me gustan las pastillas.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Where is the exit? - This is an important medical question that needs an answer. Tell the pharmacist about any allergies or confirm you have none.\",\n          \"isCorrect\": false,\n          \"text\": \"¿Dónde está la salida?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"The syrup is expensive. - You're commenting on price when the pharmacist needs critical allergy information for your safety. Answer the medical question.\",\n          \"isCorrect\": false,\n          \"text\": \"El jarabe es caro.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Perfecto. Tome el jarabe tres veces al día, una cucharada cada vez. Las pastillas, una cada ocho horas. ¿Entendido?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Perfect. Take the syrup three times a day, one spoonful each time. The pills, one every eight hours. Understood?\",\n      \"options\": [\n        {\n          \"feedback\": \"Yes, understood. One question: should I take the syrup with food? - Excellent! You confirmed understanding and asked a relevant follow-up question about taking the medicine properly.\",\n          \"isCorrect\": true,\n          \"text\": \"Sí, entendido. Una pregunta: ¿debo tomar el jarabe con comida?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I don't understand. Do you speak English? - While asking for clarification is good, you should try to engage with the Spanish instructions or ask specific questions about what you didn't understand.\",\n          \"isCorrect\": false,\n          \"text\": \"No entiendo. ¿Habla inglés?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Do you also sell children's aspirin? - You're asking about a different product when the pharmacist needs to know if you understood the dosage instructions for your medicine.\",\n          \"isCorrect\": false,\n          \"text\": \"¿Vende también aspirinas para niños?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"My hotel is in the downtown area. - This is completely unrelated to the dosage instructions. Confirm you understood or ask for clarification about the medicine.\",\n          \"isCorrect\": false,\n          \"text\": \"Mi hotel está en el centro.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"No es necesario, pero es mejor tomarlos con agua. ¿Necesita algo más? ¿Pañuelos de papel, pastillas para la garganta?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"It's not necessary, but it's better to take them with water. Do you need anything else? Tissues, throat lozenges?\",\n      \"options\": [\n        {\n          \"feedback\": \"Yes, please. Give me throat lozenges too. - Great! You're taking advantage of the pharmacist's helpful suggestion to get something that will help your sore throat.\",\n          \"isCorrect\": true,\n          \"text\": \"Sí, por favor. Deme también pastillas para la garganta.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"No, I want to buy magazines. - The pharmacist is offering items related to your cold. This request about magazines ignores their helpful medical suggestions.\",\n          \"isCorrect\": false,\n          \"text\": \"No, quiero comprar revistas.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"What is your name? - This is an odd question when the pharmacist is trying to help you complete your purchase. Respond about the medical items offered.\",\n          \"isCorrect\": false,\n          \"text\": \"¿Cuál es su nombre?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I have a meeting tomorrow. - This personal information doesn't answer whether you need the additional items the pharmacist suggested for your cold.\",\n          \"isCorrect\": false,\n          \"text\": \"Tengo una reunión mañana.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Muy bien. Son 450 pesos en total. ¿Cómo va a pagar?\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Very good. That's 450 pesos total. How will you pay?\",\n      \"options\": [\n        {\n          \"feedback\": \"With credit card, please. - Perfect! You've clearly stated your payment method so the transaction can proceed.\",\n          \"isCorrect\": true,\n          \"text\": \"Con tarjeta de crédito, por favor.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"How old are you? - This is an inappropriate personal question when the pharmacist is asking about your payment method. Tell them how you'll pay.\",\n          \"isCorrect\": false,\n          \"text\": \"¿Cuántos años tiene usted?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"The hospital is far away. - This doesn't answer how you want to pay. Specify your payment method to complete the purchase.\",\n          \"isCorrect\": false,\n          \"text\": \"El hospital está lejos.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I need a doctor now. - You've already discussed your symptoms and gotten medicine recommendations. If you really needed urgent care, you should have said this at the beginning, not during payment.\",\n          \"isCorrect\": false,\n          \"text\": \"Necesito un médico ahora.\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    },\n    {\n      \"context\": \"Perfecto. Aquí tiene. Que se mejore pronto y descanse mucho.\",\n      \"contextRomanization\": \"\",\n      \"contextTranslation\": \"Perfect. Here you go. Get well soon and rest a lot.\",\n      \"options\": [\n        {\n          \"feedback\": \"Thank you very much for your help. See you later. - Excellent! You've politely thanked the pharmacist and said goodbye appropriately.\",\n          \"isCorrect\": true,\n          \"text\": \"Muchas gracias por su ayuda. Hasta luego.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Where can I buy shoes? - The pharmacist just wished you well. This random question about shoes is inappropriate. Thank them and say goodbye.\",\n          \"isCorrect\": false,\n          \"text\": \"¿Dónde puedo comprar zapatos?\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"I don't want the pills. - You've already paid for everything! If you didn't want the pills, you should have said so before paying. This would create confusion.\",\n          \"isCorrect\": false,\n          \"text\": \"No quiero las pastillas.\",\n          \"textRomanization\": \"\"\n        },\n        {\n          \"feedback\": \"Are you open on Sundays? - While this could be useful information for the future, the transaction is complete. A simple thank you and goodbye is more appropriate now.\",\n          \"isCorrect\": false,\n          \"text\": \"¿Está abierto los domingos?\",\n          \"textRomanization\": \"\"\n        }\n      ]\n    }\n  ]\n}",
      "outputTokens": 3274,
      "systemPrompt": "# Role\n\nYou are an expert language immersion designer specializing in creating realistic, dialogue-driven scenarios that help learners practice language production in authentic contexts. You design experiences that simulate situations learners would encounter when living or traveling in a country where the target language is spoken.\n\n# Goal\n\nCreate an immersive story activity where learners are placed in an everyday situation and must choose appropriate phrases to communicate. The activity simulates real conversations with native speakers, forcing learners to engage with the target language directly rather than relying on translations.\n\nThe activity places learners in a specific scenario (ordering food, asking for directions, checking into a hotel) and guides them through a dialogue where they must select appropriate responses at each step.\n\n# Key Design Principles\n\n## Immersion Over Translation\n\nUnlike other activities where translations help comprehension, this activity intentionally withholds translations from the options. Learners see:\n\n- **Context**: What the native speaker says (in TARGET language with translation)\n- **Options**: Four possible responses (in TARGET language ONLY - no translations)\n\nThis forces learners to:\n\n1. Engage with the target language sounds and patterns\n2. Use context clues to infer meaning\n3. Build recognition before relying on translations\n4. Experience the \"productive uncertainty\" of real conversations\n\nThe translation appears only in the feedback AFTER selection, revealing whether they understood correctly.\n\n## Authentic Scenarios\n\nFocus on situations learners will actually encounter:\n\n| Category       | Example Scenarios                                  |\n| -------------- | -------------------------------------------------- |\n| Food & Dining  | Ordering at a restaurant, asking about ingredients |\n| Transportation | Buying train tickets, asking for directions        |\n| Shopping       | Bargaining at a market, returning an item          |\n| Accommodation  | Checking into a hotel, reporting a problem         |\n| Healthcare     | Describing symptoms at a pharmacy, doctor's visit  |\n| Social         | Meeting neighbors, small talk at a cafe            |\n| Services       | Opening a bank account, getting a phone plan       |\n| Emergencies    | Reporting lost items, asking for help              |\n\n## Supportive Native Speaker\n\nThe character in the story is a friendly native speaker who:\n\n- Speaks naturally but not too fast\n- Helps the learner when they struggle\n- Provides context clues in their responses\n- Never mocks mistakes\n- Gradually introduces more complex language\n\n# Language Handling\n\n## Input Variables\n\n- **TARGET_LANGUAGE**: The language being learned (from `courseTitle`). All dialogue and options are in this language.\n- **NATIVE_LANGUAGE**: The learner's native language (from `language` code). Questions, feedback, and context translations use this language.\n\n## Language Codes\n\n- `en`: US English\n- `pt`: Brazilian Portuguese\n- `es`: Latin American Spanish\n\n## What Appears in Each Language\n\n| Field                        | Language     | Example (Spanish course, English native)                  |\n| ---------------------------- | ------------ | --------------------------------------------------------- |\n| `scenario`                   | NATIVE       | \"You're at a cafe in Madrid and want to order coffee.\"    |\n| `context`                    | TARGET       | \"Buenos dias, que le pongo?\"                              |\n| `contextTranslation`         | NATIVE       | \"Good morning, what can I get you?\"                       |\n| `contextRomanization`        | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].text`             | TARGET       | \"Un cafe con leche, por favor.\"                           |\n| `options[].textRomanization` | Romanization | \"\" (empty for Roman scripts)                              |\n| `options[].feedback`         | NATIVE       | \"A coffee with milk, please - Perfect! Polite and clear.\" |\n\n# Options Design\n\n## No Translations in Options\n\nThis is the most critical design decision. Options show ONLY:\n\n- `text`: The phrase in TARGET language\n- `textRomanization`: Romanization for non-Roman scripts (empty string for Roman scripts)\n\n**NO translation is shown**. This forces the learner to:\n\n1. Parse the target language directly\n2. Use patterns they've learned\n3. Make educated guesses based on context\n4. Experience the productive struggle of real communication\n\n## Option Quality\n\nAll 4 options must be:\n\n- **Grammatically correct** in the target language\n- **Contextually plausible** (something a learner might say in this situation)\n- **Distinct in meaning** (not just word variations)\n- **Level-appropriate** (using vocabulary/structures the learner knows)\n\n## Distractor Design\n\n**CRITICAL**: Wrong options must be genuinely inappropriate for the situation - they should lead to miscommunication or confusion if used. Do NOT create distractors that are merely \"less polished\" versions of the correct answer.\n\nWrong options should be **clearly wrong** because they:\n\n1. **Answer a different question**: Respond to something the speaker didn't ask (asking about price when asked about quantity)\n2. **Request the wrong thing**: Order/ask for something different than intended (one-way ticket when you need round-trip)\n3. **Are off-topic**: Say something unrelated to the current conversation point (asking for the check when you just arrived)\n4. **Would cause confusion**: Use words that change the meaning entirely (saying \"no\" when you mean \"yes\")\n\n**DO NOT** create distractors that are:\n\n- Just more/less formal versions of the correct answer\n- Slightly different phrasings that would still work\n- Grammatically awkward but still understandable\n\n# Feedback Design\n\nFeedback appears AFTER the learner selects an option. Every feedback message MUST include:\n\n1. **Translation**: What the option actually means in the native language\n2. **Explanation**: Why this choice is correct or incorrect for the situation\n\n## Feedback Structure\n\nFor **correct** options:\n\n```\n\"[Translation of what they said] - [Why this works in context]\"\n```\n\nExample: \"A coffee with milk, please - Perfect! This is polite and clearly communicates what you want.\"\n\nFor **incorrect** options:\n\n```\n\"[Translation of what they said] - [Why this doesn't work and what would be better]\"\n```\n\nExample: \"Where is the bathroom? - You're trying to order coffee, not find the restroom. Tell the barista what you'd like to drink.\"\n\n# Romanization Requirements\n\nFor languages using non-Roman writing systems (Japanese, Chinese, Korean, Arabic, Russian, Greek, Hebrew, Thai, Hindi, etc.), provide romanization for both context and options.\n\n## Standard Systems\n\n- **Japanese**: Romaji using Hepburn romanization\n- **Chinese**: Pinyin with tone marks\n- **Korean**: Revised Romanization of Korean\n- **Russian**: ISO 9 or BGN/PCGN transliteration\n- **Arabic**: Standard romanization\n- **Greek**: Standard transliteration\n- **Thai**: Royal Thai General System\n- **Hindi**: IAST or Hunterian transliteration\n\n## Roman Scripts\n\nFor languages using Roman letters (Spanish, French, German, Portuguese, Italian, etc.), set both `contextRomanization` and `textRomanization` to empty strings `\"\"`.\n\n# Story Arc\n\nEach story should have 5-10 steps following a natural arc:\n\n## Step Progression\n\n1. **Opening** (1-2 steps): Arrive at the location, initial greeting\n2. **Building** (2-4 steps): Main interaction, making requests, clarifying\n3. **Complication** (0-2 steps): Optional challenge that adds realism\n4. **Resolution** (1-2 steps): Complete the transaction\n5. **Closing** (1 step): Thank and goodbye\n\n## Complication Ideas (Recommended)\n\nAdding a complication makes the story more realistic and teaches learners to handle unexpected situations:\n\n- **Item unavailable**: \"Sorry, we're out of that. Would you like something else?\"\n- **Misunderstanding**: \"Did you say two or twelve?\"\n- **Additional requirement**: \"I'll need to see your ID for that.\"\n- **Clarification needed**: \"Which size did you want?\"\n\n## Pacing Guidelines\n\n- Steps should feel like natural conversation beats\n- Each step presents ONE decision point\n- Context should flow naturally from the previous step\n- The native speaker's response should acknowledge what the learner said\n\n# Output Format\n\nReturn an object with this structure (abbreviated examples shown):\n\n**Non-Roman script example (Japanese):**\n\n```json\n{\n  \"scenario\": \"You're at a train station in Tokyo...\",\n  \"steps\": [\n    {\n      \"context\": \"いらっしゃいませ。どちらまで？\",\n      \"contextTranslation\": \"Welcome. Where to?\",\n      \"contextRomanization\": \"Irasshaimase. Dochira made?\",\n      \"options\": [\n        {\n          \"text\": \"京都までお願いします。\",\n          \"textRomanization\": \"Kyouto made onegaishimasu.\",\n          \"isCorrect\": true,\n          \"feedback\": \"To Kyoto, please - Perfect!\"\n        },\n        {\n          \"text\": \"京都は遠いですか？\",\n          \"textRomanization\": \"Kyouto wa tooi desu ka?\",\n          \"isCorrect\": false,\n          \"feedback\": \"Is Kyoto far? - This asks about distance, not for a ticket.\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n**Roman script example (Spanish) - empty romanization fields:**\n\n```json\n{\n  \"scenario\": \"You're at a restaurant in Barcelona...\",\n  \"steps\": [\n    {\n      \"context\": \"Buenas noches. Estan listos para pedir?\",\n      \"contextTranslation\": \"Good evening. Are you ready to order?\",\n      \"contextRomanization\": \"\",\n      \"options\": [\n        {\n          \"text\": \"Si, me gustaria la paella, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": true,\n          \"feedback\": \"Yes, I would like the paella, please - Perfect!\"\n        },\n        {\n          \"text\": \"La cuenta, por favor.\",\n          \"textRomanization\": \"\",\n          \"isCorrect\": false,\n          \"feedback\": \"The check, please - You haven't eaten yet!\"\n        }\n      ]\n    }\n  ]\n}\n```\n\nNote: Examples above are abbreviated. Actual output must have 4 options per step and 5-10 steps total.\n\n# Quality Checklist\n\nBefore finalizing, verify:\n\n1. **Grammar accuracy**: All target language text is grammatically correct\n2. **Natural dialogue**: Conversations flow like real interactions\n3. **Appropriate register**: Formality matches the situation (casual cafe vs formal office)\n4. **Cultural accuracy**: Interactions reflect how things work in that culture\n5. **Clear progression**: Steps follow a logical narrative arc\n6. **Distinct options**: Each option represents a meaningfully different choice\n7. **Helpful feedback**: Translations and explanations clarify meaning and context\n8. **Correct romanization**: Follows standard systems for non-Roman scripts, empty for Roman scripts\n9. **Scenario relevance**: The story matches the lesson topic\n10. **Appropriate difficulty**: Language complexity matches learner level\n\n# Common Mistakes to Avoid\n\n1. **Including translations in options**: Options must show TARGET language only\n2. **Trivial distractors**: Options that are obviously wrong or nonsensical\n3. **Inconsistent register**: Mixing formal and informal inappropriately\n4. **Unnatural responses**: Things a native speaker would never actually say\n5. **Missing romanization**: Forgetting to add romanization for non-Roman scripts\n6. **Adding romanization to Roman scripts**: Spanish, French, etc. should have empty strings\n7. **Feedback without translation**: Always include what the option means\n8. **Disconnected steps**: Each step should follow logically from the previous one\n",
      "testCaseId": "en-spanish-pharmacy-visit-1",
      "userPrompt": "TARGET_LANGUAGE: Spanish\nNATIVE_LANGUAGE: en\nCHAPTER_TITLE: Health and Wellness\nLESSON_TITLE: At the Pharmacy\nLESSON_DESCRIPTION: Learn to describe symptoms and buy medicine at a Spanish pharmacy\n\nGenerate an immersive dialogue-driven story activity for this language lesson. Create a realistic everyday scenario where learners practice language production in situations they'd face in a foreign country."
    }
  ],
  "taskId": "activity-story-language"
}
