{
  "generatedAt": "2026-01-21T19:59:58.896Z",
  "modelId": "openai/gpt-5-mini",
  "outputs": [
    {
      "duration": 38395.448292,
      "inputTokens": 3989,
      "output": "{\n  \"discovery\": {\n    \"options\": [\n      {\n        \"feedback\": \"Correct — は (wa) follows the thing being talked about and marks it as the topic of the sentence.\",\n        \"isCorrect\": true,\n        \"text\": \"は marks the topic of the sentence and comes directly after what the sentence is about\"\n      },\n      {\n        \"feedback\": \"True but superficial — it's correct that は appears after nouns/pronouns, but the key point is its function: it marks what the sentence is about (the topic).\",\n        \"isCorrect\": false,\n        \"text\": \"All the sentences have は right after a noun or pronoun\"\n      },\n      {\n        \"feedback\": \"Not quite — は does not mean 'is'. The verb です or other verbs express 'is'. は signals the topic (what you're talking about), not the meaning 'is'.\",\n        \"isCorrect\": false,\n        \"text\": \"は means 'is' (like the verb 'to be')\"\n      },\n      {\n        \"feedback\": \"Plausible but incorrect — は doesn't mark the grammatical subject specifically; it marks the topic (what the sentence is about), which can be different from the subject in some sentences.\",\n        \"isCorrect\": false,\n        \"text\": \"は marks the subject of the sentence\"\n      }\n    ],\n    \"question\": \"What do you notice about は in these sentences?\"\n  },\n  \"examples\": [\n    {\n      \"highlight\": \"は\",\n      \"romanization\": \"watashi wa gakusei desu.\",\n      \"sentence\": \"私は学生です。\",\n      \"translation\": \"I am a student.\"\n    },\n    {\n      \"highlight\": \"は\",\n      \"romanization\": \"kore wa hon desu.\",\n      \"sentence\": \"これは本です。\",\n      \"translation\": \"This is a book.\"\n    },\n    {\n      \"highlight\": \"は\",\n      \"romanization\": \"Tanaka-san wa sensei desu.\",\n      \"sentence\": \"田中さんは先生です。\",\n      \"translation\": \"Mr. Tanaka is a teacher.\"\n    },\n    {\n      \"highlight\": \"は\",\n      \"romanization\": \"kyou wa atsui desu.\",\n      \"sentence\": \"今日は暑いです。\",\n      \"translation\": \"Today is hot.\"\n    }\n  ],\n  \"exercises\": [\n    {\n      \"answers\": [\n        \"は\"\n      ],\n      \"distractors\": [\n        \"が\",\n        \"を\",\n        \"に\"\n      ],\n      \"feedback\": \"We use は to mark 'cat' as the topic: '猫は好きです。' means 'As for cats, (I) like them.'\",\n      \"template\": \"猫[BLANK]好きです。\"\n    },\n    {\n      \"answers\": [\n        \"は\"\n      ],\n      \"distractors\": [\n        \"が\",\n        \"を\",\n        \"で\"\n      ],\n      \"feedback\": \"To mark 'tomorrow' as the topic (what you're talking about), we use は: '明日は休みです。' (As for tomorrow, it's a holiday.)\",\n      \"template\": \"明日[BLANK]休みです。\"\n    },\n    {\n      \"answers\": [\n        \"は\"\n      ],\n      \"distractors\": [\n        \"が\",\n        \"の\",\n        \"へ\"\n      ],\n      \"feedback\": \"'先生は日本語を教えます。' uses は to set 'teacher' as the topic: 'As for the teacher, (they) teach Japanese.'\",\n      \"template\": \"先生[BLANK]日本語を教えます。\"\n    }\n  ],\n  \"ruleName\": \"Topic marker は (wa)\",\n  \"ruleSummary\": \"The particle は (wa) marks the topic of a sentence — the thing you're talking about. It comes directly after that topic.\"\n}",
      "outputTokens": 2424,
      "systemPrompt": "# Role\n\nYou are an expert language teacher specializing in inductive grammar instruction. You help learners discover grammar patterns through carefully selected examples before confirming the rule.\n\n# Goal\n\nCreate a Pattern Discovery grammar activity that guides learners to identify a grammar rule from examples BEFORE being told what it is. This approach builds deeper understanding than simply presenting rules.\n\nThe activity follows this structure:\n\n1. **EXAMPLES** (static) - Show 3-4 sentences demonstrating the pattern\n2. **DISCOVERY** (multipleChoice) - Ask learners what pattern they notice\n3. **RULE** (static) - Briefly confirm the pattern (1-2 sentences max)\n4. **PRACTICE** (fillBlank) - Apply the rule in 2-3 new sentences\n\n# Language Handling\n\n- **TARGET_LANGUAGE**: The language being learned (from `courseTitle`). Examples and exercises are in this language.\n- **NATIVE_LANGUAGE**: The learner's native language (from `language` code). Translations appear in this language.\n\n## Language Codes\n\n- `en`: US English\n- `pt`: Brazilian Portuguese\n- `es`: Latin American Spanish\n\n# Inductive Learning Principles\n\n## Why Pattern Discovery Works\n\nLearners who discover patterns themselves:\n\n- Remember the rule longer (active vs passive learning)\n- Understand WHY the rule exists, not just WHAT it is\n- Transfer the knowledge to new situations more effectively\n- Build confidence in their analytical abilities\n\n## How to Design Effective Examples\n\nYour examples must make the pattern obvious through contrast and consistency:\n\n- **Show the pattern clearly**: The grammar element should be visible in every example\n- **Highlight consistently**: Mark the same grammatical element in each sentence\n- **Use simple vocabulary**: The words should be familiar so focus stays on grammar\n- **Vary the content**: Different subjects, objects, or contexts - same grammatical structure\n- **Build progressively**: Start with the clearest case, then show variations\n\n## What Makes a Good Discovery Question\n\nThe question should test pattern recognition, not memorization:\n\n- Ask WHAT learners observed, not WHAT they remember\n- All options should be plausible observations about the examples\n- The correct answer identifies the core grammatical principle\n- Wrong answers should represent common misunderstandings or partial observations\n- Feedback should explain WHY each option is right or wrong\n\n# Examples Section\n\nProvide 3-4 sentences that clearly demonstrate the grammar pattern.\n\n## Example Design Rules\n\n- Each sentence must contain the target grammar pattern\n- Use level-appropriate vocabulary the learner likely knows\n- The `highlight` field must isolate the grammar element being taught\n- Sentences should be different enough to show the pattern applies broadly\n- Include translations so learners understand meaning while focusing on structure\n\n## What to Highlight\n\nThe highlight should isolate the grammatical element. Use a phrase (multiple words) when the grammar concept involves relationships between elements:\n\n- For verb conjugations: highlight the verb form (e.g., \"habla\", \"parle\", \"spricht\")\n- For word order: highlight the phrase showing position (e.g., \"geht er\" to show verb-subject inversion)\n- For particles: highlight the particle (e.g., \"wa\", \"ga\", \"ni\" in Japanese)\n- For agreement: highlight the ENTIRE agreeing phrase including BOTH elements - the noun/subject AND the adjective/modifier (e.g., \"la casa blanca\" not just \"blanca\", \"le petit chat\" not just \"petit\")\n- For tenses: highlight the verb with its tense marker\n\n**CRITICAL for agreement patterns**: When teaching gender/number agreement, learners must see WHAT is agreeing WITH WHAT. Always highlight both the trigger (noun) and the target (adjective/article) together as a single phrase. Highlighting only the adjective fails to show the agreement relationship.\n\n# Discovery Question\n\nCreate a multiple-choice question that asks learners to identify the pattern.\n\n## Question Design\n\n- Frame as \"What pattern do you notice?\" or \"What do these examples have in common?\"\n- Do NOT reveal the rule in the question itself\n- Test observation and analysis, not prior knowledge\n\n## Options Design\n\nProvide exactly 4 options with exactly 1 correct answer:\n\n- **Correct option**: Accurately describes the core pattern\n- **Distractor 1**: Describes a true but superficial observation (not the main pattern)\n- **Distractor 2**: Describes a common misconception about this grammar point\n- **Distractor 3**: Describes something that seems plausible but is incorrect\n\n## Feedback Design\n\nEach option needs feedback explaining:\n\n- For correct: Confirm the observation and briefly explain why it matters\n- For incorrect: Acknowledge what they observed but redirect to the key pattern\n\n# Rule Summary\n\nAfter the discovery question, confirm the pattern with a brief explanation.\n\n## Rule Summary Guidelines\n\n- Maximum 2 sentences\n- Confirm what learners already figured out - do not introduce new information\n- Use clear, simple language\n- Include the grammatical term if appropriate (e.g., \"This is called the present progressive\")\n- Do not over-explain - the discovery process already did the teaching\n\n**CRITICAL - No new information**: The rule summary must ONLY reference patterns, endings, or forms that were explicitly demonstrated in the Examples section. If your examples showed verb endings -o, -a, -amos, your summary can ONLY mention those endings. Do NOT add other forms like -as, -an even if they exist in the language - those would be new information not discoverable from the examples. The summary confirms what was shown, it does not complete the paradigm.\n\n# Practice Exercises\n\nProvide 2-3 fill-in-the-blank exercises that test the same pattern.\n\n## Exercise Design Rules\n\n- Each exercise has exactly ONE blank marked with `[BLANK]`\n- The blank tests the grammar point from the lesson\n- Use new sentences (not copies of the examples)\n- Include 1-3 correct answers (for cases with valid variations)\n- Include 2-4 distractors (plausible wrong options)\n- **CRITICAL**: Templates must contain ONLY the target language text and the `[BLANK]` placeholder. Do NOT include romanization, transliteration, or pronunciation guides in templates. Romanization belongs only in the `romanization` field of example sentences, never in exercise templates.\n\n## CRITICAL: The Blank Must Test the Actual Grammar Concept\n\n**The position and scope of [BLANK] must allow learners to make the mistake the grammar rule prevents.**\n\nAsk yourself: \"What error would a learner make without knowing this rule?\" The blank must allow for that error.\n\n**Examples of correct blank design:**\n\n- **Conjugation patterns**: Blank replaces the verb form. Options test different conjugations.\n  - Template: \"Yo [BLANK] espanol.\" Options: \"hablo\", \"habla\", \"hablan\"\n  - This works because learners must choose the correct conjugation.\n\n- **Word order patterns** (e.g., German V2): Blank must encompass BOTH the verb AND adjacent element to test their relative order.\n  - Template: \"Morgen [BLANK] nach Hause.\" Options: \"geht er\", \"er geht\"\n  - This works because learners must choose the correct word ORDER, not just conjugation.\n  - BAD: \"Morgen [BLANK] er nach Hause.\" with options \"geht/gehen\" - this only tests conjugation, not word order!\n\n- **Particle selection** (e.g., Korean subject markers): Blank replaces the particle after a noun.\n  - Template: \"학생[BLANK] 공부해요.\" Options: \"이\", \"가\"\n  - This works because learners must apply the consonant/vowel rule.\n\n- **Agreement patterns**: Blank replaces the element that must agree.\n  - Template: \"La maison est [BLANK].\" Options: \"grande\", \"grand\"\n  - This works because learners must match gender with the noun.\n\n**The key principle**: If your grammar concept is about the RELATIONSHIP or ORDER between elements, the blank must include enough elements to test that relationship.\n\n## Distractor Design\n\nGood distractors test common mistakes:\n\n- Wrong conjugation (e.g., wrong person or tense)\n- Wrong agreement (e.g., wrong gender or number)\n- Wrong word order placement\n- Wrong particle or preposition\n- Base form instead of conjugated form\n\n## Feedback Design\n\nExplain why the correct answer fits the pattern, reinforcing the rule.\n\n# Romanization (for non-Roman scripts)\n\nFor languages that use non-Roman writing systems (Japanese, Chinese, Korean, Arabic, Russian, Greek, Hebrew, Thai, Hindi, etc.), include romanization showing how the text is pronounced in Roman letters.\n\nUse the standard romanization system for each language:\n\n- **Japanese**: Romaji (e.g., 私は学生です → \"watashi wa gakusei desu\")\n- **Chinese**: Pinyin with tone marks (e.g., 我是学生 → \"wǒ shì xuesheng\")\n- **Korean**: Revised Romanization (e.g., 저는 학생입니다 → \"jeoneun haksaeng-imnida\")\n- **Russian**: ISO 9 or BGN/PCGN (e.g., Я студент → \"Ya student\")\n- **Arabic**: Standard romanization (e.g., أنا طالب → \"ana talib\")\n- **Greek**: Standard transliteration (e.g., Είμαι φοιτητής → \"Eimai foititis\")\n- **Thai**: Royal Thai General System (e.g., ฉันเป็นนักเรียน → \"chan pen nakrian\")\n- **Hindi**: IAST or Hunterian (e.g., मैं छात्र हूँ → \"main chhatr hoon\")\n\n**For languages using Roman letters** (Spanish, French, German, Portuguese, Italian, etc.), set `romanization` to an empty string `\"\"`.\n\n# Linguistic Accuracy Requirements\n\n## Factual Correctness in Explanations\n\nWhen explaining grammar rules, especially for non-Latin scripts, verify your linguistic claims are factually accurate:\n\n**For Korean**:\n\n- When explaining particle selection based on final consonants, correctly identify the actual final consonant/vowel\n- Example: 학생 (haksaeng) ends in the consonant ㅇ (ng sound), NOT ㄴ\n- Example: 사과 (sagwa) ends in a vowel ㅏ\n- The batchim (final consonant) is the bottom component of the final syllable block\n\n**For Japanese**:\n\n- Correctly identify readings (on'yomi vs kun'yomi) when relevant\n- The particle は is pronounced \"wa\" when marking topic, not \"ha\"\n\n**For Chinese**:\n\n- Ensure tone marks in pinyin are correct\n- Character stroke counts and radical identification must be accurate\n\n**General principle**: If your feedback references specific letters, sounds, or character components, double-check that the identification is correct. Learners trust your explanations - an error in linguistic analysis undermines the lesson even if the grammar rule itself is correctly taught.\n\n# Output Format\n\nReturn an object with this structure:\n\n```json\n{\n  \"ruleName\": \"Present Tense -ar Verb Conjugation\",\n  \"examples\": [\n    {\n      \"sentence\": \"Yo hablo español.\",\n      \"translation\": \"I speak Spanish.\",\n      \"romanization\": \"\",\n      \"highlight\": \"hablo\"\n    },\n    {\n      \"sentence\": \"Ella habla con su madre.\",\n      \"translation\": \"She speaks with her mother.\",\n      \"romanization\": \"\",\n      \"highlight\": \"habla\"\n    },\n    {\n      \"sentence\": \"Nosotros hablamos mucho.\",\n      \"translation\": \"We speak a lot.\",\n      \"romanization\": \"\",\n      \"highlight\": \"hablamos\"\n    }\n  ],\n  \"discovery\": {\n    \"question\": \"What pattern do you notice in the highlighted words?\",\n    \"options\": [\n      {\n        \"text\": \"The verb ending changes based on who is doing the action\",\n        \"isCorrect\": true,\n        \"feedback\": \"Correct! The verb 'hablar' changes its ending (-o, -a, -amos) to match the subject.\"\n      },\n      {\n        \"text\": \"All the sentences are about speaking\",\n        \"isCorrect\": false,\n        \"feedback\": \"That's true, but look more closely at the highlighted words. Notice how 'habl-' stays the same but the ending changes?\"\n      },\n      {\n        \"text\": \"Spanish verbs always end in -ar\",\n        \"isCorrect\": false,\n        \"feedback\": \"Not all Spanish verbs end in -ar. Focus on what changes in the highlighted words across the examples.\"\n      },\n      {\n        \"text\": \"The verb comes before the subject\",\n        \"isCorrect\": false,\n        \"feedback\": \"Word order varies in these examples. Look at the verb endings - what changes between hablo, habla, and hablamos?\"\n      }\n    ]\n  },\n  \"ruleSummary\": \"Spanish -ar verbs change their ending to match the subject: -o (yo), -a (ella), -amos (nosotros). This is called conjugation.\",\n  \"exercises\": [\n    {\n      \"template\": \"Tú [BLANK] muy bien.\",\n      \"answers\": [\"hablas\"],\n      \"distractors\": [\"habla\", \"hablo\", \"hablar\"],\n      \"feedback\": \"With 'tú' (you), -ar verbs use the ending '-as', giving us 'hablas'.\"\n    },\n    {\n      \"template\": \"Ellos [BLANK] en la oficina.\",\n      \"answers\": [\"trabajan\"],\n      \"distractors\": [\"trabaja\", \"trabajo\", \"trabajar\"],\n      \"feedback\": \"With 'ellos' (they), -ar verbs use the ending '-an', giving us 'trabajan'.\"\n    }\n  ]\n}\n```\n\n**Example for Japanese (non-Roman script) - romanization included:**\n\n```json\n{\n  \"ruleName\": \"Topic Marker は (wa)\",\n  \"examples\": [\n    {\n      \"sentence\": \"私は学生です。\",\n      \"translation\": \"I am a student.\",\n      \"romanization\": \"watashi wa gakusei desu.\",\n      \"highlight\": \"は\"\n    },\n    {\n      \"sentence\": \"これは本です。\",\n      \"translation\": \"This is a book.\",\n      \"romanization\": \"kore wa hon desu.\",\n      \"highlight\": \"は\"\n    },\n    {\n      \"sentence\": \"田中さんは先生です。\",\n      \"translation\": \"Mr. Tanaka is a teacher.\",\n      \"romanization\": \"Tanaka-san wa sensei desu.\",\n      \"highlight\": \"は\"\n    }\n  ],\n  \"discovery\": {\n    \"question\": \"What do you notice about は in these sentences?\",\n    \"options\": [\n      {\n        \"text\": \"は marks the topic - what the sentence is about\",\n        \"isCorrect\": true,\n        \"feedback\": \"Correct! は (wa) marks the topic of the sentence - the thing being described or discussed.\"\n      },\n      {\n        \"text\": \"は means 'is' in Japanese\",\n        \"isCorrect\": false,\n        \"feedback\": \"Actually, 'です' (desu) means 'is'. Look at where は appears - it comes right after the topic being discussed.\"\n      },\n      {\n        \"text\": \"は is always pronounced 'ha'\",\n        \"isCorrect\": false,\n        \"feedback\": \"When used as a particle, は is pronounced 'wa', not 'ha'. Focus on what role it plays in the sentence structure.\"\n      },\n      {\n        \"text\": \"は only appears at the end of sentences\",\n        \"isCorrect\": false,\n        \"feedback\": \"Notice that は appears in the middle of each sentence, right after the subject. It connects the topic to what's being said about it.\"\n      }\n    ]\n  },\n  \"ruleSummary\": \"The particle は (wa) marks the topic of a sentence - the thing you're talking about. It comes directly after the topic.\",\n  \"exercises\": [\n    {\n      \"template\": \"猫[BLANK]かわいいです。\",\n      \"answers\": [\"は\"],\n      \"distractors\": [\"が\", \"を\", \"に\"],\n      \"feedback\": \"We use は to mark 'cat' as the topic we're describing as cute.\"\n    },\n    {\n      \"template\": \"あなた[BLANK]だれですか。\",\n      \"answers\": [\"は\"],\n      \"distractors\": [\"が\", \"を\", \"の\"],\n      \"feedback\": \"は marks 'you' as the topic of the question 'who are you?'\"\n    }\n  ]\n}\n```\n\n# Quality Requirements\n\n1. **Examples must teach without explaining**: The pattern should be discoverable from the examples alone. If you need to explain it in the examples, they're not clear enough.\n\n2. **One grammar point per activity**: Focus on a single, clear grammatical concept. Do not mix multiple rules.\n\n3. **Progressive difficulty**: Examples should be straightforward; exercises can be slightly more challenging.\n\n4. **Consistent highlighting**: Always highlight the same type of element across all examples (the verb ending, the particle, the agreement marker, etc.).\n\n5. **Accurate linguistics**: Every example, translation, and explanation must be grammatically correct in both languages.\n\n6. **Level-appropriate vocabulary**: Use words the learner likely knows so they can focus on grammar, not vocabulary.\n\n7. **Exactly one blank per exercise**: Each fill-in-the-blank has exactly ONE `[BLANK]` placeholder.\n\n8. **Plausible distractors**: Wrong options should test real mistakes learners make, not obviously wrong choices.\n\n9. **Clear feedback**: Every option (correct and incorrect) needs feedback that helps learning.\n\n10. **Brief rule summary**: Maximum 2 sentences. The discovery process is the teaching - the summary just confirms.\n",
      "testCaseId": "en-japanese-topic-marker-wa-1",
      "userPrompt": "TARGET_LANGUAGE: Japanese\nNATIVE_LANGUAGE: en\nCHAPTER_TITLE: Basic Particles\nLESSON_TITLE: Topic Marker は\nLESSON_DESCRIPTION: The topic marker particle は (wa) and how it indicates what the sentence is about\n\nGenerate a Pattern Discovery grammar activity for this lesson. Include 3-4 examples demonstrating the grammar pattern, a discovery question, a brief rule summary, and 2-3 fill-in-the-blank practice exercises."
    },
    {
      "duration": 40685.702917,
      "inputTokens": 3994,
      "output": "{\n  \"discovery\": {\n    \"options\": [\n      {\n        \"feedback\": \"Correct — the verb stem stays the same (habl-, trabaj-, estudi-, camin-) while the ending changes to match the subject: -o (yo), -as (tú), -a (ella), -amos (nosotros). This change is how Spanish verbs are conjugated in the present.\",\n        \"isCorrect\": true,\n        \"text\": \"The verb ending changes depending on who is doing the action (the subject).\"\n      },\n      {\n        \"feedback\": \"True — each example uses a verb that comes from an infinitive ending in -ar, but that observation doesn't explain the different endings you see in the highlighted words.\",\n        \"isCorrect\": false,\n        \"text\": \"All the verbs are -ar verbs.\"\n      },\n      {\n        \"feedback\": \"Not quite — the sentences are all in the present, but the highlighted endings are showing who performs the action (the subject), not a different tense.\",\n        \"isCorrect\": false,\n        \"text\": \"The highlighted endings only show the tense (present vs past).\"\n      },\n      {\n        \"feedback\": \"They aren't separate words — the highlighted endings are attached to the verb stem as one word. The important pattern is that the ending itself changes to match the subject.\",\n        \"isCorrect\": false,\n        \"text\": \"The highlighted parts are separate words from the verb stem.\"\n      }\n    ],\n    \"question\": \"What pattern do you notice in the highlighted words?\"\n  },\n  \"examples\": [\n    {\n      \"highlight\": \"hablo\",\n      \"romanization\": \"\",\n      \"sentence\": \"Yo hablo español.\",\n      \"translation\": \"I speak Spanish.\"\n    },\n    {\n      \"highlight\": \"trabajas\",\n      \"romanization\": \"\",\n      \"sentence\": \"Tú trabajas mucho.\",\n      \"translation\": \"You work a lot.\"\n    },\n    {\n      \"highlight\": \"estudia\",\n      \"romanization\": \"\",\n      \"sentence\": \"Ella estudia en la universidad.\",\n      \"translation\": \"She studies at the university.\"\n    },\n    {\n      \"highlight\": \"caminamos\",\n      \"romanization\": \"\",\n      \"sentence\": \"Nosotros caminamos al parque.\",\n      \"translation\": \"We walk to the park.\"\n    }\n  ],\n  \"exercises\": [\n    {\n      \"answers\": [\n        \"escuchas\"\n      ],\n      \"distractors\": [\n        \"escucha\",\n        \"escucho\",\n        \"escuchar\"\n      ],\n      \"feedback\": \"With 'tú' you use the -as ending for regular -ar verbs: escuchar → escuchas.\",\n      \"template\": \"Tú [BLANK] música todos los días.\"\n    },\n    {\n      \"answers\": [\n        \"practicamos\"\n      ],\n      \"distractors\": [\n        \"practica\",\n        \"practico\",\n        \"practicar\"\n      ],\n      \"feedback\": \"With 'nosotros' you use the -amos ending: practicar → practicamos.\",\n      \"template\": \"Nosotros [BLANK] español en clase.\"\n    },\n    {\n      \"answers\": [\n        \"toca\"\n      ],\n      \"distractors\": [\n        \"tocas\",\n        \"toco\",\n        \"tocar\"\n      ],\n      \"feedback\": \"With 'ella' (she) use the -a ending for regular -ar verbs: tocar → toca.\",\n      \"template\": \"Ella [BLANK] la guitarra.\"\n    }\n  ],\n  \"ruleName\": \"Present Tense: Regular -ar Verb Conjugation\",\n  \"ruleSummary\": \"Regular -ar verbs change their endings to match the subject: -o (yo), -as (tú), -a (ella), -amos (nosotros). This change of the verb ending to agree with the subject is called conjugation.\"\n}",
      "outputTokens": 2551,
      "systemPrompt": "# Role\n\nYou are an expert language teacher specializing in inductive grammar instruction. You help learners discover grammar patterns through carefully selected examples before confirming the rule.\n\n# Goal\n\nCreate a Pattern Discovery grammar activity that guides learners to identify a grammar rule from examples BEFORE being told what it is. This approach builds deeper understanding than simply presenting rules.\n\nThe activity follows this structure:\n\n1. **EXAMPLES** (static) - Show 3-4 sentences demonstrating the pattern\n2. **DISCOVERY** (multipleChoice) - Ask learners what pattern they notice\n3. **RULE** (static) - Briefly confirm the pattern (1-2 sentences max)\n4. **PRACTICE** (fillBlank) - Apply the rule in 2-3 new sentences\n\n# Language Handling\n\n- **TARGET_LANGUAGE**: The language being learned (from `courseTitle`). Examples and exercises are in this language.\n- **NATIVE_LANGUAGE**: The learner's native language (from `language` code). Translations appear in this language.\n\n## Language Codes\n\n- `en`: US English\n- `pt`: Brazilian Portuguese\n- `es`: Latin American Spanish\n\n# Inductive Learning Principles\n\n## Why Pattern Discovery Works\n\nLearners who discover patterns themselves:\n\n- Remember the rule longer (active vs passive learning)\n- Understand WHY the rule exists, not just WHAT it is\n- Transfer the knowledge to new situations more effectively\n- Build confidence in their analytical abilities\n\n## How to Design Effective Examples\n\nYour examples must make the pattern obvious through contrast and consistency:\n\n- **Show the pattern clearly**: The grammar element should be visible in every example\n- **Highlight consistently**: Mark the same grammatical element in each sentence\n- **Use simple vocabulary**: The words should be familiar so focus stays on grammar\n- **Vary the content**: Different subjects, objects, or contexts - same grammatical structure\n- **Build progressively**: Start with the clearest case, then show variations\n\n## What Makes a Good Discovery Question\n\nThe question should test pattern recognition, not memorization:\n\n- Ask WHAT learners observed, not WHAT they remember\n- All options should be plausible observations about the examples\n- The correct answer identifies the core grammatical principle\n- Wrong answers should represent common misunderstandings or partial observations\n- Feedback should explain WHY each option is right or wrong\n\n# Examples Section\n\nProvide 3-4 sentences that clearly demonstrate the grammar pattern.\n\n## Example Design Rules\n\n- Each sentence must contain the target grammar pattern\n- Use level-appropriate vocabulary the learner likely knows\n- The `highlight` field must isolate the grammar element being taught\n- Sentences should be different enough to show the pattern applies broadly\n- Include translations so learners understand meaning while focusing on structure\n\n## What to Highlight\n\nThe highlight should isolate the grammatical element. Use a phrase (multiple words) when the grammar concept involves relationships between elements:\n\n- For verb conjugations: highlight the verb form (e.g., \"habla\", \"parle\", \"spricht\")\n- For word order: highlight the phrase showing position (e.g., \"geht er\" to show verb-subject inversion)\n- For particles: highlight the particle (e.g., \"wa\", \"ga\", \"ni\" in Japanese)\n- For agreement: highlight the ENTIRE agreeing phrase including BOTH elements - the noun/subject AND the adjective/modifier (e.g., \"la casa blanca\" not just \"blanca\", \"le petit chat\" not just \"petit\")\n- For tenses: highlight the verb with its tense marker\n\n**CRITICAL for agreement patterns**: When teaching gender/number agreement, learners must see WHAT is agreeing WITH WHAT. Always highlight both the trigger (noun) and the target (adjective/article) together as a single phrase. Highlighting only the adjective fails to show the agreement relationship.\n\n# Discovery Question\n\nCreate a multiple-choice question that asks learners to identify the pattern.\n\n## Question Design\n\n- Frame as \"What pattern do you notice?\" or \"What do these examples have in common?\"\n- Do NOT reveal the rule in the question itself\n- Test observation and analysis, not prior knowledge\n\n## Options Design\n\nProvide exactly 4 options with exactly 1 correct answer:\n\n- **Correct option**: Accurately describes the core pattern\n- **Distractor 1**: Describes a true but superficial observation (not the main pattern)\n- **Distractor 2**: Describes a common misconception about this grammar point\n- **Distractor 3**: Describes something that seems plausible but is incorrect\n\n## Feedback Design\n\nEach option needs feedback explaining:\n\n- For correct: Confirm the observation and briefly explain why it matters\n- For incorrect: Acknowledge what they observed but redirect to the key pattern\n\n# Rule Summary\n\nAfter the discovery question, confirm the pattern with a brief explanation.\n\n## Rule Summary Guidelines\n\n- Maximum 2 sentences\n- Confirm what learners already figured out - do not introduce new information\n- Use clear, simple language\n- Include the grammatical term if appropriate (e.g., \"This is called the present progressive\")\n- Do not over-explain - the discovery process already did the teaching\n\n**CRITICAL - No new information**: The rule summary must ONLY reference patterns, endings, or forms that were explicitly demonstrated in the Examples section. If your examples showed verb endings -o, -a, -amos, your summary can ONLY mention those endings. Do NOT add other forms like -as, -an even if they exist in the language - those would be new information not discoverable from the examples. The summary confirms what was shown, it does not complete the paradigm.\n\n# Practice Exercises\n\nProvide 2-3 fill-in-the-blank exercises that test the same pattern.\n\n## Exercise Design Rules\n\n- Each exercise has exactly ONE blank marked with `[BLANK]`\n- The blank tests the grammar point from the lesson\n- Use new sentences (not copies of the examples)\n- Include 1-3 correct answers (for cases with valid variations)\n- Include 2-4 distractors (plausible wrong options)\n- **CRITICAL**: Templates must contain ONLY the target language text and the `[BLANK]` placeholder. Do NOT include romanization, transliteration, or pronunciation guides in templates. Romanization belongs only in the `romanization` field of example sentences, never in exercise templates.\n\n## CRITICAL: The Blank Must Test the Actual Grammar Concept\n\n**The position and scope of [BLANK] must allow learners to make the mistake the grammar rule prevents.**\n\nAsk yourself: \"What error would a learner make without knowing this rule?\" The blank must allow for that error.\n\n**Examples of correct blank design:**\n\n- **Conjugation patterns**: Blank replaces the verb form. Options test different conjugations.\n  - Template: \"Yo [BLANK] espanol.\" Options: \"hablo\", \"habla\", \"hablan\"\n  - This works because learners must choose the correct conjugation.\n\n- **Word order patterns** (e.g., German V2): Blank must encompass BOTH the verb AND adjacent element to test their relative order.\n  - Template: \"Morgen [BLANK] nach Hause.\" Options: \"geht er\", \"er geht\"\n  - This works because learners must choose the correct word ORDER, not just conjugation.\n  - BAD: \"Morgen [BLANK] er nach Hause.\" with options \"geht/gehen\" - this only tests conjugation, not word order!\n\n- **Particle selection** (e.g., Korean subject markers): Blank replaces the particle after a noun.\n  - Template: \"학생[BLANK] 공부해요.\" Options: \"이\", \"가\"\n  - This works because learners must apply the consonant/vowel rule.\n\n- **Agreement patterns**: Blank replaces the element that must agree.\n  - Template: \"La maison est [BLANK].\" Options: \"grande\", \"grand\"\n  - This works because learners must match gender with the noun.\n\n**The key principle**: If your grammar concept is about the RELATIONSHIP or ORDER between elements, the blank must include enough elements to test that relationship.\n\n## Distractor Design\n\nGood distractors test common mistakes:\n\n- Wrong conjugation (e.g., wrong person or tense)\n- Wrong agreement (e.g., wrong gender or number)\n- Wrong word order placement\n- Wrong particle or preposition\n- Base form instead of conjugated form\n\n## Feedback Design\n\nExplain why the correct answer fits the pattern, reinforcing the rule.\n\n# Romanization (for non-Roman scripts)\n\nFor languages that use non-Roman writing systems (Japanese, Chinese, Korean, Arabic, Russian, Greek, Hebrew, Thai, Hindi, etc.), include romanization showing how the text is pronounced in Roman letters.\n\nUse the standard romanization system for each language:\n\n- **Japanese**: Romaji (e.g., 私は学生です → \"watashi wa gakusei desu\")\n- **Chinese**: Pinyin with tone marks (e.g., 我是学生 → \"wǒ shì xuesheng\")\n- **Korean**: Revised Romanization (e.g., 저는 학생입니다 → \"jeoneun haksaeng-imnida\")\n- **Russian**: ISO 9 or BGN/PCGN (e.g., Я студент → \"Ya student\")\n- **Arabic**: Standard romanization (e.g., أنا طالب → \"ana talib\")\n- **Greek**: Standard transliteration (e.g., Είμαι φοιτητής → \"Eimai foititis\")\n- **Thai**: Royal Thai General System (e.g., ฉันเป็นนักเรียน → \"chan pen nakrian\")\n- **Hindi**: IAST or Hunterian (e.g., मैं छात्र हूँ → \"main chhatr hoon\")\n\n**For languages using Roman letters** (Spanish, French, German, Portuguese, Italian, etc.), set `romanization` to an empty string `\"\"`.\n\n# Linguistic Accuracy Requirements\n\n## Factual Correctness in Explanations\n\nWhen explaining grammar rules, especially for non-Latin scripts, verify your linguistic claims are factually accurate:\n\n**For Korean**:\n\n- When explaining particle selection based on final consonants, correctly identify the actual final consonant/vowel\n- Example: 학생 (haksaeng) ends in the consonant ㅇ (ng sound), NOT ㄴ\n- Example: 사과 (sagwa) ends in a vowel ㅏ\n- The batchim (final consonant) is the bottom component of the final syllable block\n\n**For Japanese**:\n\n- Correctly identify readings (on'yomi vs kun'yomi) when relevant\n- The particle は is pronounced \"wa\" when marking topic, not \"ha\"\n\n**For Chinese**:\n\n- Ensure tone marks in pinyin are correct\n- Character stroke counts and radical identification must be accurate\n\n**General principle**: If your feedback references specific letters, sounds, or character components, double-check that the identification is correct. Learners trust your explanations - an error in linguistic analysis undermines the lesson even if the grammar rule itself is correctly taught.\n\n# Output Format\n\nReturn an object with this structure:\n\n```json\n{\n  \"ruleName\": \"Present Tense -ar Verb Conjugation\",\n  \"examples\": [\n    {\n      \"sentence\": \"Yo hablo español.\",\n      \"translation\": \"I speak Spanish.\",\n      \"romanization\": \"\",\n      \"highlight\": \"hablo\"\n    },\n    {\n      \"sentence\": \"Ella habla con su madre.\",\n      \"translation\": \"She speaks with her mother.\",\n      \"romanization\": \"\",\n      \"highlight\": \"habla\"\n    },\n    {\n      \"sentence\": \"Nosotros hablamos mucho.\",\n      \"translation\": \"We speak a lot.\",\n      \"romanization\": \"\",\n      \"highlight\": \"hablamos\"\n    }\n  ],\n  \"discovery\": {\n    \"question\": \"What pattern do you notice in the highlighted words?\",\n    \"options\": [\n      {\n        \"text\": \"The verb ending changes based on who is doing the action\",\n        \"isCorrect\": true,\n        \"feedback\": \"Correct! The verb 'hablar' changes its ending (-o, -a, -amos) to match the subject.\"\n      },\n      {\n        \"text\": \"All the sentences are about speaking\",\n        \"isCorrect\": false,\n        \"feedback\": \"That's true, but look more closely at the highlighted words. Notice how 'habl-' stays the same but the ending changes?\"\n      },\n      {\n        \"text\": \"Spanish verbs always end in -ar\",\n        \"isCorrect\": false,\n        \"feedback\": \"Not all Spanish verbs end in -ar. Focus on what changes in the highlighted words across the examples.\"\n      },\n      {\n        \"text\": \"The verb comes before the subject\",\n        \"isCorrect\": false,\n        \"feedback\": \"Word order varies in these examples. Look at the verb endings - what changes between hablo, habla, and hablamos?\"\n      }\n    ]\n  },\n  \"ruleSummary\": \"Spanish -ar verbs change their ending to match the subject: -o (yo), -a (ella), -amos (nosotros). This is called conjugation.\",\n  \"exercises\": [\n    {\n      \"template\": \"Tú [BLANK] muy bien.\",\n      \"answers\": [\"hablas\"],\n      \"distractors\": [\"habla\", \"hablo\", \"hablar\"],\n      \"feedback\": \"With 'tú' (you), -ar verbs use the ending '-as', giving us 'hablas'.\"\n    },\n    {\n      \"template\": \"Ellos [BLANK] en la oficina.\",\n      \"answers\": [\"trabajan\"],\n      \"distractors\": [\"trabaja\", \"trabajo\", \"trabajar\"],\n      \"feedback\": \"With 'ellos' (they), -ar verbs use the ending '-an', giving us 'trabajan'.\"\n    }\n  ]\n}\n```\n\n**Example for Japanese (non-Roman script) - romanization included:**\n\n```json\n{\n  \"ruleName\": \"Topic Marker は (wa)\",\n  \"examples\": [\n    {\n      \"sentence\": \"私は学生です。\",\n      \"translation\": \"I am a student.\",\n      \"romanization\": \"watashi wa gakusei desu.\",\n      \"highlight\": \"は\"\n    },\n    {\n      \"sentence\": \"これは本です。\",\n      \"translation\": \"This is a book.\",\n      \"romanization\": \"kore wa hon desu.\",\n      \"highlight\": \"は\"\n    },\n    {\n      \"sentence\": \"田中さんは先生です。\",\n      \"translation\": \"Mr. Tanaka is a teacher.\",\n      \"romanization\": \"Tanaka-san wa sensei desu.\",\n      \"highlight\": \"は\"\n    }\n  ],\n  \"discovery\": {\n    \"question\": \"What do you notice about は in these sentences?\",\n    \"options\": [\n      {\n        \"text\": \"は marks the topic - what the sentence is about\",\n        \"isCorrect\": true,\n        \"feedback\": \"Correct! は (wa) marks the topic of the sentence - the thing being described or discussed.\"\n      },\n      {\n        \"text\": \"は means 'is' in Japanese\",\n        \"isCorrect\": false,\n        \"feedback\": \"Actually, 'です' (desu) means 'is'. Look at where は appears - it comes right after the topic being discussed.\"\n      },\n      {\n        \"text\": \"は is always pronounced 'ha'\",\n        \"isCorrect\": false,\n        \"feedback\": \"When used as a particle, は is pronounced 'wa', not 'ha'. Focus on what role it plays in the sentence structure.\"\n      },\n      {\n        \"text\": \"は only appears at the end of sentences\",\n        \"isCorrect\": false,\n        \"feedback\": \"Notice that は appears in the middle of each sentence, right after the subject. It connects the topic to what's being said about it.\"\n      }\n    ]\n  },\n  \"ruleSummary\": \"The particle は (wa) marks the topic of a sentence - the thing you're talking about. It comes directly after the topic.\",\n  \"exercises\": [\n    {\n      \"template\": \"猫[BLANK]かわいいです。\",\n      \"answers\": [\"は\"],\n      \"distractors\": [\"が\", \"を\", \"に\"],\n      \"feedback\": \"We use は to mark 'cat' as the topic we're describing as cute.\"\n    },\n    {\n      \"template\": \"あなた[BLANK]だれですか。\",\n      \"answers\": [\"は\"],\n      \"distractors\": [\"が\", \"を\", \"の\"],\n      \"feedback\": \"は marks 'you' as the topic of the question 'who are you?'\"\n    }\n  ]\n}\n```\n\n# Quality Requirements\n\n1. **Examples must teach without explaining**: The pattern should be discoverable from the examples alone. If you need to explain it in the examples, they're not clear enough.\n\n2. **One grammar point per activity**: Focus on a single, clear grammatical concept. Do not mix multiple rules.\n\n3. **Progressive difficulty**: Examples should be straightforward; exercises can be slightly more challenging.\n\n4. **Consistent highlighting**: Always highlight the same type of element across all examples (the verb ending, the particle, the agreement marker, etc.).\n\n5. **Accurate linguistics**: Every example, translation, and explanation must be grammatically correct in both languages.\n\n6. **Level-appropriate vocabulary**: Use words the learner likely knows so they can focus on grammar, not vocabulary.\n\n7. **Exactly one blank per exercise**: Each fill-in-the-blank has exactly ONE `[BLANK]` placeholder.\n\n8. **Plausible distractors**: Wrong options should test real mistakes learners make, not obviously wrong choices.\n\n9. **Clear feedback**: Every option (correct and incorrect) needs feedback that helps learning.\n\n10. **Brief rule summary**: Maximum 2 sentences. The discovery process is the teaching - the summary just confirms.\n",
      "testCaseId": "en-spanish-ar-verb-conjugation-1",
      "userPrompt": "TARGET_LANGUAGE: Spanish\nNATIVE_LANGUAGE: en\nCHAPTER_TITLE: Present Tense Verbs\nLESSON_TITLE: Regular -ar Verbs\nLESSON_DESCRIPTION: How to conjugate regular -ar verbs in the present tense, matching verb endings to subjects\n\nGenerate a Pattern Discovery grammar activity for this lesson. Include 3-4 examples demonstrating the grammar pattern, a discovery question, a brief rule summary, and 2-3 fill-in-the-blank practice exercises."
    },
    {
      "duration": 59811.005334,
      "inputTokens": 3987,
      "output": "{\n  \"discovery\": {\n    \"options\": [\n      {\n        \"feedback\": \"Correct — in each main clause the finite verb appears as the second constituent: something (subject, time phrase, object, place phrase) comes first, and the finite verb follows it.\",\n        \"isCorrect\": true,\n        \"text\": \"The finite verb always appears as the second element in the sentence, no matter what comes first.\"\n      },\n      {\n        \"feedback\": \"True but incomplete — these examples are in the present tense, but the key pattern is not the tense: look at where the finite verb sits in relation to the first element.\",\n        \"isCorrect\": false,\n        \"text\": \"All sentences are in the present tense.\"\n      },\n      {\n        \"feedback\": \"Not quite — sometimes the verb does come before the subject (when something else is first), but the deeper pattern is that the finite verb is second, not that it always precedes the subject.\",\n        \"isCorrect\": false,\n        \"text\": \"The verb always comes before the subject in German main clauses.\"\n      },\n      {\n        \"feedback\": \"Plausible but incorrect — the highlighted parts happen to start the sentences here (first element + verb), but the rule is about the verb being the second element overall, not about always beginning the sentence.\",\n        \"isCorrect\": false,\n        \"text\": \"The highlighted words are always at the beginning of the sentence.\"\n      }\n    ],\n    \"question\": \"What pattern do you notice in the highlighted parts?\"\n  },\n  \"examples\": [\n    {\n      \"highlight\": \"Ich trinke\",\n      \"romanization\": \"\",\n      \"sentence\": \"Ich trinke jeden Morgen Kaffee.\",\n      \"translation\": \"I drink coffee every morning.\"\n    },\n    {\n      \"highlight\": \"Jeden Morgen trinke\",\n      \"romanization\": \"\",\n      \"sentence\": \"Jeden Morgen trinke ich Kaffee.\",\n      \"translation\": \"Every morning I drink coffee.\"\n    },\n    {\n      \"highlight\": \"Den Kuchen isst\",\n      \"romanization\": \"\",\n      \"sentence\": \"Den Kuchen isst Maria heute.\",\n      \"translation\": \"Maria is eating the cake today.\"\n    },\n    {\n      \"highlight\": \"Im Park spielt\",\n      \"romanization\": \"\",\n      \"sentence\": \"Im Park spielt der Junge Fußball.\",\n      \"translation\": \"In the park the boy plays soccer.\"\n    }\n  ],\n  \"exercises\": [\n    {\n      \"answers\": [\n        \"gehe ich\"\n      ],\n      \"distractors\": [\n        \"ich gehe\",\n        \"gehe\",\n        \"geht er\"\n      ],\n      \"feedback\": \"With the fronted time word 'Heute', the finite verb must be the second element: 'Heute gehe ich ins Kino.' ('gehe ich' keeps the verb in second position).\",\n      \"template\": \"Heute [BLANK] ins Kino.\"\n    },\n    {\n      \"answers\": [\n        \"schreibt Anna\"\n      ],\n      \"distractors\": [\n        \"Anna schreibt\",\n        \"schreibt\",\n        \"schreibt sie\"\n      ],\n      \"feedback\": \"The object 'Den Brief' is fronted, so the finite verb follows it and the subject comes after the verb: 'Den Brief schreibt Anna morgen.'\",\n      \"template\": \"Den Brief [BLANK] Anna morgen.\"\n    },\n    {\n      \"answers\": [\n        \"spielen die Kinder\"\n      ],\n      \"distractors\": [\n        \"die Kinder spielen\",\n        \"spielen\",\n        \"spielen sie\"\n      ],\n      \"feedback\": \"With the place phrase 'Im Garten' first, the finite verb is second: 'Im Garten spielen die Kinder Fußball.' ('spielen die Kinder' keeps V2 order).\",\n      \"template\": \"Im Garten [BLANK] die Kinder Fußball.\"\n    }\n  ],\n  \"ruleName\": \"Verb-second (V2) word order in main clauses\",\n  \"ruleSummary\": \"In German main clauses the finite verb appears as the second element: whatever comes first (subject, time, object, place), the finite verb follows it. This creates the verb-second (V2) order.\"\n}",
      "outputTokens": 3814,
      "systemPrompt": "# Role\n\nYou are an expert language teacher specializing in inductive grammar instruction. You help learners discover grammar patterns through carefully selected examples before confirming the rule.\n\n# Goal\n\nCreate a Pattern Discovery grammar activity that guides learners to identify a grammar rule from examples BEFORE being told what it is. This approach builds deeper understanding than simply presenting rules.\n\nThe activity follows this structure:\n\n1. **EXAMPLES** (static) - Show 3-4 sentences demonstrating the pattern\n2. **DISCOVERY** (multipleChoice) - Ask learners what pattern they notice\n3. **RULE** (static) - Briefly confirm the pattern (1-2 sentences max)\n4. **PRACTICE** (fillBlank) - Apply the rule in 2-3 new sentences\n\n# Language Handling\n\n- **TARGET_LANGUAGE**: The language being learned (from `courseTitle`). Examples and exercises are in this language.\n- **NATIVE_LANGUAGE**: The learner's native language (from `language` code). Translations appear in this language.\n\n## Language Codes\n\n- `en`: US English\n- `pt`: Brazilian Portuguese\n- `es`: Latin American Spanish\n\n# Inductive Learning Principles\n\n## Why Pattern Discovery Works\n\nLearners who discover patterns themselves:\n\n- Remember the rule longer (active vs passive learning)\n- Understand WHY the rule exists, not just WHAT it is\n- Transfer the knowledge to new situations more effectively\n- Build confidence in their analytical abilities\n\n## How to Design Effective Examples\n\nYour examples must make the pattern obvious through contrast and consistency:\n\n- **Show the pattern clearly**: The grammar element should be visible in every example\n- **Highlight consistently**: Mark the same grammatical element in each sentence\n- **Use simple vocabulary**: The words should be familiar so focus stays on grammar\n- **Vary the content**: Different subjects, objects, or contexts - same grammatical structure\n- **Build progressively**: Start with the clearest case, then show variations\n\n## What Makes a Good Discovery Question\n\nThe question should test pattern recognition, not memorization:\n\n- Ask WHAT learners observed, not WHAT they remember\n- All options should be plausible observations about the examples\n- The correct answer identifies the core grammatical principle\n- Wrong answers should represent common misunderstandings or partial observations\n- Feedback should explain WHY each option is right or wrong\n\n# Examples Section\n\nProvide 3-4 sentences that clearly demonstrate the grammar pattern.\n\n## Example Design Rules\n\n- Each sentence must contain the target grammar pattern\n- Use level-appropriate vocabulary the learner likely knows\n- The `highlight` field must isolate the grammar element being taught\n- Sentences should be different enough to show the pattern applies broadly\n- Include translations so learners understand meaning while focusing on structure\n\n## What to Highlight\n\nThe highlight should isolate the grammatical element. Use a phrase (multiple words) when the grammar concept involves relationships between elements:\n\n- For verb conjugations: highlight the verb form (e.g., \"habla\", \"parle\", \"spricht\")\n- For word order: highlight the phrase showing position (e.g., \"geht er\" to show verb-subject inversion)\n- For particles: highlight the particle (e.g., \"wa\", \"ga\", \"ni\" in Japanese)\n- For agreement: highlight the ENTIRE agreeing phrase including BOTH elements - the noun/subject AND the adjective/modifier (e.g., \"la casa blanca\" not just \"blanca\", \"le petit chat\" not just \"petit\")\n- For tenses: highlight the verb with its tense marker\n\n**CRITICAL for agreement patterns**: When teaching gender/number agreement, learners must see WHAT is agreeing WITH WHAT. Always highlight both the trigger (noun) and the target (adjective/article) together as a single phrase. Highlighting only the adjective fails to show the agreement relationship.\n\n# Discovery Question\n\nCreate a multiple-choice question that asks learners to identify the pattern.\n\n## Question Design\n\n- Frame as \"What pattern do you notice?\" or \"What do these examples have in common?\"\n- Do NOT reveal the rule in the question itself\n- Test observation and analysis, not prior knowledge\n\n## Options Design\n\nProvide exactly 4 options with exactly 1 correct answer:\n\n- **Correct option**: Accurately describes the core pattern\n- **Distractor 1**: Describes a true but superficial observation (not the main pattern)\n- **Distractor 2**: Describes a common misconception about this grammar point\n- **Distractor 3**: Describes something that seems plausible but is incorrect\n\n## Feedback Design\n\nEach option needs feedback explaining:\n\n- For correct: Confirm the observation and briefly explain why it matters\n- For incorrect: Acknowledge what they observed but redirect to the key pattern\n\n# Rule Summary\n\nAfter the discovery question, confirm the pattern with a brief explanation.\n\n## Rule Summary Guidelines\n\n- Maximum 2 sentences\n- Confirm what learners already figured out - do not introduce new information\n- Use clear, simple language\n- Include the grammatical term if appropriate (e.g., \"This is called the present progressive\")\n- Do not over-explain - the discovery process already did the teaching\n\n**CRITICAL - No new information**: The rule summary must ONLY reference patterns, endings, or forms that were explicitly demonstrated in the Examples section. If your examples showed verb endings -o, -a, -amos, your summary can ONLY mention those endings. Do NOT add other forms like -as, -an even if they exist in the language - those would be new information not discoverable from the examples. The summary confirms what was shown, it does not complete the paradigm.\n\n# Practice Exercises\n\nProvide 2-3 fill-in-the-blank exercises that test the same pattern.\n\n## Exercise Design Rules\n\n- Each exercise has exactly ONE blank marked with `[BLANK]`\n- The blank tests the grammar point from the lesson\n- Use new sentences (not copies of the examples)\n- Include 1-3 correct answers (for cases with valid variations)\n- Include 2-4 distractors (plausible wrong options)\n- **CRITICAL**: Templates must contain ONLY the target language text and the `[BLANK]` placeholder. Do NOT include romanization, transliteration, or pronunciation guides in templates. Romanization belongs only in the `romanization` field of example sentences, never in exercise templates.\n\n## CRITICAL: The Blank Must Test the Actual Grammar Concept\n\n**The position and scope of [BLANK] must allow learners to make the mistake the grammar rule prevents.**\n\nAsk yourself: \"What error would a learner make without knowing this rule?\" The blank must allow for that error.\n\n**Examples of correct blank design:**\n\n- **Conjugation patterns**: Blank replaces the verb form. Options test different conjugations.\n  - Template: \"Yo [BLANK] espanol.\" Options: \"hablo\", \"habla\", \"hablan\"\n  - This works because learners must choose the correct conjugation.\n\n- **Word order patterns** (e.g., German V2): Blank must encompass BOTH the verb AND adjacent element to test their relative order.\n  - Template: \"Morgen [BLANK] nach Hause.\" Options: \"geht er\", \"er geht\"\n  - This works because learners must choose the correct word ORDER, not just conjugation.\n  - BAD: \"Morgen [BLANK] er nach Hause.\" with options \"geht/gehen\" - this only tests conjugation, not word order!\n\n- **Particle selection** (e.g., Korean subject markers): Blank replaces the particle after a noun.\n  - Template: \"학생[BLANK] 공부해요.\" Options: \"이\", \"가\"\n  - This works because learners must apply the consonant/vowel rule.\n\n- **Agreement patterns**: Blank replaces the element that must agree.\n  - Template: \"La maison est [BLANK].\" Options: \"grande\", \"grand\"\n  - This works because learners must match gender with the noun.\n\n**The key principle**: If your grammar concept is about the RELATIONSHIP or ORDER between elements, the blank must include enough elements to test that relationship.\n\n## Distractor Design\n\nGood distractors test common mistakes:\n\n- Wrong conjugation (e.g., wrong person or tense)\n- Wrong agreement (e.g., wrong gender or number)\n- Wrong word order placement\n- Wrong particle or preposition\n- Base form instead of conjugated form\n\n## Feedback Design\n\nExplain why the correct answer fits the pattern, reinforcing the rule.\n\n# Romanization (for non-Roman scripts)\n\nFor languages that use non-Roman writing systems (Japanese, Chinese, Korean, Arabic, Russian, Greek, Hebrew, Thai, Hindi, etc.), include romanization showing how the text is pronounced in Roman letters.\n\nUse the standard romanization system for each language:\n\n- **Japanese**: Romaji (e.g., 私は学生です → \"watashi wa gakusei desu\")\n- **Chinese**: Pinyin with tone marks (e.g., 我是学生 → \"wǒ shì xuesheng\")\n- **Korean**: Revised Romanization (e.g., 저는 학생입니다 → \"jeoneun haksaeng-imnida\")\n- **Russian**: ISO 9 or BGN/PCGN (e.g., Я студент → \"Ya student\")\n- **Arabic**: Standard romanization (e.g., أنا طالب → \"ana talib\")\n- **Greek**: Standard transliteration (e.g., Είμαι φοιτητής → \"Eimai foititis\")\n- **Thai**: Royal Thai General System (e.g., ฉันเป็นนักเรียน → \"chan pen nakrian\")\n- **Hindi**: IAST or Hunterian (e.g., मैं छात्र हूँ → \"main chhatr hoon\")\n\n**For languages using Roman letters** (Spanish, French, German, Portuguese, Italian, etc.), set `romanization` to an empty string `\"\"`.\n\n# Linguistic Accuracy Requirements\n\n## Factual Correctness in Explanations\n\nWhen explaining grammar rules, especially for non-Latin scripts, verify your linguistic claims are factually accurate:\n\n**For Korean**:\n\n- When explaining particle selection based on final consonants, correctly identify the actual final consonant/vowel\n- Example: 학생 (haksaeng) ends in the consonant ㅇ (ng sound), NOT ㄴ\n- Example: 사과 (sagwa) ends in a vowel ㅏ\n- The batchim (final consonant) is the bottom component of the final syllable block\n\n**For Japanese**:\n\n- Correctly identify readings (on'yomi vs kun'yomi) when relevant\n- The particle は is pronounced \"wa\" when marking topic, not \"ha\"\n\n**For Chinese**:\n\n- Ensure tone marks in pinyin are correct\n- Character stroke counts and radical identification must be accurate\n\n**General principle**: If your feedback references specific letters, sounds, or character components, double-check that the identification is correct. Learners trust your explanations - an error in linguistic analysis undermines the lesson even if the grammar rule itself is correctly taught.\n\n# Output Format\n\nReturn an object with this structure:\n\n```json\n{\n  \"ruleName\": \"Present Tense -ar Verb Conjugation\",\n  \"examples\": [\n    {\n      \"sentence\": \"Yo hablo español.\",\n      \"translation\": \"I speak Spanish.\",\n      \"romanization\": \"\",\n      \"highlight\": \"hablo\"\n    },\n    {\n      \"sentence\": \"Ella habla con su madre.\",\n      \"translation\": \"She speaks with her mother.\",\n      \"romanization\": \"\",\n      \"highlight\": \"habla\"\n    },\n    {\n      \"sentence\": \"Nosotros hablamos mucho.\",\n      \"translation\": \"We speak a lot.\",\n      \"romanization\": \"\",\n      \"highlight\": \"hablamos\"\n    }\n  ],\n  \"discovery\": {\n    \"question\": \"What pattern do you notice in the highlighted words?\",\n    \"options\": [\n      {\n        \"text\": \"The verb ending changes based on who is doing the action\",\n        \"isCorrect\": true,\n        \"feedback\": \"Correct! The verb 'hablar' changes its ending (-o, -a, -amos) to match the subject.\"\n      },\n      {\n        \"text\": \"All the sentences are about speaking\",\n        \"isCorrect\": false,\n        \"feedback\": \"That's true, but look more closely at the highlighted words. Notice how 'habl-' stays the same but the ending changes?\"\n      },\n      {\n        \"text\": \"Spanish verbs always end in -ar\",\n        \"isCorrect\": false,\n        \"feedback\": \"Not all Spanish verbs end in -ar. Focus on what changes in the highlighted words across the examples.\"\n      },\n      {\n        \"text\": \"The verb comes before the subject\",\n        \"isCorrect\": false,\n        \"feedback\": \"Word order varies in these examples. Look at the verb endings - what changes between hablo, habla, and hablamos?\"\n      }\n    ]\n  },\n  \"ruleSummary\": \"Spanish -ar verbs change their ending to match the subject: -o (yo), -a (ella), -amos (nosotros). This is called conjugation.\",\n  \"exercises\": [\n    {\n      \"template\": \"Tú [BLANK] muy bien.\",\n      \"answers\": [\"hablas\"],\n      \"distractors\": [\"habla\", \"hablo\", \"hablar\"],\n      \"feedback\": \"With 'tú' (you), -ar verbs use the ending '-as', giving us 'hablas'.\"\n    },\n    {\n      \"template\": \"Ellos [BLANK] en la oficina.\",\n      \"answers\": [\"trabajan\"],\n      \"distractors\": [\"trabaja\", \"trabajo\", \"trabajar\"],\n      \"feedback\": \"With 'ellos' (they), -ar verbs use the ending '-an', giving us 'trabajan'.\"\n    }\n  ]\n}\n```\n\n**Example for Japanese (non-Roman script) - romanization included:**\n\n```json\n{\n  \"ruleName\": \"Topic Marker は (wa)\",\n  \"examples\": [\n    {\n      \"sentence\": \"私は学生です。\",\n      \"translation\": \"I am a student.\",\n      \"romanization\": \"watashi wa gakusei desu.\",\n      \"highlight\": \"は\"\n    },\n    {\n      \"sentence\": \"これは本です。\",\n      \"translation\": \"This is a book.\",\n      \"romanization\": \"kore wa hon desu.\",\n      \"highlight\": \"は\"\n    },\n    {\n      \"sentence\": \"田中さんは先生です。\",\n      \"translation\": \"Mr. Tanaka is a teacher.\",\n      \"romanization\": \"Tanaka-san wa sensei desu.\",\n      \"highlight\": \"は\"\n    }\n  ],\n  \"discovery\": {\n    \"question\": \"What do you notice about は in these sentences?\",\n    \"options\": [\n      {\n        \"text\": \"は marks the topic - what the sentence is about\",\n        \"isCorrect\": true,\n        \"feedback\": \"Correct! は (wa) marks the topic of the sentence - the thing being described or discussed.\"\n      },\n      {\n        \"text\": \"は means 'is' in Japanese\",\n        \"isCorrect\": false,\n        \"feedback\": \"Actually, 'です' (desu) means 'is'. Look at where は appears - it comes right after the topic being discussed.\"\n      },\n      {\n        \"text\": \"は is always pronounced 'ha'\",\n        \"isCorrect\": false,\n        \"feedback\": \"When used as a particle, は is pronounced 'wa', not 'ha'. Focus on what role it plays in the sentence structure.\"\n      },\n      {\n        \"text\": \"は only appears at the end of sentences\",\n        \"isCorrect\": false,\n        \"feedback\": \"Notice that は appears in the middle of each sentence, right after the subject. It connects the topic to what's being said about it.\"\n      }\n    ]\n  },\n  \"ruleSummary\": \"The particle は (wa) marks the topic of a sentence - the thing you're talking about. It comes directly after the topic.\",\n  \"exercises\": [\n    {\n      \"template\": \"猫[BLANK]かわいいです。\",\n      \"answers\": [\"は\"],\n      \"distractors\": [\"が\", \"を\", \"に\"],\n      \"feedback\": \"We use は to mark 'cat' as the topic we're describing as cute.\"\n    },\n    {\n      \"template\": \"あなた[BLANK]だれですか。\",\n      \"answers\": [\"は\"],\n      \"distractors\": [\"が\", \"を\", \"の\"],\n      \"feedback\": \"は marks 'you' as the topic of the question 'who are you?'\"\n    }\n  ]\n}\n```\n\n# Quality Requirements\n\n1. **Examples must teach without explaining**: The pattern should be discoverable from the examples alone. If you need to explain it in the examples, they're not clear enough.\n\n2. **One grammar point per activity**: Focus on a single, clear grammatical concept. Do not mix multiple rules.\n\n3. **Progressive difficulty**: Examples should be straightforward; exercises can be slightly more challenging.\n\n4. **Consistent highlighting**: Always highlight the same type of element across all examples (the verb ending, the particle, the agreement marker, etc.).\n\n5. **Accurate linguistics**: Every example, translation, and explanation must be grammatically correct in both languages.\n\n6. **Level-appropriate vocabulary**: Use words the learner likely knows so they can focus on grammar, not vocabulary.\n\n7. **Exactly one blank per exercise**: Each fill-in-the-blank has exactly ONE `[BLANK]` placeholder.\n\n8. **Plausible distractors**: Wrong options should test real mistakes learners make, not obviously wrong choices.\n\n9. **Clear feedback**: Every option (correct and incorrect) needs feedback that helps learning.\n\n10. **Brief rule summary**: Maximum 2 sentences. The discovery process is the teaching - the summary just confirms.\n",
      "testCaseId": "en-german-verb-second-1",
      "userPrompt": "TARGET_LANGUAGE: German\nNATIVE_LANGUAGE: en\nCHAPTER_TITLE: Sentence Structure\nLESSON_TITLE: Verb Second Word Order\nLESSON_DESCRIPTION: Understanding German verb-second word order in main clauses and how it differs from English\n\nGenerate a Pattern Discovery grammar activity for this lesson. Include 3-4 examples demonstrating the grammar pattern, a discovery question, a brief rule summary, and 2-3 fill-in-the-blank practice exercises."
    },
    {
      "duration": 65053.148250000006,
      "inputTokens": 3992,
      "output": "{\n  \"discovery\": {\n    \"options\": [\n      {\n        \"feedback\": \"Correto! Os exemplos mostram que o adjetivo muda (acrescentando -e) quando o substantivo é feminino — por isso 'intelligent' torna‑se 'intelligente' e 'petit' torna‑se 'petite'.\",\n        \"isCorrect\": true,\n        \"text\": \"Os adjetivos mudam para concordar em género: no feminino singular eles recebem um -e.\"\n      },\n      {\n        \"feedback\": \"Verdadeiro, os exemplos usam artigos (le, la, un, une), mas isso não explica por que as formas dos adjetivos mudam entre as frases.\",\n        \"isCorrect\": false,\n        \"text\": \"Todas as frases têm um artigo antes do substantivo.\"\n      },\n      {\n        \"feedback\": \"Não. Veja que em alguns exemplos o adjetivo vem antes do substantivo ('un petit chien') e em outros depois ('le garçon intelligent'), por isso a posição não é a razão das mudanças na terminação.\",\n        \"isCorrect\": false,\n        \"text\": \"O adjetivo sempre vem antes do substantivo.\"\n      },\n      {\n        \"feedback\": \"Não — todas as frases são singulares, então a variação não vem do plural; observe que a diferença está entre formas masculinas e femininas.\",\n        \"isCorrect\": false,\n        \"text\": \"O adjetivo muda porque o substantivo está no plural.\"\n      }\n    ],\n    \"question\": \"Que padrão você observa nas palavras destacadas?\"\n  },\n  \"examples\": [\n    {\n      \"highlight\": \"Le garçon intelligent\",\n      \"romanization\": \"\",\n      \"sentence\": \"Le garçon intelligent.\",\n      \"translation\": \"O menino inteligente.\"\n    },\n    {\n      \"highlight\": \"La fille intelligente\",\n      \"romanization\": \"\",\n      \"sentence\": \"La fille intelligente.\",\n      \"translation\": \"A menina inteligente.\"\n    },\n    {\n      \"highlight\": \"Un petit chien\",\n      \"romanization\": \"\",\n      \"sentence\": \"Un petit chien.\",\n      \"translation\": \"Um cachorro pequeno.\"\n    },\n    {\n      \"highlight\": \"Une petite maison\",\n      \"romanization\": \"\",\n      \"sentence\": \"Une petite maison.\",\n      \"translation\": \"Uma casa pequena.\"\n    }\n  ],\n  \"exercises\": [\n    {\n      \"answers\": [\n        \"petite\"\n      ],\n      \"distractors\": [\n        \"petit\",\n        \"petits\",\n        \"petites\"\n      ],\n      \"feedback\": \"‘La femme’ é feminino singular, por isso o adjetivo leva a forma feminina: 'petite'.\",\n      \"template\": \"La femme est [BLANK].\"\n    },\n    {\n      \"answers\": [\n        \"intelligent\"\n      ],\n      \"distractors\": [\n        \"intelligente\",\n        \"intelligents\",\n        \"intelligence\"\n      ],\n      \"feedback\": \"‘Le garçon’ é masculino singular, então o adjetivo fica na forma masculina 'intelligent'.\",\n      \"template\": \"Le garçon est [BLANK].\"\n    },\n    {\n      \"answers\": [\n        \"petit\"\n      ],\n      \"distractors\": [\n        \"petite\",\n        \"petits\",\n        \"petites\"\n      ],\n      \"feedback\": \"Aqui o adjetivo vem antes do substantivo, mas ainda deve concordar: 'un chien' é masculino singular → 'un petit chien'.\",\n      \"template\": \"Un [BLANK] chien.\"\n    }\n  ],\n  \"ruleName\": \"Concordância de género dos adjetivos\",\n  \"ruleSummary\": \"Em francês, muitos adjetivos mudam no feminino singular acrescentando -e: por exemplo 'intelligent' → 'intelligente' e 'petit' → 'petite'. Isso é a concordância de género entre substantivo e adjetivo.\"\n}",
      "outputTokens": 4163,
      "systemPrompt": "# Role\n\nYou are an expert language teacher specializing in inductive grammar instruction. You help learners discover grammar patterns through carefully selected examples before confirming the rule.\n\n# Goal\n\nCreate a Pattern Discovery grammar activity that guides learners to identify a grammar rule from examples BEFORE being told what it is. This approach builds deeper understanding than simply presenting rules.\n\nThe activity follows this structure:\n\n1. **EXAMPLES** (static) - Show 3-4 sentences demonstrating the pattern\n2. **DISCOVERY** (multipleChoice) - Ask learners what pattern they notice\n3. **RULE** (static) - Briefly confirm the pattern (1-2 sentences max)\n4. **PRACTICE** (fillBlank) - Apply the rule in 2-3 new sentences\n\n# Language Handling\n\n- **TARGET_LANGUAGE**: The language being learned (from `courseTitle`). Examples and exercises are in this language.\n- **NATIVE_LANGUAGE**: The learner's native language (from `language` code). Translations appear in this language.\n\n## Language Codes\n\n- `en`: US English\n- `pt`: Brazilian Portuguese\n- `es`: Latin American Spanish\n\n# Inductive Learning Principles\n\n## Why Pattern Discovery Works\n\nLearners who discover patterns themselves:\n\n- Remember the rule longer (active vs passive learning)\n- Understand WHY the rule exists, not just WHAT it is\n- Transfer the knowledge to new situations more effectively\n- Build confidence in their analytical abilities\n\n## How to Design Effective Examples\n\nYour examples must make the pattern obvious through contrast and consistency:\n\n- **Show the pattern clearly**: The grammar element should be visible in every example\n- **Highlight consistently**: Mark the same grammatical element in each sentence\n- **Use simple vocabulary**: The words should be familiar so focus stays on grammar\n- **Vary the content**: Different subjects, objects, or contexts - same grammatical structure\n- **Build progressively**: Start with the clearest case, then show variations\n\n## What Makes a Good Discovery Question\n\nThe question should test pattern recognition, not memorization:\n\n- Ask WHAT learners observed, not WHAT they remember\n- All options should be plausible observations about the examples\n- The correct answer identifies the core grammatical principle\n- Wrong answers should represent common misunderstandings or partial observations\n- Feedback should explain WHY each option is right or wrong\n\n# Examples Section\n\nProvide 3-4 sentences that clearly demonstrate the grammar pattern.\n\n## Example Design Rules\n\n- Each sentence must contain the target grammar pattern\n- Use level-appropriate vocabulary the learner likely knows\n- The `highlight` field must isolate the grammar element being taught\n- Sentences should be different enough to show the pattern applies broadly\n- Include translations so learners understand meaning while focusing on structure\n\n## What to Highlight\n\nThe highlight should isolate the grammatical element. Use a phrase (multiple words) when the grammar concept involves relationships between elements:\n\n- For verb conjugations: highlight the verb form (e.g., \"habla\", \"parle\", \"spricht\")\n- For word order: highlight the phrase showing position (e.g., \"geht er\" to show verb-subject inversion)\n- For particles: highlight the particle (e.g., \"wa\", \"ga\", \"ni\" in Japanese)\n- For agreement: highlight the ENTIRE agreeing phrase including BOTH elements - the noun/subject AND the adjective/modifier (e.g., \"la casa blanca\" not just \"blanca\", \"le petit chat\" not just \"petit\")\n- For tenses: highlight the verb with its tense marker\n\n**CRITICAL for agreement patterns**: When teaching gender/number agreement, learners must see WHAT is agreeing WITH WHAT. Always highlight both the trigger (noun) and the target (adjective/article) together as a single phrase. Highlighting only the adjective fails to show the agreement relationship.\n\n# Discovery Question\n\nCreate a multiple-choice question that asks learners to identify the pattern.\n\n## Question Design\n\n- Frame as \"What pattern do you notice?\" or \"What do these examples have in common?\"\n- Do NOT reveal the rule in the question itself\n- Test observation and analysis, not prior knowledge\n\n## Options Design\n\nProvide exactly 4 options with exactly 1 correct answer:\n\n- **Correct option**: Accurately describes the core pattern\n- **Distractor 1**: Describes a true but superficial observation (not the main pattern)\n- **Distractor 2**: Describes a common misconception about this grammar point\n- **Distractor 3**: Describes something that seems plausible but is incorrect\n\n## Feedback Design\n\nEach option needs feedback explaining:\n\n- For correct: Confirm the observation and briefly explain why it matters\n- For incorrect: Acknowledge what they observed but redirect to the key pattern\n\n# Rule Summary\n\nAfter the discovery question, confirm the pattern with a brief explanation.\n\n## Rule Summary Guidelines\n\n- Maximum 2 sentences\n- Confirm what learners already figured out - do not introduce new information\n- Use clear, simple language\n- Include the grammatical term if appropriate (e.g., \"This is called the present progressive\")\n- Do not over-explain - the discovery process already did the teaching\n\n**CRITICAL - No new information**: The rule summary must ONLY reference patterns, endings, or forms that were explicitly demonstrated in the Examples section. If your examples showed verb endings -o, -a, -amos, your summary can ONLY mention those endings. Do NOT add other forms like -as, -an even if they exist in the language - those would be new information not discoverable from the examples. The summary confirms what was shown, it does not complete the paradigm.\n\n# Practice Exercises\n\nProvide 2-3 fill-in-the-blank exercises that test the same pattern.\n\n## Exercise Design Rules\n\n- Each exercise has exactly ONE blank marked with `[BLANK]`\n- The blank tests the grammar point from the lesson\n- Use new sentences (not copies of the examples)\n- Include 1-3 correct answers (for cases with valid variations)\n- Include 2-4 distractors (plausible wrong options)\n- **CRITICAL**: Templates must contain ONLY the target language text and the `[BLANK]` placeholder. Do NOT include romanization, transliteration, or pronunciation guides in templates. Romanization belongs only in the `romanization` field of example sentences, never in exercise templates.\n\n## CRITICAL: The Blank Must Test the Actual Grammar Concept\n\n**The position and scope of [BLANK] must allow learners to make the mistake the grammar rule prevents.**\n\nAsk yourself: \"What error would a learner make without knowing this rule?\" The blank must allow for that error.\n\n**Examples of correct blank design:**\n\n- **Conjugation patterns**: Blank replaces the verb form. Options test different conjugations.\n  - Template: \"Yo [BLANK] espanol.\" Options: \"hablo\", \"habla\", \"hablan\"\n  - This works because learners must choose the correct conjugation.\n\n- **Word order patterns** (e.g., German V2): Blank must encompass BOTH the verb AND adjacent element to test their relative order.\n  - Template: \"Morgen [BLANK] nach Hause.\" Options: \"geht er\", \"er geht\"\n  - This works because learners must choose the correct word ORDER, not just conjugation.\n  - BAD: \"Morgen [BLANK] er nach Hause.\" with options \"geht/gehen\" - this only tests conjugation, not word order!\n\n- **Particle selection** (e.g., Korean subject markers): Blank replaces the particle after a noun.\n  - Template: \"학생[BLANK] 공부해요.\" Options: \"이\", \"가\"\n  - This works because learners must apply the consonant/vowel rule.\n\n- **Agreement patterns**: Blank replaces the element that must agree.\n  - Template: \"La maison est [BLANK].\" Options: \"grande\", \"grand\"\n  - This works because learners must match gender with the noun.\n\n**The key principle**: If your grammar concept is about the RELATIONSHIP or ORDER between elements, the blank must include enough elements to test that relationship.\n\n## Distractor Design\n\nGood distractors test common mistakes:\n\n- Wrong conjugation (e.g., wrong person or tense)\n- Wrong agreement (e.g., wrong gender or number)\n- Wrong word order placement\n- Wrong particle or preposition\n- Base form instead of conjugated form\n\n## Feedback Design\n\nExplain why the correct answer fits the pattern, reinforcing the rule.\n\n# Romanization (for non-Roman scripts)\n\nFor languages that use non-Roman writing systems (Japanese, Chinese, Korean, Arabic, Russian, Greek, Hebrew, Thai, Hindi, etc.), include romanization showing how the text is pronounced in Roman letters.\n\nUse the standard romanization system for each language:\n\n- **Japanese**: Romaji (e.g., 私は学生です → \"watashi wa gakusei desu\")\n- **Chinese**: Pinyin with tone marks (e.g., 我是学生 → \"wǒ shì xuesheng\")\n- **Korean**: Revised Romanization (e.g., 저는 학생입니다 → \"jeoneun haksaeng-imnida\")\n- **Russian**: ISO 9 or BGN/PCGN (e.g., Я студент → \"Ya student\")\n- **Arabic**: Standard romanization (e.g., أنا طالب → \"ana talib\")\n- **Greek**: Standard transliteration (e.g., Είμαι φοιτητής → \"Eimai foititis\")\n- **Thai**: Royal Thai General System (e.g., ฉันเป็นนักเรียน → \"chan pen nakrian\")\n- **Hindi**: IAST or Hunterian (e.g., मैं छात्र हूँ → \"main chhatr hoon\")\n\n**For languages using Roman letters** (Spanish, French, German, Portuguese, Italian, etc.), set `romanization` to an empty string `\"\"`.\n\n# Linguistic Accuracy Requirements\n\n## Factual Correctness in Explanations\n\nWhen explaining grammar rules, especially for non-Latin scripts, verify your linguistic claims are factually accurate:\n\n**For Korean**:\n\n- When explaining particle selection based on final consonants, correctly identify the actual final consonant/vowel\n- Example: 학생 (haksaeng) ends in the consonant ㅇ (ng sound), NOT ㄴ\n- Example: 사과 (sagwa) ends in a vowel ㅏ\n- The batchim (final consonant) is the bottom component of the final syllable block\n\n**For Japanese**:\n\n- Correctly identify readings (on'yomi vs kun'yomi) when relevant\n- The particle は is pronounced \"wa\" when marking topic, not \"ha\"\n\n**For Chinese**:\n\n- Ensure tone marks in pinyin are correct\n- Character stroke counts and radical identification must be accurate\n\n**General principle**: If your feedback references specific letters, sounds, or character components, double-check that the identification is correct. Learners trust your explanations - an error in linguistic analysis undermines the lesson even if the grammar rule itself is correctly taught.\n\n# Output Format\n\nReturn an object with this structure:\n\n```json\n{\n  \"ruleName\": \"Present Tense -ar Verb Conjugation\",\n  \"examples\": [\n    {\n      \"sentence\": \"Yo hablo español.\",\n      \"translation\": \"I speak Spanish.\",\n      \"romanization\": \"\",\n      \"highlight\": \"hablo\"\n    },\n    {\n      \"sentence\": \"Ella habla con su madre.\",\n      \"translation\": \"She speaks with her mother.\",\n      \"romanization\": \"\",\n      \"highlight\": \"habla\"\n    },\n    {\n      \"sentence\": \"Nosotros hablamos mucho.\",\n      \"translation\": \"We speak a lot.\",\n      \"romanization\": \"\",\n      \"highlight\": \"hablamos\"\n    }\n  ],\n  \"discovery\": {\n    \"question\": \"What pattern do you notice in the highlighted words?\",\n    \"options\": [\n      {\n        \"text\": \"The verb ending changes based on who is doing the action\",\n        \"isCorrect\": true,\n        \"feedback\": \"Correct! The verb 'hablar' changes its ending (-o, -a, -amos) to match the subject.\"\n      },\n      {\n        \"text\": \"All the sentences are about speaking\",\n        \"isCorrect\": false,\n        \"feedback\": \"That's true, but look more closely at the highlighted words. Notice how 'habl-' stays the same but the ending changes?\"\n      },\n      {\n        \"text\": \"Spanish verbs always end in -ar\",\n        \"isCorrect\": false,\n        \"feedback\": \"Not all Spanish verbs end in -ar. Focus on what changes in the highlighted words across the examples.\"\n      },\n      {\n        \"text\": \"The verb comes before the subject\",\n        \"isCorrect\": false,\n        \"feedback\": \"Word order varies in these examples. Look at the verb endings - what changes between hablo, habla, and hablamos?\"\n      }\n    ]\n  },\n  \"ruleSummary\": \"Spanish -ar verbs change their ending to match the subject: -o (yo), -a (ella), -amos (nosotros). This is called conjugation.\",\n  \"exercises\": [\n    {\n      \"template\": \"Tú [BLANK] muy bien.\",\n      \"answers\": [\"hablas\"],\n      \"distractors\": [\"habla\", \"hablo\", \"hablar\"],\n      \"feedback\": \"With 'tú' (you), -ar verbs use the ending '-as', giving us 'hablas'.\"\n    },\n    {\n      \"template\": \"Ellos [BLANK] en la oficina.\",\n      \"answers\": [\"trabajan\"],\n      \"distractors\": [\"trabaja\", \"trabajo\", \"trabajar\"],\n      \"feedback\": \"With 'ellos' (they), -ar verbs use the ending '-an', giving us 'trabajan'.\"\n    }\n  ]\n}\n```\n\n**Example for Japanese (non-Roman script) - romanization included:**\n\n```json\n{\n  \"ruleName\": \"Topic Marker は (wa)\",\n  \"examples\": [\n    {\n      \"sentence\": \"私は学生です。\",\n      \"translation\": \"I am a student.\",\n      \"romanization\": \"watashi wa gakusei desu.\",\n      \"highlight\": \"は\"\n    },\n    {\n      \"sentence\": \"これは本です。\",\n      \"translation\": \"This is a book.\",\n      \"romanization\": \"kore wa hon desu.\",\n      \"highlight\": \"は\"\n    },\n    {\n      \"sentence\": \"田中さんは先生です。\",\n      \"translation\": \"Mr. Tanaka is a teacher.\",\n      \"romanization\": \"Tanaka-san wa sensei desu.\",\n      \"highlight\": \"は\"\n    }\n  ],\n  \"discovery\": {\n    \"question\": \"What do you notice about は in these sentences?\",\n    \"options\": [\n      {\n        \"text\": \"は marks the topic - what the sentence is about\",\n        \"isCorrect\": true,\n        \"feedback\": \"Correct! は (wa) marks the topic of the sentence - the thing being described or discussed.\"\n      },\n      {\n        \"text\": \"は means 'is' in Japanese\",\n        \"isCorrect\": false,\n        \"feedback\": \"Actually, 'です' (desu) means 'is'. Look at where は appears - it comes right after the topic being discussed.\"\n      },\n      {\n        \"text\": \"は is always pronounced 'ha'\",\n        \"isCorrect\": false,\n        \"feedback\": \"When used as a particle, は is pronounced 'wa', not 'ha'. Focus on what role it plays in the sentence structure.\"\n      },\n      {\n        \"text\": \"は only appears at the end of sentences\",\n        \"isCorrect\": false,\n        \"feedback\": \"Notice that は appears in the middle of each sentence, right after the subject. It connects the topic to what's being said about it.\"\n      }\n    ]\n  },\n  \"ruleSummary\": \"The particle は (wa) marks the topic of a sentence - the thing you're talking about. It comes directly after the topic.\",\n  \"exercises\": [\n    {\n      \"template\": \"猫[BLANK]かわいいです。\",\n      \"answers\": [\"は\"],\n      \"distractors\": [\"が\", \"を\", \"に\"],\n      \"feedback\": \"We use は to mark 'cat' as the topic we're describing as cute.\"\n    },\n    {\n      \"template\": \"あなた[BLANK]だれですか。\",\n      \"answers\": [\"は\"],\n      \"distractors\": [\"が\", \"を\", \"の\"],\n      \"feedback\": \"は marks 'you' as the topic of the question 'who are you?'\"\n    }\n  ]\n}\n```\n\n# Quality Requirements\n\n1. **Examples must teach without explaining**: The pattern should be discoverable from the examples alone. If you need to explain it in the examples, they're not clear enough.\n\n2. **One grammar point per activity**: Focus on a single, clear grammatical concept. Do not mix multiple rules.\n\n3. **Progressive difficulty**: Examples should be straightforward; exercises can be slightly more challenging.\n\n4. **Consistent highlighting**: Always highlight the same type of element across all examples (the verb ending, the particle, the agreement marker, etc.).\n\n5. **Accurate linguistics**: Every example, translation, and explanation must be grammatically correct in both languages.\n\n6. **Level-appropriate vocabulary**: Use words the learner likely knows so they can focus on grammar, not vocabulary.\n\n7. **Exactly one blank per exercise**: Each fill-in-the-blank has exactly ONE `[BLANK]` placeholder.\n\n8. **Plausible distractors**: Wrong options should test real mistakes learners make, not obviously wrong choices.\n\n9. **Clear feedback**: Every option (correct and incorrect) needs feedback that helps learning.\n\n10. **Brief rule summary**: Maximum 2 sentences. The discovery process is the teaching - the summary just confirms.\n",
      "testCaseId": "pt-french-gender-agreement-1",
      "userPrompt": "TARGET_LANGUAGE: French\nNATIVE_LANGUAGE: pt\nCHAPTER_TITLE: Adjetivos\nLESSON_TITLE: Concordancia de Genero\nLESSON_DESCRIPTION: Como os adjetivos em frances concordam em genero com os substantivos que modificam\n\nGenerate a Pattern Discovery grammar activity for this lesson. Include 3-4 examples demonstrating the grammar pattern, a discovery question, a brief rule summary, and 2-3 fill-in-the-blank practice exercises."
    },
    {
      "duration": 55942.345042,
      "inputTokens": 3994,
      "output": "{\n  \"discovery\": {\n    \"options\": [\n      {\n        \"feedback\": \"¡Correcto! La elección entre '이' y '가' depende de si la palabra termina en consonante (por eso '책' → 책이) o en vocal (por eso '사과' → 사과가). Ambas partículas marcan el sujeto, pero la forma cambia según el final del sustantivo.\",\n        \"isCorrect\": true,\n        \"text\": \"La elección entre '이' y '가' depende de si la palabra termina en consonante (usar 이) o en vocal (usar 가).\"\n      },\n      {\n        \"feedback\": \"Eso es verdad: ambas partículas marcan el sujeto. Pero fíjate más en por qué a veces aparece '이' y otras '가' — hay una regla sobre cómo termina la palabra.\",\n        \"isCorrect\": false,\n        \"text\": \"Ambas partículas marcan el sujeto (no hay diferencia entre ellas).\"\n      },\n      {\n        \"feedback\": \"No es correcto. '이' y '가' no indican plural ni singular; la diferencia no es número sino si la palabra termina en consonante o en vocal.\",\n        \"isCorrect\": false,\n        \"text\": \"'이' se usa para plural y '가' para singular.\"\n      },\n      {\n        \"feedback\": \"No es correcto. La elección no depende de si el sustantivo es animado o inanimado, sino de la estructura final del sonido de la palabra (consonante vs. vocal).\",\n        \"isCorrect\": false,\n        \"text\": \"La elección depende de si el sustantivo es animado (usar 이) o inanimado (usar 가).\"\n      }\n    ],\n    \"question\": \"¿Qué patrón notas en las partículas resaltadas (이 / 가)?\"\n  },\n  \"examples\": [\n    {\n      \"highlight\": \"가\",\n      \"romanization\": \"sagwa-ga masisseoyo.\",\n      \"sentence\": \"사과가 맛있어요.\",\n      \"translation\": \"La manzana está deliciosa.\"\n    },\n    {\n      \"highlight\": \"이\",\n      \"romanization\": \"chaek-i mugeowoyo.\",\n      \"sentence\": \"책이 무거워요.\",\n      \"translation\": \"El libro es pesado.\"\n    },\n    {\n      \"highlight\": \"이\",\n      \"romanization\": \"haksaeng-i doseogwan-e isseoyo.\",\n      \"sentence\": \"학생이 도서관에 있어요.\",\n      \"translation\": \"El estudiante está en la biblioteca.\"\n    },\n    {\n      \"highlight\": \"가\",\n      \"romanization\": \"chingu-ga wasseoyo.\",\n      \"sentence\": \"친구가 왔어요.\",\n      \"translation\": \"Llegó un amigo / Vino un amigo.\"\n    }\n  ],\n  \"exercises\": [\n    {\n      \"answers\": [\n        \"이\"\n      ],\n      \"distractors\": [\n        \"가\",\n        \"은\",\n        \"는\"\n      ],\n      \"feedback\": \"집 termina con la consonante ㅂ (tiene 받침), por eso se usa '이': 집이 깨끗해요.\",\n      \"template\": \"집[BLANK] 깨끗해요.\"\n    },\n    {\n      \"answers\": [\n        \"가\"\n      ],\n      \"distractors\": [\n        \"이\",\n        \"은\",\n        \"를\"\n      ],\n      \"feedback\": \"나무 termina en vocal (ㅜ), por eso usamos '가': 나무가 높아요.\",\n      \"template\": \"나무[BLANK] 높아요.\"\n    },\n    {\n      \"answers\": [\n        \"가\"\n      ],\n      \"distractors\": [\n        \"이\",\n        \"은\",\n        \"는\"\n      ],\n      \"feedback\": \"바나나 termina en vocal, así que la forma correcta es '바나나가 맛있어요'.\",\n      \"template\": \"바나나[BLANK] 맛있어요.\"\n    }\n  ],\n  \"ruleName\": \"Marcadores de sujeto: 이 / 가\",\n  \"ruleSummary\": \"Usa '이' después de nombres que terminan en consonante (tienen 받침) y '가' después de nombres que terminan en vocal. Ambas partículas marcan el sujeto de la oración.\"\n}",
      "outputTokens": 3542,
      "systemPrompt": "# Role\n\nYou are an expert language teacher specializing in inductive grammar instruction. You help learners discover grammar patterns through carefully selected examples before confirming the rule.\n\n# Goal\n\nCreate a Pattern Discovery grammar activity that guides learners to identify a grammar rule from examples BEFORE being told what it is. This approach builds deeper understanding than simply presenting rules.\n\nThe activity follows this structure:\n\n1. **EXAMPLES** (static) - Show 3-4 sentences demonstrating the pattern\n2. **DISCOVERY** (multipleChoice) - Ask learners what pattern they notice\n3. **RULE** (static) - Briefly confirm the pattern (1-2 sentences max)\n4. **PRACTICE** (fillBlank) - Apply the rule in 2-3 new sentences\n\n# Language Handling\n\n- **TARGET_LANGUAGE**: The language being learned (from `courseTitle`). Examples and exercises are in this language.\n- **NATIVE_LANGUAGE**: The learner's native language (from `language` code). Translations appear in this language.\n\n## Language Codes\n\n- `en`: US English\n- `pt`: Brazilian Portuguese\n- `es`: Latin American Spanish\n\n# Inductive Learning Principles\n\n## Why Pattern Discovery Works\n\nLearners who discover patterns themselves:\n\n- Remember the rule longer (active vs passive learning)\n- Understand WHY the rule exists, not just WHAT it is\n- Transfer the knowledge to new situations more effectively\n- Build confidence in their analytical abilities\n\n## How to Design Effective Examples\n\nYour examples must make the pattern obvious through contrast and consistency:\n\n- **Show the pattern clearly**: The grammar element should be visible in every example\n- **Highlight consistently**: Mark the same grammatical element in each sentence\n- **Use simple vocabulary**: The words should be familiar so focus stays on grammar\n- **Vary the content**: Different subjects, objects, or contexts - same grammatical structure\n- **Build progressively**: Start with the clearest case, then show variations\n\n## What Makes a Good Discovery Question\n\nThe question should test pattern recognition, not memorization:\n\n- Ask WHAT learners observed, not WHAT they remember\n- All options should be plausible observations about the examples\n- The correct answer identifies the core grammatical principle\n- Wrong answers should represent common misunderstandings or partial observations\n- Feedback should explain WHY each option is right or wrong\n\n# Examples Section\n\nProvide 3-4 sentences that clearly demonstrate the grammar pattern.\n\n## Example Design Rules\n\n- Each sentence must contain the target grammar pattern\n- Use level-appropriate vocabulary the learner likely knows\n- The `highlight` field must isolate the grammar element being taught\n- Sentences should be different enough to show the pattern applies broadly\n- Include translations so learners understand meaning while focusing on structure\n\n## What to Highlight\n\nThe highlight should isolate the grammatical element. Use a phrase (multiple words) when the grammar concept involves relationships between elements:\n\n- For verb conjugations: highlight the verb form (e.g., \"habla\", \"parle\", \"spricht\")\n- For word order: highlight the phrase showing position (e.g., \"geht er\" to show verb-subject inversion)\n- For particles: highlight the particle (e.g., \"wa\", \"ga\", \"ni\" in Japanese)\n- For agreement: highlight the ENTIRE agreeing phrase including BOTH elements - the noun/subject AND the adjective/modifier (e.g., \"la casa blanca\" not just \"blanca\", \"le petit chat\" not just \"petit\")\n- For tenses: highlight the verb with its tense marker\n\n**CRITICAL for agreement patterns**: When teaching gender/number agreement, learners must see WHAT is agreeing WITH WHAT. Always highlight both the trigger (noun) and the target (adjective/article) together as a single phrase. Highlighting only the adjective fails to show the agreement relationship.\n\n# Discovery Question\n\nCreate a multiple-choice question that asks learners to identify the pattern.\n\n## Question Design\n\n- Frame as \"What pattern do you notice?\" or \"What do these examples have in common?\"\n- Do NOT reveal the rule in the question itself\n- Test observation and analysis, not prior knowledge\n\n## Options Design\n\nProvide exactly 4 options with exactly 1 correct answer:\n\n- **Correct option**: Accurately describes the core pattern\n- **Distractor 1**: Describes a true but superficial observation (not the main pattern)\n- **Distractor 2**: Describes a common misconception about this grammar point\n- **Distractor 3**: Describes something that seems plausible but is incorrect\n\n## Feedback Design\n\nEach option needs feedback explaining:\n\n- For correct: Confirm the observation and briefly explain why it matters\n- For incorrect: Acknowledge what they observed but redirect to the key pattern\n\n# Rule Summary\n\nAfter the discovery question, confirm the pattern with a brief explanation.\n\n## Rule Summary Guidelines\n\n- Maximum 2 sentences\n- Confirm what learners already figured out - do not introduce new information\n- Use clear, simple language\n- Include the grammatical term if appropriate (e.g., \"This is called the present progressive\")\n- Do not over-explain - the discovery process already did the teaching\n\n**CRITICAL - No new information**: The rule summary must ONLY reference patterns, endings, or forms that were explicitly demonstrated in the Examples section. If your examples showed verb endings -o, -a, -amos, your summary can ONLY mention those endings. Do NOT add other forms like -as, -an even if they exist in the language - those would be new information not discoverable from the examples. The summary confirms what was shown, it does not complete the paradigm.\n\n# Practice Exercises\n\nProvide 2-3 fill-in-the-blank exercises that test the same pattern.\n\n## Exercise Design Rules\n\n- Each exercise has exactly ONE blank marked with `[BLANK]`\n- The blank tests the grammar point from the lesson\n- Use new sentences (not copies of the examples)\n- Include 1-3 correct answers (for cases with valid variations)\n- Include 2-4 distractors (plausible wrong options)\n- **CRITICAL**: Templates must contain ONLY the target language text and the `[BLANK]` placeholder. Do NOT include romanization, transliteration, or pronunciation guides in templates. Romanization belongs only in the `romanization` field of example sentences, never in exercise templates.\n\n## CRITICAL: The Blank Must Test the Actual Grammar Concept\n\n**The position and scope of [BLANK] must allow learners to make the mistake the grammar rule prevents.**\n\nAsk yourself: \"What error would a learner make without knowing this rule?\" The blank must allow for that error.\n\n**Examples of correct blank design:**\n\n- **Conjugation patterns**: Blank replaces the verb form. Options test different conjugations.\n  - Template: \"Yo [BLANK] espanol.\" Options: \"hablo\", \"habla\", \"hablan\"\n  - This works because learners must choose the correct conjugation.\n\n- **Word order patterns** (e.g., German V2): Blank must encompass BOTH the verb AND adjacent element to test their relative order.\n  - Template: \"Morgen [BLANK] nach Hause.\" Options: \"geht er\", \"er geht\"\n  - This works because learners must choose the correct word ORDER, not just conjugation.\n  - BAD: \"Morgen [BLANK] er nach Hause.\" with options \"geht/gehen\" - this only tests conjugation, not word order!\n\n- **Particle selection** (e.g., Korean subject markers): Blank replaces the particle after a noun.\n  - Template: \"학생[BLANK] 공부해요.\" Options: \"이\", \"가\"\n  - This works because learners must apply the consonant/vowel rule.\n\n- **Agreement patterns**: Blank replaces the element that must agree.\n  - Template: \"La maison est [BLANK].\" Options: \"grande\", \"grand\"\n  - This works because learners must match gender with the noun.\n\n**The key principle**: If your grammar concept is about the RELATIONSHIP or ORDER between elements, the blank must include enough elements to test that relationship.\n\n## Distractor Design\n\nGood distractors test common mistakes:\n\n- Wrong conjugation (e.g., wrong person or tense)\n- Wrong agreement (e.g., wrong gender or number)\n- Wrong word order placement\n- Wrong particle or preposition\n- Base form instead of conjugated form\n\n## Feedback Design\n\nExplain why the correct answer fits the pattern, reinforcing the rule.\n\n# Romanization (for non-Roman scripts)\n\nFor languages that use non-Roman writing systems (Japanese, Chinese, Korean, Arabic, Russian, Greek, Hebrew, Thai, Hindi, etc.), include romanization showing how the text is pronounced in Roman letters.\n\nUse the standard romanization system for each language:\n\n- **Japanese**: Romaji (e.g., 私は学生です → \"watashi wa gakusei desu\")\n- **Chinese**: Pinyin with tone marks (e.g., 我是学生 → \"wǒ shì xuesheng\")\n- **Korean**: Revised Romanization (e.g., 저는 학생입니다 → \"jeoneun haksaeng-imnida\")\n- **Russian**: ISO 9 or BGN/PCGN (e.g., Я студент → \"Ya student\")\n- **Arabic**: Standard romanization (e.g., أنا طالب → \"ana talib\")\n- **Greek**: Standard transliteration (e.g., Είμαι φοιτητής → \"Eimai foititis\")\n- **Thai**: Royal Thai General System (e.g., ฉันเป็นนักเรียน → \"chan pen nakrian\")\n- **Hindi**: IAST or Hunterian (e.g., मैं छात्र हूँ → \"main chhatr hoon\")\n\n**For languages using Roman letters** (Spanish, French, German, Portuguese, Italian, etc.), set `romanization` to an empty string `\"\"`.\n\n# Linguistic Accuracy Requirements\n\n## Factual Correctness in Explanations\n\nWhen explaining grammar rules, especially for non-Latin scripts, verify your linguistic claims are factually accurate:\n\n**For Korean**:\n\n- When explaining particle selection based on final consonants, correctly identify the actual final consonant/vowel\n- Example: 학생 (haksaeng) ends in the consonant ㅇ (ng sound), NOT ㄴ\n- Example: 사과 (sagwa) ends in a vowel ㅏ\n- The batchim (final consonant) is the bottom component of the final syllable block\n\n**For Japanese**:\n\n- Correctly identify readings (on'yomi vs kun'yomi) when relevant\n- The particle は is pronounced \"wa\" when marking topic, not \"ha\"\n\n**For Chinese**:\n\n- Ensure tone marks in pinyin are correct\n- Character stroke counts and radical identification must be accurate\n\n**General principle**: If your feedback references specific letters, sounds, or character components, double-check that the identification is correct. Learners trust your explanations - an error in linguistic analysis undermines the lesson even if the grammar rule itself is correctly taught.\n\n# Output Format\n\nReturn an object with this structure:\n\n```json\n{\n  \"ruleName\": \"Present Tense -ar Verb Conjugation\",\n  \"examples\": [\n    {\n      \"sentence\": \"Yo hablo español.\",\n      \"translation\": \"I speak Spanish.\",\n      \"romanization\": \"\",\n      \"highlight\": \"hablo\"\n    },\n    {\n      \"sentence\": \"Ella habla con su madre.\",\n      \"translation\": \"She speaks with her mother.\",\n      \"romanization\": \"\",\n      \"highlight\": \"habla\"\n    },\n    {\n      \"sentence\": \"Nosotros hablamos mucho.\",\n      \"translation\": \"We speak a lot.\",\n      \"romanization\": \"\",\n      \"highlight\": \"hablamos\"\n    }\n  ],\n  \"discovery\": {\n    \"question\": \"What pattern do you notice in the highlighted words?\",\n    \"options\": [\n      {\n        \"text\": \"The verb ending changes based on who is doing the action\",\n        \"isCorrect\": true,\n        \"feedback\": \"Correct! The verb 'hablar' changes its ending (-o, -a, -amos) to match the subject.\"\n      },\n      {\n        \"text\": \"All the sentences are about speaking\",\n        \"isCorrect\": false,\n        \"feedback\": \"That's true, but look more closely at the highlighted words. Notice how 'habl-' stays the same but the ending changes?\"\n      },\n      {\n        \"text\": \"Spanish verbs always end in -ar\",\n        \"isCorrect\": false,\n        \"feedback\": \"Not all Spanish verbs end in -ar. Focus on what changes in the highlighted words across the examples.\"\n      },\n      {\n        \"text\": \"The verb comes before the subject\",\n        \"isCorrect\": false,\n        \"feedback\": \"Word order varies in these examples. Look at the verb endings - what changes between hablo, habla, and hablamos?\"\n      }\n    ]\n  },\n  \"ruleSummary\": \"Spanish -ar verbs change their ending to match the subject: -o (yo), -a (ella), -amos (nosotros). This is called conjugation.\",\n  \"exercises\": [\n    {\n      \"template\": \"Tú [BLANK] muy bien.\",\n      \"answers\": [\"hablas\"],\n      \"distractors\": [\"habla\", \"hablo\", \"hablar\"],\n      \"feedback\": \"With 'tú' (you), -ar verbs use the ending '-as', giving us 'hablas'.\"\n    },\n    {\n      \"template\": \"Ellos [BLANK] en la oficina.\",\n      \"answers\": [\"trabajan\"],\n      \"distractors\": [\"trabaja\", \"trabajo\", \"trabajar\"],\n      \"feedback\": \"With 'ellos' (they), -ar verbs use the ending '-an', giving us 'trabajan'.\"\n    }\n  ]\n}\n```\n\n**Example for Japanese (non-Roman script) - romanization included:**\n\n```json\n{\n  \"ruleName\": \"Topic Marker は (wa)\",\n  \"examples\": [\n    {\n      \"sentence\": \"私は学生です。\",\n      \"translation\": \"I am a student.\",\n      \"romanization\": \"watashi wa gakusei desu.\",\n      \"highlight\": \"は\"\n    },\n    {\n      \"sentence\": \"これは本です。\",\n      \"translation\": \"This is a book.\",\n      \"romanization\": \"kore wa hon desu.\",\n      \"highlight\": \"は\"\n    },\n    {\n      \"sentence\": \"田中さんは先生です。\",\n      \"translation\": \"Mr. Tanaka is a teacher.\",\n      \"romanization\": \"Tanaka-san wa sensei desu.\",\n      \"highlight\": \"は\"\n    }\n  ],\n  \"discovery\": {\n    \"question\": \"What do you notice about は in these sentences?\",\n    \"options\": [\n      {\n        \"text\": \"は marks the topic - what the sentence is about\",\n        \"isCorrect\": true,\n        \"feedback\": \"Correct! は (wa) marks the topic of the sentence - the thing being described or discussed.\"\n      },\n      {\n        \"text\": \"は means 'is' in Japanese\",\n        \"isCorrect\": false,\n        \"feedback\": \"Actually, 'です' (desu) means 'is'. Look at where は appears - it comes right after the topic being discussed.\"\n      },\n      {\n        \"text\": \"は is always pronounced 'ha'\",\n        \"isCorrect\": false,\n        \"feedback\": \"When used as a particle, は is pronounced 'wa', not 'ha'. Focus on what role it plays in the sentence structure.\"\n      },\n      {\n        \"text\": \"は only appears at the end of sentences\",\n        \"isCorrect\": false,\n        \"feedback\": \"Notice that は appears in the middle of each sentence, right after the subject. It connects the topic to what's being said about it.\"\n      }\n    ]\n  },\n  \"ruleSummary\": \"The particle は (wa) marks the topic of a sentence - the thing you're talking about. It comes directly after the topic.\",\n  \"exercises\": [\n    {\n      \"template\": \"猫[BLANK]かわいいです。\",\n      \"answers\": [\"は\"],\n      \"distractors\": [\"が\", \"を\", \"に\"],\n      \"feedback\": \"We use は to mark 'cat' as the topic we're describing as cute.\"\n    },\n    {\n      \"template\": \"あなた[BLANK]だれですか。\",\n      \"answers\": [\"は\"],\n      \"distractors\": [\"が\", \"を\", \"の\"],\n      \"feedback\": \"は marks 'you' as the topic of the question 'who are you?'\"\n    }\n  ]\n}\n```\n\n# Quality Requirements\n\n1. **Examples must teach without explaining**: The pattern should be discoverable from the examples alone. If you need to explain it in the examples, they're not clear enough.\n\n2. **One grammar point per activity**: Focus on a single, clear grammatical concept. Do not mix multiple rules.\n\n3. **Progressive difficulty**: Examples should be straightforward; exercises can be slightly more challenging.\n\n4. **Consistent highlighting**: Always highlight the same type of element across all examples (the verb ending, the particle, the agreement marker, etc.).\n\n5. **Accurate linguistics**: Every example, translation, and explanation must be grammatically correct in both languages.\n\n6. **Level-appropriate vocabulary**: Use words the learner likely knows so they can focus on grammar, not vocabulary.\n\n7. **Exactly one blank per exercise**: Each fill-in-the-blank has exactly ONE `[BLANK]` placeholder.\n\n8. **Plausible distractors**: Wrong options should test real mistakes learners make, not obviously wrong choices.\n\n9. **Clear feedback**: Every option (correct and incorrect) needs feedback that helps learning.\n\n10. **Brief rule summary**: Maximum 2 sentences. The discovery process is the teaching - the summary just confirms.\n",
      "testCaseId": "es-korean-subject-marker-1",
      "userPrompt": "TARGET_LANGUAGE: Korean\nNATIVE_LANGUAGE: es\nCHAPTER_TITLE: Particulas Basicas\nLESSON_TITLE: Marcadores de Sujeto\nLESSON_DESCRIPTION: Los marcadores de sujeto coreanos 이 y 가 y como elegir cual usar segun la palabra\n\nGenerate a Pattern Discovery grammar activity for this lesson. Include 3-4 examples demonstrating the grammar pattern, a discovery question, a brief rule summary, and 2-3 fill-in-the-blank practice exercises."
    }
  ],
  "taskId": "activity-grammar"
}
