{
  "generatedAt": "2026-01-17T01:10:15.373Z",
  "modelId": "google/gemini-3-flash",
  "outputs": [
    {
      "duration": 13065.917584000003,
      "inputTokens": 2067,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"The process starts when a pathogen, like a virus or bacteria, breaks through your physical barriers. Whether it's a scrape on your skin or an inhaled droplet, the invader immediately begins to multiply, using your body's own resources to fuel its growth.\",\n      \"title\": \"The Breach Begins\"\n    },\n    {\n      \"text\": \"Watch as resident patrol cells, called macrophages, stumble upon the invaders. They don't just see them; they 'taste' them with chemical receptors. Once they realize these germs don't belong, they trip the silent alarm to alert the rest of the system.\",\n      \"title\": \"Sensing the Intruder\"\n    },\n    {\n      \"text\": \"The patrol cells release chemical signals called cytokines. Think of these like a radio distress call. This signal causes nearby blood vessels to expand and become 'leaky,' allowing fluid and a fresh wave of defenders to flood into the combat zone, causing visible swelling.\",\n      \"title\": \"Sending the Flare\"\n    },\n    {\n      \"text\": \"Specialized messenger cells gobble up a piece of the invader and rush to the nearest lymph node. They 'show' this piece to T-cells, effectively saying, 'Here is the exact blueprint of what we are fighting. We need a specific weapon for this.'\",\n      \"title\": \"Presenting the Evidence\"\n    },\n    {\n      \"text\": \"Once a matching T-cell is found, it triggers B-cells to start a massive production line. These cells turn into tiny factories, pumping out thousands of antibodies every second that are custom-designed to lock onto this specific invader's unique shape.\",\n      \"title\": \"Activating the Factory\"\n    },\n    {\n      \"text\": \"These antibodies flood the bloodstream, latching onto the pathogens like molecular magnets. By coating the invaders, they prevent them from entering your healthy cells and 'glue' them together in clumps, making them sitting ducks for the cleanup crew.\",\n      \"title\": \"Swarming the Enemy\"\n    },\n    {\n      \"text\": \"Scavenger cells move in to finish the job. They easily find the pathogens marked by antibodies and swallow them whole, digesting the remains. With the threat neutralized, the chemical signals stop, the inflammation fades, and the body begins to repair the damaged tissue.\",\n      \"title\": \"The Final Cleanup\"\n    }\n  ]\n}",
      "outputTokens": 1643,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-biology-immune-response-1",
      "userPrompt": "LESSON_TITLE: The Immune Response Process\nLESSON_DESCRIPTION: Understanding the step-by-step process of how the immune system detects, responds to, and eliminates pathogens\nCHAPTER_TITLE: Body Systems\nCOURSE_TITLE: Human Biology\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. The Cellular Army: White blood cells are specialized defenders in your bloodstream. Different types handle different tasks — some patrol, some remember, some attack directly.\n2. Antibody Recognition: Antibodies are Y-shaped proteins that act like molecular handcuffs. Each type fits one specific pathogen shape, marking it for destruction.\n3. Immune Memory: Memory cells are veterans that remember past invaders. They remain dormant for years, ready to rapidly respond if the same threat returns."
    },
    {
      "duration": 11339.628583000002,
      "inputTokens": 2063,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Watch as RNA polymerase searches the DNA. Once it finds the promoter, it clamps down tight like a key finding its lock. This physical connection is the 'go' signal that forces the DNA's tightly wound double helix to begin prying open, exposing the code inside.\",\n      \"title\": \"The Molecular Lock-On\"\n    },\n    {\n      \"text\": \"The polymerase acts like a high-speed zipper pull. As it moves forward, it breaks the weak bonds holding the DNA strands together, creating a 'transcription bubble.' This opening allows the machine to access the hidden instructions without damaging the original DNA.\",\n      \"title\": \"Unzipping the Helix\"\n    },\n    {\n      \"text\": \"Inside the bubble, the polymerase focuses on just one strand. It glides along, reading each base like a scanner. For every 'A' it sees on the DNA template, it prepares to grab a corresponding partner from the surrounding cellular soup to build the new message.\",\n      \"title\": \"Scanning the Template\"\n    },\n    {\n      \"text\": \"As the machine moves, it pulls in free-floating RNA nucleotides and snaps them together. Think of it like a rapid-fire assembly line where each new link is chemically glued to the one before it, forming a single-stranded mRNA ribbon that grows longer with every step.\",\n      \"title\": \"Assembling the RNA Chain\"\n    },\n    {\n      \"text\": \"Notice what happens behind the machine. As the polymerase passes, the DNA strands it just separated naturally find each other and zip back together into their original spiral. The original DNA remains unchanged, while the new RNA tail dangles out, ready for use.\",\n      \"title\": \"Zipping Up the Original\"\n    },\n    {\n      \"text\": \"Eventually, the machine hits a 'terminator' sequence. This isn't just a sign; it causes a physical shift that makes the polymerase lose its grip. The machine stalls, the finished mRNA is released, and the whole complex falls away, completing the copy.\",\n      \"title\": \"Hitting the Stop Sign\"\n    },\n    {\n      \"text\": \"The process leaves us with a fresh strand of mRNA floating free. It’s a perfect, portable copy of the gene’s instructions, ready to travel to the cell's protein factories while the master DNA stays safely protected in the nucleus.\",\n      \"title\": \"The Portable Blueprint\"\n    }\n  ]\n}",
      "outputTokens": 1364,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-biology-dna-transcription-1",
      "userPrompt": "LESSON_TITLE: DNA Transcription\nLESSON_DESCRIPTION: Understanding how genetic information flows from DNA to messenger RNA through the transcription process\nCHAPTER_TITLE: Molecular Biology\nCOURSE_TITLE: Cell Biology\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. The Transcription Machine: RNA polymerase is the molecular machine that reads DNA and builds RNA. It's a large protein complex that moves along the DNA strand.\n2. Start Signals: Promoters are special DNA sequences that signal 'start here.' They tell RNA polymerase exactly where to begin reading a gene.\n3. The Building Blocks: Nucleotides are the building blocks — A, U, G, C for RNA. Each matches a complementary base on the DNA template being read."
    },
    {
      "duration": 17702.852541999997,
      "inputTokens": 2078,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"When you hit Enter or click a link, your browser sets a relay race in motion. It takes the URL you typed and prepares to translate it into an actual digital location so it knows where to send the data.\",\n      \"title\": \"It Starts with a Click\"\n    },\n    {\n      \"text\": \"Before your request can travel, the browser needs an IP address. It queries a DNS server to find out exactly where the website lives on the internet, much like looking up a friend's physical address before heading to their house.\",\n      \"title\": \"Checking the Global Phonebook\"\n    },\n    {\n      \"text\": \"Your browser reaches out to the server with a 'Hello' signal. The server acknowledges, and your browser confirms back. This handshake ensures the connection is stable and secure before any real data starts flowing.\",\n      \"title\": \"The Handshake Connection\"\n    },\n    {\n      \"text\": \"Now the actual HTTP request is bundled up and sent. Watch as it travels through a series of routers and switches across the globe until it finally knocks on the server's virtual door, carrying your specific instructions.\",\n      \"title\": \"Launching the Request Package\"\n    },\n    {\n      \"text\": \"Once the request arrives, the server parses the incoming metadata and may talk to a database to fetch information. It's busy preparing the 'meal' you ordered, turning your request into a concrete result.\",\n      \"title\": \"Inside the Server's Kitchen\"\n    },\n    {\n      \"text\": \"The server packages the result into an HTTP response. This packet races back across the internet to your device, carrying the success or error signal and the actual content—like the code for the page you're trying to view.\",\n      \"title\": \"Delivering the Payload\"\n    },\n    {\n      \"text\": \"As the data arrives, your browser begins the final step: rendering. It reads the code and turns raw text and symbols into the buttons, images, and text you see on your screen. The cycle is complete.\",\n      \"title\": \"The Final Rendering\"\n    }\n  ]\n}",
      "outputTokens": 2349,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-cs-http-request-flow-1",
      "userPrompt": "LESSON_TITLE: The HTTP Request Lifecycle\nLESSON_DESCRIPTION: Understanding the complete lifecycle of an HTTP request from browser to server and back\nCHAPTER_TITLE: Web Protocols\nCOURSE_TITLE: Web Development Fundamentals\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Request Methods: HTTP methods define what action you want — GET retrieves data, POST sends data, PUT updates, DELETE removes. Each tells the server your intent.\n2. Response Codes: Status codes are three-digit responses from the server. 200 means success, 404 means not found, 500 means server error. They summarize what happened.\n3. Headers as Metadata: Headers carry metadata about the request and response — content type, authentication tokens, caching rules. They travel alongside the main data."
    },
    {
      "duration": 11432.508082999997,
      "inputTokens": 2055,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Imagine the heap filling up like an overstuffed closet. When a new object tries to squeeze in but there's no room, the runtime pauses execution and triggers a 'Stop the world' event. This pause ensures no data changes while the collector scans the room.\",\n      \"title\": \"Memory Pressure Triggers a Pause\"\n    },\n    {\n      \"text\": \"The collector begins at the roots—the active variables you're using right now. It paints these objects with a 'live' tag. It’s like a search party starting at a base camp, marking everyone they find as safe.\",\n      \"title\": \"Marking the Survivors\"\n    },\n    {\n      \"text\": \"The collector doesn't stop at the roots; it follows every reference inside those objects to find more data. It crawls through the heap like a spider web, tagging every connected piece of data. If an object can't be reached by this path, it is effectively invisible and 'dead.'\",\n      \"title\": \"Walking the Object Graph\"\n    },\n    {\n      \"text\": \"Once the marking is done, the collector sweeps through the memory. It ignores the tagged survivors and identifies the untagged gaps. These memory addresses are cleared and added back to a 'free list,' ready to host brand-new objects.\",\n      \"title\": \"Sweeping the Dead Space\"\n    },\n    {\n      \"text\": \"After sweeping, the heap can look like Swiss cheese—full of tiny, unusable holes. The collector slides the surviving objects together, packing them tightly at one end of the heap. This turns many small gaps into one large, continuous block of free memory.\",\n      \"title\": \"Compacting the Heap\"\n    },\n    {\n      \"text\": \"Because objects were moved during compaction, their physical addresses have changed. The collector performs a final pass, updating every reference in your code to point to the new locations, ensuring your program doesn't try to access a 'ghost' address.\",\n      \"title\": \"Relocating the Pointers\"\n    },\n    {\n      \"text\": \"To speed things up, the system assumes new objects die fast. It groups objects into generations. New objects are checked frequently; if they survive several cleanups, they are 'promoted' to an older generation that the collector visits much less often.\",\n      \"title\": \"Promoting the Survivors\"\n    }\n  ]\n}",
      "outputTokens": 1305,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-cs-garbage-collection-1",
      "userPrompt": "LESSON_TITLE: How Garbage Collection Works\nLESSON_DESCRIPTION: Understanding how automatic garbage collection identifies and reclaims unused memory in managed runtimes\nCHAPTER_TITLE: Memory Management\nCOURSE_TITLE: Programming Language Internals\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. The Heap: The heap is where dynamically allocated objects live. Unlike the stack, objects here persist until explicitly freed or garbage collected.\n2. Object References: References are pointers to objects in memory. When nothing references an object anymore, it becomes eligible for garbage collection.\n3. GC Roots: Root objects are the starting points — global variables, stack variables, CPU registers. Everything reachable from roots is considered alive."
    },
    {
      "duration": 12664.672625000003,
      "inputTokens": 2113,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Tudo começa quando a luz solar atinge o Fotossistema II. Imagine essa energia como uma faísca que agita os elétrons da clorofila. Eles ficam tão carregados que saltam da molécula, iniciando uma jornada elétrica pela membrana do tilacoide.\",\n      \"title\": \"O Despertar dos Elétrons\"\n    },\n    {\n      \"text\": \"Para o processo não parar, o sistema precisa repor os elétrons que saltaram. Ele faz isso quebrando moléculas de água! Observe como o oxigênio é liberado para o ar como um subproduto, enquanto os elétrons da água assumem o posto vago para manter a corrente fluindo.\",\n      \"title\": \"A Recarga pela Água\"\n    },\n    {\n      \"text\": \"Os elétrons viajam por uma cadeia de proteínas como em um revezamento. No caminho, a energia deles é usada para bombear prótons para dentro do tilacoide. Isso cria uma pressão interna enorme, como se estivéssemos enchendo uma represa biológica.\",\n      \"title\": \"A Cascata de Energia\"\n    },\n    {\n      \"text\": \"Ao chegarem no Fotossistema I, os elétrons já perderam força. Mas uma nova dose de luz solar os atinge, dando um segundo impulso de energia. Agora reenergizados, eles estão prontos para serem guardados em uma forma útil para a planta.\",\n      \"title\": \"O Segundo Impulso Solar\"\n    },\n    {\n      \"text\": \"No final da linha de transmissão, os elétrons são entregues ao NADP+. Veja como ele se transforma em NADPH ao recebê-los. Pense nisso como carregar uma bateria portátil que levará essa energia para produzir açúcar no futuro.\",\n      \"title\": \"Carregando as Baterias de NADPH\"\n    },\n    {\n      \"text\": \"Lembra daquela 'represa' de prótons? Eles agora escapam pela ATP sintase. Esse fluxo faz a proteína girar como uma turbina de hidrelétrica, gerando força para fabricar ATP. É o movimento físico dos prótons se transformando em combustível químico.\",\n      \"title\": \"O Giro da Turbina Molecular\"\n    }\n  ]\n}",
      "outputTokens": 1528,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "pt-biology-photosynthesis-light-1",
      "userPrompt": "LESSON_TITLE: Reacoes Luminosas da Fotossintese\nLESSON_DESCRIPTION: Entendendo como a fase clara da fotossintese converte energia luminosa em energia quimica atraves do transporte de eletrons\nCHAPTER_TITLE: Biologia Celular\nCOURSE_TITLE: Biologia Vegetal\nLANGUAGE: pt\nEXPLANATION_STEPS:\n1. Clorofila: A clorofila e o pigmento verde que captura luz. Ela absorve principalmente luz vermelha e azul, refletindo verde — por isso as plantas parecem verdes.\n2. Fotossistemas: Os fotossistemas sao complexos de proteinas nas membranas dos tilacoides. Fotossistema I e II trabalham juntos para capturar energia luminosa.\n3. ATP Sintase: A ATP sintase e uma turbina molecular que produz ATP. Ela usa o gradiente de protons para fosforilar ADP em ATP, a moeda energetica celular."
    },
    {
      "duration": 11232.391499999998,
      "inputTokens": 2101,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Todo comienza cuando el mercado abre y se lanza un precio inicial. Imagina a los vendedores colocando etiquetas en sus productos y a los compradores observando. Este primer precio es solo un punto de partida para que ambas partes comiencen a interactuar.\",\n      \"title\": \"El Mercado Entra en Acción\"\n    },\n    {\n      \"text\": \"Si el precio es muy alto, notarás que los productos se quedan en los estantes. Los vendedores ven cómo su inventario se acumula y hay poco movimiento en las cajas. Hay más mercancía de la que la gente quiere llevarse a ese costo.\",\n      \"title\": \"La Señal del Exceso\"\n    },\n    {\n      \"text\": \"Para movilizar lo que no se vende, los comerciantes comienzan a bajar los precios. Observa cómo este descenso actúa como un imán: personas que antes no podían comprar ahora se acercan, y el inventario estancado empieza a fluir de nuevo.\",\n      \"title\": \"Los Vendedores Ajustan el Rumbo\"\n    },\n    {\n      \"text\": \"Ahora imagina que el precio cae demasiado. Las estanterías se vacían en minutos y se forman filas de clientes frustrados. La demanda es tan alta que el producto desaparece antes de que otros puedan comprarlo, creando una escasez.\",\n      \"title\": \"La Alerta de la Escasez\"\n    },\n    {\n      \"text\": \"Al ver que el producto vuela, los compradores ansiosos ofrecen pagar un poco más para asegurar el suyo. Esta presión empuja el precio hacia arriba, indicando a los vendedores que deben traer más mercancía para satisfacer el hambre del mercado.\",\n      \"title\": \"La Competencia Sube la Apuesta\"\n    },\n    {\n      \"text\": \"El precio se mueve como un péndulo, oscilando hacia arriba y hacia abajo mediante prueba y error. Cada cambio en el precio envía un mensaje: 'falta producto' o 'sobra mercancía'. El mercado procesa estas señales constantemente para encontrar un equilibrio.\",\n      \"title\": \"El Tira y Afloja Constante\"\n    },\n    {\n      \"text\": \"El proceso culmina cuando el precio se detiene en un punto donde el ritmo de ventas iguala exactamente al de producción. Los estantes no están vacíos ni desbordados; el mercado ha 'descubierto' el precio que mantiene todo el sistema fluyendo en armonía.\",\n      \"title\": \"El Descubrimiento del Valor Real\"\n    }\n  ]\n}",
      "outputTokens": 1352,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "es-economics-price-discovery-1",
      "userPrompt": "LESSON_TITLE: El Proceso de Descubrimiento de Precios\nLESSON_DESCRIPTION: Entendiendo como los precios de mercado emergen de las interacciones entre compradores y vendedores\nCHAPTER_TITLE: Mercados y Precios\nCOURSE_TITLE: Economia Basica\nLANGUAGE: es\nEXPLANATION_STEPS:\n1. Curva de Oferta: La curva de oferta muestra cuanto produciran los vendedores a cada precio. Precios mas altos incentivan mayor produccion porque aumentan las ganancias potenciales.\n2. Curva de Demanda: La curva de demanda muestra cuanto compraran los consumidores a cada precio. Precios mas bajos aumentan la cantidad demandada porque el producto se vuelve mas accesible.\n3. Punto de Equilibrio: El equilibrio es el punto donde oferta y demanda se cruzan. A este precio, la cantidad que los vendedores quieren vender iguala lo que los compradores quieren comprar."
    },
    {
      "duration": 13891.784958,
      "inputTokens": 2082,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"The process begins when a single neutron strikes a heavy nucleus like Uranium-235. Think of it like a tiny marble hitting a large, unstable balloon. The nucleus absorbs the neutron, but this extra energy makes it oscillate violently until it can no longer hold itself together.\",\n      \"title\": \"The Initial Strike\"\n    },\n    {\n      \"text\": \"Watch as the nucleus stretches into a peanut shape and then snaps in two. This fission produces two smaller fragments, but more importantly, it kicks out two or three fresh neutrons. These new neutrons fly away at high speeds, ready to find their own targets.\",\n      \"title\": \"The Great Snap\"\n    },\n    {\n      \"text\": \"Now, the chain reaction takes flight. Each of those newly released neutrons strikes a neighboring nucleus, causing it to split and release even more neutrons. It’s like a single match starting a fire that spreads from one piece of wood to the next across the entire pile.\",\n      \"title\": \"The Multiplier Effect\"\n    },\n    {\n      \"text\": \"Fast-moving neutrons often zip right through nuclei without hitting anything. To keep the chain going, they must bounce off a 'moderator'—like water or graphite. This acts like a soft wall that slows them down, making them 'sticky' enough to be captured by the next nucleus.\",\n      \"title\": \"Slowing Down for Success\"\n    },\n    {\n      \"text\": \"In a power plant, we want a 'Critical' state. This is a perfect balance where each fission event leads to exactly one more. Imagine a relay race where each runner passes the baton to just one person—the race continues indefinitely at a steady, predictable pace.\",\n      \"title\": \"Finding the Sweet Spot\"\n    },\n    {\n      \"text\": \"To stop the reaction from snowballing, we use control rods. These act like 'neutron sponges.' When lowered into the core, they soak up excess neutrons before they can hit more atoms. By moving these rods in and out, we can speed up or slow down the energy flow at will.\",\n      \"title\": \"Pulling the Brakes\"\n    },\n    {\n      \"text\": \"If every fission triggers two or more new ones without being stopped, the reaction grows exponentially. In a fraction of a second, millions of atoms split at once. Without the 'sponges' to catch the extra neutrons, the energy surge becomes a runaway explosion.\",\n      \"title\": \"The Runaway Surge\"\n    }\n  ]\n}",
      "outputTokens": 1664,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-physics-fission-chain-1",
      "userPrompt": "LESSON_TITLE: Nuclear Fission Chain Reactions\nLESSON_DESCRIPTION: Understanding how nuclear fission chain reactions start, propagate, and are controlled or allowed to run away\nCHAPTER_TITLE: Nuclear Physics\nCOURSE_TITLE: Modern Physics\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Fissile Materials: Fissile materials like U-235 have nuclei that split when struck by neutrons. Not all heavy elements are fissile — it depends on nuclear structure.\n2. Neutrons as Triggers: Neutrons are uncharged particles that can penetrate nuclei. When absorbed by fissile atoms, they destabilize the nucleus and trigger fission.\n3. Energy Release: Binding energy is the glue holding nuclei together. When fission occurs, some mass converts to energy according to E=mc2, releasing enormous power."
    },
    {
      "duration": 13063.205416,
      "inputTokens": 2056,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Imagine holding a magnet near a copper coil. While they both sit still, the electrons in the wire are dormant. The process only begins when you create movement—either by thrusting the magnet toward the coil or pulling it away. This motion is the 'trigger' that sets everything else in flight.\",\n      \"title\": \"The Spark of Motion\"\n    },\n    {\n      \"text\": \"As the magnet moves, its invisible magnetic field lines sweep across the wire like a comb through hair. Instead of just sitting there, these lines are now 'cutting' through the conductor. This change in the magnetic environment is what the wire reacts to.\",\n      \"title\": \"Sweeping the Field\"\n    },\n    {\n      \"text\": \"Inside the wire, electrons are sensitive to magnetic changes. As the field lines sweep past, they exert a physical force on the electrons. It is like a gust of wind suddenly blowing down a hallway, pushing everything in its path in one specific direction.\",\n      \"title\": \"Shoving the Electrons\"\n    },\n    {\n      \"text\": \"Because the electrons are being pushed simultaneously, they begin to flow through the wire in a unified stream. This is the moment induction happens: you haven't used a battery, but the moving magnetic field has successfully 'nudged' a current into existence.\",\n      \"title\": \"The Birth of a Current\"\n    },\n    {\n      \"text\": \"As the new current flows, it creates its own magnetic field. Interestingly, this new field always acts like a stubborn mule—it tries to push back against the magnet's movement. If you push the magnet in, the coil creates a field that tries to repel it, creating a magnetic tug-of-war.\",\n      \"title\": \"The Magnetic Tug-of-War\"\n    },\n    {\n      \"text\": \"Watch what happens when you move the magnet faster. The field lines cut through the wire at a higher frequency, giving the electrons a much more violent shove. The faster the movement, the more 'pressure' is created, resulting in a stronger surge of electricity.\",\n      \"title\": \"Velocity Equals Power\"\n    },\n    {\n      \"text\": \"The process concludes as the kinetic energy of your hand—the physical work of moving the magnet—is fully converted into electrical energy. You've effectively bridged the gap between mechanical motion and the power needed to light a bulb.\",\n      \"title\": \"Energy Transformed\"\n    }\n  ]\n}",
      "outputTokens": 1662,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-physics-electromagnetic-induction-1",
      "userPrompt": "LESSON_TITLE: Electromagnetic Induction\nLESSON_DESCRIPTION: Understanding how changing magnetic fields induce electric currents in conductors\nCHAPTER_TITLE: Electromagnetism\nCOURSE_TITLE: Physics Fundamentals\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Magnetic Flux: Magnetic flux measures how much magnetic field passes through a surface. It depends on field strength, area, and the angle between them.\n2. Induced EMF: EMF (electromotive force) is the voltage that drives current. In induction, changing magnetic flux creates this voltage without any battery.\n3. Faraday's Law: Faraday's law states that induced EMF equals the rate of change of magnetic flux. Faster changes produce larger voltages."
    },
    {
      "duration": 16347.988167,
      "inputTokens": 2101,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Imagine milhões de moléculas flutuando em alta velocidade. O processo começa quando um substrato colide com a enzima na orientação perfeita. É como se, em meio a uma multidão, duas peças de um quebra-cabeça finalmente se encontrassem e se conectassem no local exato.\",\n      \"title\": \"O Encontro de Precisão\"\n    },\n    {\n      \"text\": \"Assim que o substrato toca o sítio ativo, a enzima muda levemente sua forma. Esse \\\"ajuste induzido\\\" é como uma luva que se molda ao redor da mão. Esse aperto firme garante que o substrato esteja posicionado exatamente onde a química precisa acontecer para a reação fluir.\",\n      \"title\": \"O Abraço Molecular\"\n    },\n    {\n      \"text\": \"Agora a mágica acontece: a enzima tensiona e distorce as ligações químicas do substrato. Imagine esticar um elástico até quase arrebentar; a enzima coloca a molécula em um estado de estresse que torna as ligações muito mais fáceis de quebrar ou formar.\",\n      \"title\": \"Tensionando as Estruturas\"\n    },\n    {\n      \"text\": \"Com a resistência diminuída, a reação ocorre num piscar de olhos. Átomos são reorganizados e novas ligações surgem. O ambiente protegido dentro da enzima funciona como um catalisador que guia os elétrons para o caminho de menor esforço, completando a transformação.\",\n      \"title\": \"A Reação em Cadeia\"\n    },\n    {\n      \"text\": \"Uma vez transformados, os novos produtos perdem a afinidade com o sítio ativo. Como a forma deles mudou, o \\\"abraço\\\" da enzima relaxa e eles são expelidos. O encaixe que antes era perfeito agora não serve mais, e as novas moléculas são liberadas para o meio celular.\",\n      \"title\": \"Despedida dos Produtos\"\n    },\n    {\n      \"text\": \"A enzima termina o processo exatamente como começou: intacta e inalterada. Ela recupera sua forma original instantaneamente e já se abre para capturar o próximo substrato. É uma linha de montagem biológica incansável, processando milhares de moléculas por segundo.\",\n      \"title\": \"Reiniciando o Ciclo\"\n    }\n  ]\n}",
      "outputTokens": 1511,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "pt-chemistry-enzyme-catalysis-1",
      "userPrompt": "LESSON_TITLE: Como Enzimas Catalisam Reacoes\nLESSON_DESCRIPTION: Entendendo o processo molecular pelo qual enzimas catalisam reacoes bioquimicas\nCHAPTER_TITLE: Bioquimica\nCOURSE_TITLE: Quimica Organica\nLANGUAGE: pt\nEXPLANATION_STEPS:\n1. Sitio Ativo: O sitio ativo e a regiao da enzima onde a catalise acontece. Sua forma tridimensional complementa o substrato, permitindo ligacao especifica.\n2. Substratos: Substratos sao as moleculas que as enzimas transformam. Eles se ligam ao sitio ativo e passam pela reacao quimica catalisada.\n3. Energia de Ativacao: A energia de ativacao e a barreira energetica que as reacoes precisam superar. Enzimas reduzem essa barreira, acelerando reacoes milhoes de vezes."
    },
    {
      "duration": 11741.289166999999,
      "inputTokens": 2093,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Todo comienza cuando conectas la fuente de energía. Esta actúa como una bomba de electrones que succiona cargas del ánodo y las empuja con fuerza hacia el cátodo. Sin este 'empujón' externo, los componentes químicos se quedarían estáticos y sin reaccionar.\",\n      \"title\": \"La fuente de poder activa el sistema\"\n    },\n    {\n      \"text\": \"En cuanto los electrodos se cargan, los iones en la solución sienten el tirón eléctrico. Imagina una pista de baile donde todos se mueven a la vez: los cationes corren hacia el cátodo negativo, mientras los aniones se dirigen al ánodo positivo, ordenando el caos inicial.\",\n      \"title\": \"Los iones inician su migración\"\n    },\n    {\n      \"text\": \"Cuando los aniones tocan el ánodo, 'sueltan' sus electrones sobrantes. Observa cómo ocurre el cambio: al perder esos electrones, los iones se transforman en átomos neutros o moléculas, a menudo liberándose como burbujas de gas que suben a la superficie.\",\n      \"title\": \"El ánodo recolecta electrones\"\n    },\n    {\n      \"text\": \"Esos electrones liberados no se quedan quietos; viajan a través del cable externo hacia la batería y luego hacia el otro electrodo. Este flujo constante fuera del líquido es lo que permite que la reacción química no se detenga nunca.\",\n      \"title\": \"Los electrones viajan por el circuito\"\n    },\n    {\n      \"text\": \"En el otro extremo, los cationes que llegan al cátodo reclaman los electrones que vienen por el cable. Al capturarlos, se transforman. Puedes ver cómo un metal que estaba disuelto empieza a 'pegarse' al electrodo, creando una capa sólida y brillante.\",\n      \"title\": \"El cátodo entrega la carga\"\n    },\n    {\n      \"text\": \"Mientras la batería siga encendida, el ciclo continúa: los iones se mueven en el líquido y los electrones por el cable. La electricidad ha logrado separar sustancias que naturalmente estarían unidas, forzando una transformación química que no ocurriría por sí sola.\",\n      \"title\": \"La transformación química se completa\"\n    }\n  ]\n}",
      "outputTokens": 1413,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "es-chemistry-electrolysis-1",
      "userPrompt": "LESSON_TITLE: El Proceso de Electrolisis\nLESSON_DESCRIPTION: Entendiendo como la corriente electrica fuerza reacciones quimicas no espontaneas en celdas electroliticas\nCHAPTER_TITLE: Electroquimica\nCOURSE_TITLE: Quimica General\nLANGUAGE: es\nEXPLANATION_STEPS:\n1. Electrodos: Los electrodos son conductores que conectan el circuito externo con la solucion. El catodo es negativo y el anodo es positivo.\n2. Electrolitos: Los electrolitos son sustancias que se disocian en iones cuando se disuelven. Estos iones libres permiten que la corriente fluya a traves de la solucion.\n3. Iones: Los iones son atomos o moleculas con carga electrica. Los cationes tienen carga positiva, los aniones tienen carga negativa."
    },
    {
      "duration": 11741.346291999998,
      "inputTokens": 2056,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"It all starts when the central bank adjusts its policy rate. Think of this as the master thermostat for the economy. By raising or lowering this rate, they immediately change the cost for commercial banks to borrow cash overnight, setting a chain reaction in motion.\",\n      \"title\": \"The Central Bank Pulls the Lever\"\n    },\n    {\n      \"text\": \"As it becomes more expensive for banks to source funds, they pass those costs down the line. Watch as they adjust the interest rates on your credit cards, mortgages, and business loans. This 'interest rate channel' ensures that a single policy change reaches every local bank branch.\",\n      \"title\": \"Commercial Rates Follow Suit\"\n    },\n    {\n      \"text\": \"Higher rates act like a speed bump for the economy. Notice how families might delay buying a home or businesses might pause a factory expansion because the math on the loan no longer works. When borrowing costs rise, the incentive to spend drops and the incentive to save grows.\",\n      \"title\": \"Spending and Investing Slow Down\"\n    },\n    {\n      \"text\": \"The change also hits the stock and housing markets. As interest rates rise, investors often pull money out of riskier assets. When people see their retirement accounts or home values dip, they feel less wealthy and tighten their belts, even if they haven't lost any actual cash yet.\",\n      \"title\": \"The Wealth Effect Kicks In\"\n    },\n    {\n      \"text\": \"If our rates are higher than other countries, global investors rush to buy our currency to earn that better return. This makes our currency 'stronger.' While this makes imported gadgets cheaper, it makes our exports more expensive for the rest of the world, cooling down the manufacturing sector.\",\n      \"title\": \"The Exchange Rate Ripple\"\n    },\n    {\n      \"text\": \"With less money flowing and lower demand for goods, businesses find it harder to raise prices. The 'fever' of inflation begins to break. The process is complete when the entire economy settles into a slower, more stable rhythm, and the central bank's target for price stability is reached.\",\n      \"title\": \"Prices Reach the New Equilibrium\"\n    }\n  ]\n}",
      "outputTokens": 1323,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-economics-monetary-transmission-1",
      "userPrompt": "LESSON_TITLE: Monetary Policy Transmission\nLESSON_DESCRIPTION: Understanding how central bank policy decisions transmit through the financial system to affect economic activity and inflation\nCHAPTER_TITLE: Macroeconomic Policy\nCOURSE_TITLE: Economics\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Policy Rate: The policy rate is the interest rate the central bank charges commercial banks. It serves as the baseline for all other rates in the economy.\n2. Reserve Requirements: Reserve requirements determine what fraction of deposits banks must hold. Lower requirements mean banks can lend more of their deposits.\n3. Open Market Operations: Open market operations involve buying and selling government bonds. Purchases inject money into the economy; sales withdraw it."
    },
    {
      "duration": 15166.132916000002,
      "inputTokens": 2061,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"The process starts when the compiler reads your source file. Like a sorting machine, the lexer scans characters and groups them into a stream of tokens. Watch as raw text is stripped of comments and whitespace, leaving only the essential units of the program ready for the next stage.\",\n      \"title\": \"The Scanner Ignites\"\n    },\n    {\n      \"text\": \"The parser takes that token stream and begins building the Abstract Syntax Tree (AST). Think of this as assembling a 3D structure from a flat list. It checks your code against grammar rules, snapping tokens into their proper hierarchical positions to represent the logical flow of the program.\",\n      \"title\": \"Assembling the Blueprint\"\n    },\n    {\n      \"text\": \"With the tree built, the compiler performs a logic check called semantic analysis. It traverses the AST to ensure every variable is declared and every type is compatible. Like a proofreader checking for plot holes, it ensures the 'meaning' of the code is valid before translation continues.\",\n      \"title\": \"The Logic Audit\"\n    },\n    {\n      \"text\": \"Once validated, the compiler transforms the AST into Intermediate Representation (IR). Watch as complex high-level structures are flattened into a simplified, linear sequence of instructions. This is the 'universal language' phase where the code is no longer source, but not yet machine code.\",\n      \"title\": \"Flattening the Tree\"\n    },\n    {\n      \"text\": \"The optimizer now hunts for inefficiencies. It rearranges instructions, eliminates redundant math, and pulls constant values out of loops. Think of this as a sculptor carving away excess marble, ensuring the final program runs as fast and lean as possible on the target hardware.\",\n      \"title\": \"Trimming the Fat\"\n    },\n    {\n      \"text\": \"In the final push, the backend maps the optimized IR to physical hardware instructions. It decides which CPU registers will store data and which machine-level commands to use. This is where the abstract logic finally touches the 'metal' of the specific processor you're targeting.\",\n      \"title\": \"Mapping to Metal\"\n    },\n    {\n      \"text\": \"The pipeline finishes by packaging these machine instructions into an executable file. Your human-readable ideas have been distilled through multiple layers of analysis and synthesis, resulting in a binary file that the computer can finally run at lightning speed.\",\n      \"title\": \"The Final Binary\"\n    }\n  ]\n}",
      "outputTokens": 1422,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-cs-compilation-pipeline-1",
      "userPrompt": "LESSON_TITLE: The Compilation Pipeline\nLESSON_DESCRIPTION: Understanding how compilers transform source code through multiple phases of analysis and synthesis\nCHAPTER_TITLE: Language Implementation\nCOURSE_TITLE: Compiler Design\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Tokens: Tokens are the smallest meaningful units of code — keywords, identifiers, operators, literals. The lexer breaks source code into this stream of tokens.\n2. Abstract Syntax Tree: The AST (Abstract Syntax Tree) represents code structure hierarchically. It captures how expressions nest and statements compose.\n3. Intermediate Representation: Intermediate representation (IR) is a platform-independent format. It's lower-level than the AST but higher-level than machine code."
    }
  ],
  "taskId": "activity-mechanics"
}
