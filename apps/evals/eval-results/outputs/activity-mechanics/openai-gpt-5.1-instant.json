{
  "generatedAt": "2026-01-17T01:15:18.903Z",
  "modelId": "openai/gpt-5.1-instant",
  "outputs": [
    {
      "duration": 6342.021249999991,
      "inputTokens": 2002,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"A pathogen slips past your barriers, and your body sounds an internal alarm. Think of it like a motion sensor going off — cells nearby send out distress signals that say, “Something doesn’t belong here!”\",\n      \"title\": \"Threat Triggers the Alarm\"\n    },\n    {\n      \"text\": \"Right away, first-responder cells rush in like emergency crews. They surround the intruder, take samples of its parts, and hold them up like clues for the rest of the system.\",\n      \"title\": \"Scouts Grab the Evidence\"\n    },\n    {\n      \"text\": \"Those clue-bearing cells travel to lymph nodes and present the pathogen’s “wanted poster.” Other immune cells crowd around, studying the shape to learn exactly what they’re up against.\",\n      \"title\": \"Clues Get Shared\"\n    },\n    {\n      \"text\": \"Once the match is made, activated cells start multiplying fast — like a factory switching into high-speed mode. Each new cell joins the fight with the same target in mind.\",\n      \"title\": \"Expansion of the Defense Force\"\n    },\n    {\n      \"text\": \"Now the attack unfolds. Some cells swarm the pathogen directly, while others launch chemical signals that guide teammates or raise the heat to slow the invader down.\",\n      \"title\": \"The Attack Ignites\"\n    },\n    {\n      \"text\": \"Marked invaders get swarmed and broken apart, piece by piece. It’s like a cleanup crew dismantling a dangerous machine until nothing harmful is left.\",\n      \"title\": \"Invaders Get Taken Down\"\n    },\n    {\n      \"text\": \"With the threat gone, signals shift from attack mode to shutdown. Fighter cells die off or retreat, inflammation fades, and your system returns to calm — ready for whatever comes next.\",\n      \"title\": \"System Winds Down\"\n    }\n  ]\n}",
      "outputTokens": 327,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-biology-immune-response-1",
      "userPrompt": "LESSON_TITLE: The Immune Response Process\nLESSON_DESCRIPTION: Understanding the step-by-step process of how the immune system detects, responds to, and eliminates pathogens\nCHAPTER_TITLE: Body Systems\nCOURSE_TITLE: Human Biology\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. The Cellular Army: White blood cells are specialized defenders in your bloodstream. Different types handle different tasks — some patrol, some remember, some attack directly.\n2. Antibody Recognition: Antibodies are Y-shaped proteins that act like molecular handcuffs. Each type fits one specific pathogen shape, marking it for destruction.\n3. Immune Memory: Memory cells are veterans that remember past invaders. They remain dormant for years, ready to rapidly respond if the same threat returns."
    },
    {
      "duration": 5853.009582999977,
      "inputTokens": 1997,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Watch RNA polymerase slide along the DNA like a scanner searching for the right barcode. When it spots the promoter, it locks on as if gripping a handle that says “start here.”\",\n      \"title\": \"Polymerase Locks Onto Start\"\n    },\n    {\n      \"text\": \"Once anchored, polymerase pries the DNA strands apart, creating a tiny open bubble. It’s like unzipping just enough of a jacket to reach inside—only the section it needs to read.\",\n      \"title\": \"The DNA Bubble Opens\"\n    },\n    {\n      \"text\": \"Polymerase now camps on the exposed template, matching incoming RNA nucleotides to each DNA base. Picture it as a conveyor belt: each DNA base cues the next RNA piece to snap into place.\",\n      \"title\": \"Nucleotides Snap Into Line\"\n    },\n    {\n      \"text\": \"As each match lands, polymerase fuses the new nucleotide to the growing RNA chain. It’s like stitching a thread—each new stitch extends the line forward.\",\n      \"title\": \"RNA Chain Extends\"\n    },\n    {\n      \"text\": \"The enzyme keeps sliding, continuously unzipping DNA ahead and sealing it behind. Imagine a zipper moving forward: open in front, closed right after it passes.\",\n      \"title\": \"Forward Motion Unzips and Re-zips\"\n    },\n    {\n      \"text\": \"Soon polymerase hits a DNA sequence that acts like a stop sign. This signal makes the enzyme release the finished RNA, letting it peel away like tape from a dispenser.\",\n      \"title\": \"Stop Signal Releases RNA\"\n    },\n    {\n      \"text\": \"With its job done, polymerase lifts off the DNA, which springs fully closed again. The completed mRNA strand drifts off, ready for its next journey in translation.\",\n      \"title\": \"Polymerase Detaches and Resets\"\n    }\n  ]\n}",
      "outputTokens": 344,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-biology-dna-transcription-1",
      "userPrompt": "LESSON_TITLE: DNA Transcription\nLESSON_DESCRIPTION: Understanding how genetic information flows from DNA to messenger RNA through the transcription process\nCHAPTER_TITLE: Molecular Biology\nCOURSE_TITLE: Cell Biology\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. The Transcription Machine: RNA polymerase is the molecular machine that reads DNA and builds RNA. It's a large protein complex that moves along the DNA strand.\n2. Start Signals: Promoters are special DNA sequences that signal 'start here.' They tell RNA polymerase exactly where to begin reading a gene.\n3. The Building Blocks: Nucleotides are the building blocks — A, U, G, C for RNA. Each matches a complementary base on the DNA template being read."
    },
    {
      "duration": 8358.658666999952,
      "inputTokens": 2002,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Picture your browser gearing up like a runner at the starting line. The moment you enter a URL or click a link, it fires off a signal saying, “Let’s go find this resource.”\",\n      \"title\": \"Browser Kicks Things Off\"\n    },\n    {\n      \"text\": \"Your browser first checks its DNS guidebook to translate the domain you typed into the server’s actual address. It’s like asking a directory, “Where should I send this request?”\",\n      \"title\": \"DNS Points the Browser\"\n    },\n    {\n      \"text\": \"Armed with the server’s address, the browser opens a TCP connection. Imagine it knocking and saying, “Can we talk?” The server opens the door when the handshake completes.\",\n      \"title\": \"Connection Handshake Begins\"\n    },\n    {\n      \"text\": \"Now the browser assembles the request like a neatly packed parcel—URL, method, headers, and body—and slides it across the connection toward the server.\",\n      \"title\": \"Request Gets Assembled and Sent\"\n    },\n    {\n      \"text\": \"The server receives the package and unboxes it. As it reads each piece, it decides what work to do—fetch a file, run code, pull from a database—whatever matches the request.\",\n      \"title\": \"Server Processes the Request\"\n    },\n    {\n      \"text\": \"Once the server gathers the results, it prepares a response. Think of it sealing a return package with status, headers, and content, then sending it back down the same channel.\",\n      \"title\": \"Response Gets Packed and Sent Back\"\n    },\n    {\n      \"text\": \"Your browser catches the response, reads the status, unpacks the content, and starts painting the page. If more files are needed, it fires off additional requests instantly.\",\n      \"title\": \"Browser Renders the Results\"\n    },\n    {\n      \"text\": \"When all communication is wrapped up, the browser and server close the connection. It’s like two parties nodding goodbye after a quick exchange.\",\n      \"title\": \"Connection Closes\"\n    }\n  ]\n}",
      "outputTokens": 391,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-cs-http-request-flow-1",
      "userPrompt": "LESSON_TITLE: The HTTP Request Lifecycle\nLESSON_DESCRIPTION: Understanding the complete lifecycle of an HTTP request from browser to server and back\nCHAPTER_TITLE: Web Protocols\nCOURSE_TITLE: Web Development Fundamentals\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Request Methods: HTTP methods define what action you want — GET retrieves data, POST sends data, PUT updates, DELETE removes. Each tells the server your intent.\n2. Response Codes: Status codes are three-digit responses from the server. 200 means success, 404 means not found, 500 means server error. They summarize what happened.\n3. Headers as Metadata: Headers carry metadata about the request and response — content type, authentication tokens, caching rules. They travel alongside the main data."
    },
    {
      "duration": 7178.230999999971,
      "inputTokens": 1985,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Picture the runtime pausing to scan from its roots like a lifeguard checking who’s still in the water. That pause triggers a full sweep to decide which objects stay in play.\",\n      \"title\": \"Runtime Triggers a Scan\"\n    },\n    {\n      \"text\": \"The collector walks outward from each root, tagging every object it can follow. It’s like tracing all the wires in a circuit, marking each connected component as active.\",\n      \"title\": \"GC Walks From the Roots\"\n    },\n    {\n      \"text\": \"Each tagged object points to others, and the collector follows those links. You can imagine a spotlight hopping from one object to the next, lighting up everything still in use.\",\n      \"title\": \"Marking Live Objects\"\n    },\n    {\n      \"text\": \"Unmarked objects sit there untouched, like forgotten packages in a warehouse. The collector notes them as safe to reclaim since nothing led it to them.\",\n      \"title\": \"Identifying the Unreachable\"\n    },\n    {\n      \"text\": \"Now the collector sweeps through the heap, clearing out the unmarked objects. Think of a cleanup crew rolling through aisles, tossing anything without a tag.\",\n      \"title\": \"Sweeping Away the Dead\"\n    },\n    {\n      \"text\": \"Some collectors shift surviving objects together, packing them tightly. Picture sliding books across a shelf to close gaps, leaving the memory space tidy and contiguous.\",\n      \"title\": \"Compacting What Remains\"\n    },\n    {\n      \"text\": \"Freed spaces merge into reusable blocks. It’s like clearing tables after a party so new guests can sit without rearranging the whole room.\",\n      \"title\": \"Reclaiming Free Space\"\n    },\n    {\n      \"text\": \"With space cleared and objects settled, the runtime resumes. Execution picks up exactly where it paused, now with fresh room for new allocations.\",\n      \"title\": \"Runtime Resumes Flow\"\n    },\n    {\n      \"text\": \"If objects keep getting created, another threshold triggers the cycle again. It’s a repeating rhythm: mark, sweep, compact, continue.\",\n      \"title\": \"Cycle Repeats on Demand\"\n    }\n  ]\n}",
      "outputTokens": 450,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-cs-garbage-collection-1",
      "userPrompt": "LESSON_TITLE: How Garbage Collection Works\nLESSON_DESCRIPTION: Understanding how automatic garbage collection identifies and reclaims unused memory in managed runtimes\nCHAPTER_TITLE: Memory Management\nCOURSE_TITLE: Programming Language Internals\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. The Heap: The heap is where dynamically allocated objects live. Unlike the stack, objects here persist until explicitly freed or garbage collected.\n2. Object References: References are pointers to objects in memory. When nothing references an object anymore, it becomes eligible for garbage collection.\n3. GC Roots: Root objects are the starting points — global variables, stack variables, CPU registers. Everything reachable from roots is considered alive."
    },
    {
      "duration": 8462.242749999976,
      "inputTokens": 2045,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Quando a luz atinge o tilacoide, pense nela como um estalo que desperta elétrons adormecidos. A energia chega de repente e empurra tudo para fora da inércia.\",\n      \"title\": \"Luz dispara o gatilho\"\n    },\n    {\n      \"text\": \"Veja os elétrons do fotossistema II saltarem como molas comprimidas que finalmente soltam. Esse salto cria o impulso inicial do fluxo eletrônico.\",\n      \"title\": \"Elétrons entram em movimento\"\n    },\n    {\n      \"text\": \"Assim que os elétrons escapam, a água é puxada para preencher a vaga. Ela se quebra como um copo de vidro rachando, liberando prótons e oxigênio.\",\n      \"title\": \"Água se divide para repor elétrons\"\n    },\n    {\n      \"text\": \"Os elétrons viajam pela cadeia de transporte como carrinhos descendo trilhos energizados. Cada parada libera energia que empurra prótons para dentro do tilacoide.\",\n      \"title\": \"Corrente eletrônica empurra prótons\"\n    },\n    {\n      \"text\": \"Com tantos prótons sendo acumulados, o interior do tilacoide vira uma sala superlotada. Essa pressão cria vontade de escapar, carregando energia potencial.\",\n      \"title\": \"Gradiente de prótons se intensifica\"\n    },\n    {\n      \"text\": \"Agora veja os elétrons chegando ao fotossistema I e recebendo outro impulso de luz, como se ganhassem um turbo para continuar adiante ainda mais energizados.\",\n      \"title\": \"Luz turbina os elétrons no PSI\"\n    },\n    {\n      \"text\": \"Os elétrons turbinados são entregues ao NADP+, que os abraça junto com um próton, virando NADPH. É como encher uma bateria portátil com carga recém-gerada.\",\n      \"title\": \"NADPH recebe a carga final\"\n    },\n    {\n      \"text\": \"A pressão interna finalmente encontra saída pela ATP sintase. Os prótons passam por ela como vento girando uma hélice, produzindo ATP na passagem.\",\n      \"title\": \"Prótons giram a turbina de ATP\"\n    },\n    {\n      \"text\": \"Quando os prótons se espalham e os elétrons chegam aos seus destinos, a fase clara encerra o ciclo: luz virou moléculas de ATP e NADPH prontas para alimentar a próxima etapa.\",\n      \"title\": \"Energia luminosa vira energia química\"\n    },\n    {\n      \"text\": \"Se a luz faltar, os elétrons não ganham impulso e o gradiente desmonta. Sem pressão e sem fluxo, ATP e NADPH deixam de ser produzidos.\",\n      \"title\": \"Quando o fluxo trava\"\n    }\n  ]\n}",
      "outputTokens": 511,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "pt-biology-photosynthesis-light-1",
      "userPrompt": "LESSON_TITLE: Reacoes Luminosas da Fotossintese\nLESSON_DESCRIPTION: Entendendo como a fase clara da fotossintese converte energia luminosa em energia quimica atraves do transporte de eletrons\nCHAPTER_TITLE: Biologia Celular\nCOURSE_TITLE: Biologia Vegetal\nLANGUAGE: pt\nEXPLANATION_STEPS:\n1. Clorofila: A clorofila e o pigmento verde que captura luz. Ela absorve principalmente luz vermelha e azul, refletindo verde — por isso as plantas parecem verdes.\n2. Fotossistemas: Os fotossistemas sao complexos de proteinas nas membranas dos tilacoides. Fotossistema I e II trabalham juntos para capturar energia luminosa.\n3. ATP Sintase: A ATP sintase e uma turbina molecular que produz ATP. Ela usa o gradiente de protons para fosforilar ADP em ATP, a moeda energetica celular."
    },
    {
      "duration": 6647.732874999987,
      "inputTokens": 2032,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Imagina que los compradores lanzan sus ofertas como si levantaran pancartas con lo máximo que están dispuestos a pagar. Ese gesto inicial abre el juego y marca el primer pulso del mercado.\",\n      \"title\": \"Las primeras señales de intención\"\n    },\n    {\n      \"text\": \"Los vendedores responden mostrando sus precios, como puestos ajustando sus carteles según el ánimo del público. Cada cambio en la demanda los empuja a recalibrar su propuesta.\",\n      \"title\": \"Los vendedores ajustan su postura\"\n    },\n    {\n      \"text\": \"A medida que ambas partes observan las señales del otro, van moviendo sus precios. Es un baile: si muchos quieren comprar, los precios suben; si pocos se animan, los precios bajan.\",\n      \"title\": \"El vaivén de ajustes continuos\"\n    },\n    {\n      \"text\": \"Con cada movimiento, compradores y vendedores se recalculan mutuamente. Un precio demasiado alto frena compras; uno muy bajo agota inventarios. Cada reacción empuja a la siguiente.\",\n      \"title\": \"Reacciones que encadenan más reacciones\"\n    },\n    {\n      \"text\": \"Después de varios intercambios, ambas partes empiezan a concentrarse alrededor de un precio que parece funcionar. Es como ver gente reunirse en un punto medio que se vuelve el lugar natural del trato.\",\n      \"title\": \"La convergencia hacia un punto común\"\n    },\n    {\n      \"text\": \"El precio que logra mantenerse sin generar colas ni escasez se estabiliza. En ese momento, el flujo se vuelve fluido: lo que quiere salir encuentra quien lo quiera, sin fricciones evidentes.\",\n      \"title\": \"La estabilización del flujo de intercambios\"\n    },\n    {\n      \"text\": \"Si aparece un evento externo —una noticia, un cambio en gustos, un costo inesperado— el equilibrio se sacude. Nuevas señales vuelan y el proceso se reinicia, buscando otra vez ajustarse.\",\n      \"title\": \"Cuando algo rompe el ritmo\"\n    }\n  ]\n}",
      "outputTokens": 384,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "es-economics-price-discovery-1",
      "userPrompt": "LESSON_TITLE: El Proceso de Descubrimiento de Precios\nLESSON_DESCRIPTION: Entendiendo como los precios de mercado emergen de las interacciones entre compradores y vendedores\nCHAPTER_TITLE: Mercados y Precios\nCOURSE_TITLE: Economia Basica\nLANGUAGE: es\nEXPLANATION_STEPS:\n1. Curva de Oferta: La curva de oferta muestra cuanto produciran los vendedores a cada precio. Precios mas altos incentivan mayor produccion porque aumentan las ganancias potenciales.\n2. Curva de Demanda: La curva de demanda muestra cuanto compraran los consumidores a cada precio. Precios mas bajos aumentan la cantidad demandada porque el producto se vuelve mas accesible.\n3. Punto de Equilibrio: El equilibrio es el punto donde oferta y demanda se cruzan. A este precio, la cantidad que los vendedores quieren vender iguala lo que los compradores quieren comprar."
    },
    {
      "duration": 10369.571874999965,
      "inputTokens": 2017,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Picture a lone neutron drifting until it smacks into a fissile nucleus. That hit jolts the nucleus into splitting, like a cracked log snapping apart after one good strike.\",\n      \"title\": \"A Neutron Strikes the First Spark\"\n    },\n    {\n      \"text\": \"As the nucleus breaks, pieces shoot out and several fresh neutrons burst free. It’s like smashing a piñata: debris flies in every direction, carrying energy and momentum.\",\n      \"title\": \"Fresh Neutrons Blast Out\"\n    },\n    {\n      \"text\": \"Those newborn neutrons race outward. If they’re moving too fast, they zip past other nuclei. Slow them down and suddenly they behave like sticky darts, hitting targets more easily.\",\n      \"title\": \"Neutrons Slow and Become Catchy\"\n    },\n    {\n      \"text\": \"When a slowed neutron hits another fissile nucleus, it triggers another split. Each success sends out more neutrons, which repeat the pattern. It’s dominoes—except each tile creates more tiles.\",\n      \"title\": \"The Domino Pattern Expands\"\n    },\n    {\n      \"text\": \"Now the system balances on a knife edge. If each fission produces, on average, one neutron that causes another fission, the reaction cruises steadily in place.\",\n      \"title\": \"Equal In, Equal Out\"\n    },\n    {\n      \"text\": \"But if more than one neutron from each fission finds a target, the reaction ramps up like a runaway crowd surge. Each moment packs more splits, more neutrons, more heat.\",\n      \"title\": \"Runaway Starts When Neutrons Multiply\"\n    },\n    {\n      \"text\": \"Control rods act like neutron sponges. Slide them deeper, and they soak up strays, slowing the chain. Pull them out, and neutrons roam freely, letting the reaction strengthen.\",\n      \"title\": \"Control Rods Apply the Brakes\"\n    },\n    {\n      \"text\": \"If materials are arranged poorly—too dense, too close, too reflective—neutrons bounce around until they all hit something. The chain reaction spikes, overwhelming any control.\",\n      \"title\": \"Critical Geometry Pushes It Over\"\n    },\n    {\n      \"text\": \"A stable system keeps neutron flow steady. A reactor meltdown or explosive event happens when the split‑and‑multiply rhythm accelerates faster than heat can escape.\",\n      \"title\": \"When Heat Outpaces Control\"\n    }\n  ]\n}",
      "outputTokens": 510,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-physics-fission-chain-1",
      "userPrompt": "LESSON_TITLE: Nuclear Fission Chain Reactions\nLESSON_DESCRIPTION: Understanding how nuclear fission chain reactions start, propagate, and are controlled or allowed to run away\nCHAPTER_TITLE: Nuclear Physics\nCOURSE_TITLE: Modern Physics\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Fissile Materials: Fissile materials like U-235 have nuclei that split when struck by neutrons. Not all heavy elements are fissile — it depends on nuclear structure.\n2. Neutrons as Triggers: Neutrons are uncharged particles that can penetrate nuclei. When absorbed by fissile atoms, they destabilize the nucleus and trigger fission.\n3. Energy Release: Binding energy is the glue holding nuclei together. When fission occurs, some mass converts to energy according to E=mc2, releasing enormous power."
    },
    {
      "duration": 8215.346250000002,
      "inputTokens": 1996,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Picture a magnetic field as invisible threads passing through a loop of wire. Everything is calm until something disturbs those threads — that shift is what kicks the whole process into motion.\",\n      \"title\": \"A Field Gets Disturbed\"\n    },\n    {\n      \"text\": \"Watch what happens when you move a magnet toward the loop. More field lines rush through it, like water flowing faster through a pipe. The loop senses this increase instantly.\",\n      \"title\": \"Magnet Motion Ramps Up Flux\"\n    },\n    {\n      \"text\": \"Now pull the magnet away. The field lines thin out, and the loop notices the drop. It doesn’t care about the magnet’s location — only how quickly the flux changes.\",\n      \"title\": \"Flux Falls and Signals Change\"\n    },\n    {\n      \"text\": \"As the flux shifts, the loop reacts by generating a voltage. It’s like a sudden push appears along the wire, urging charges to get moving.\",\n      \"title\": \"A Push Forms in the Wire\"\n    },\n    {\n      \"text\": \"The moment that push appears, charges begin to drift. You can imagine them like tiny beads sliding along a track, powered purely by the changing field.\",\n      \"title\": \"Charges Start Their Glide\"\n    },\n    {\n      \"text\": \"If another device is connected — a bulb, resistor, anything — the moving charges flow through it. The change in flux doesn’t just make voltage; it launches a whole circuit journey.\",\n      \"title\": \"Current Flows Through the Circuit\"\n    },\n    {\n      \"text\": \"Try flipping the magnet’s motion. Move it the opposite way, and watch the push flip direction too. The loop always pushes back against the change, like a tug-of-war with the flux shift.\",\n      \"title\": \"Direction Flips With the Motion\"\n    },\n    {\n      \"text\": \"Move the magnet faster and the whole response strengthens. It’s like shaking a rope harder — the wire feels a sharper change and produces a stronger push.\",\n      \"title\": \"Speeding Motion Boosts the Effect\"\n    },\n    {\n      \"text\": \"A flux that stays steady, even if huge, makes nothing happen. It’s like a perfectly calm lake — no ripples, no movement. Only changing conditions spark the induction.\",\n      \"title\": \"No Change, No Induction\"\n    }\n  ]\n}",
      "outputTokens": 417,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-physics-electromagnetic-induction-1",
      "userPrompt": "LESSON_TITLE: Electromagnetic Induction\nLESSON_DESCRIPTION: Understanding how changing magnetic fields induce electric currents in conductors\nCHAPTER_TITLE: Electromagnetism\nCOURSE_TITLE: Physics Fundamentals\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Magnetic Flux: Magnetic flux measures how much magnetic field passes through a surface. It depends on field strength, area, and the angle between them.\n2. Induced EMF: EMF (electromotive force) is the voltage that drives current. In induction, changing magnetic flux creates this voltage without any battery.\n3. Faraday's Law: Faraday's law states that induced EMF equals the rate of change of magnetic flux. Faster changes produce larger voltages."
    },
    {
      "duration": 8222.168708000041,
      "inputTokens": 2035,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Imagine a enzima “acordando” o processo: ela fica vibrando em solução até topar com um substrato compatível, como duas peças de quebra-cabeça que finalmente se esbarram.\",\n      \"title\": \"O Encontro Inicial\"\n    },\n    {\n      \"text\": \"Assim que o substrato se aproxima, pequenas partes flexíveis da enzima se ajustam como dedos moldando uma massa. Esse aperto progressivo trava o substrato na posição ideal.\",\n      \"title\": \"Ajuste que Aperta o Substrato\"\n    },\n    {\n      \"text\": \"Veja a enzima puxando ligações do substrato, aproximando átomos que precisam reagir e afastando os que atrapalham. É como empurrar reagentes para o ponto exato da faísca.\",\n      \"title\": \"Reposicionamento Atômico\"\n    },\n    {\n      \"text\": \"Com tudo alinhado, a enzima cria um “atalho energético”. As tensões cobradas nas ligações funcionam como um empurrão, diminuindo o esforço necessário para a reação disparar.\",\n      \"title\": \"A Baixa da Barreira Energética\"\n    },\n    {\n      \"text\": \"A reação acontece num estalo: ligações antigas se rompem, novas se formam. A enzima atua como palco estável, segurando tudo enquanto a transformação se completa.\",\n      \"title\": \"A Transformação Química\"\n    },\n    {\n      \"text\": \"Agora os produtos já não “encaixam” direito. A enzima relaxa sua forma, soltando-os como uma pinça abrindo depois de moldar algo.\",\n      \"title\": \"Liberação dos Produtos\"\n    },\n    {\n      \"text\": \"Livre de produtos, a enzima volta ao formato inicial, pronta para encontrar outro substrato e repetir o ciclo sem se desgastar.\",\n      \"title\": \"Retorno ao Estado Inicial\"\n    },\n    {\n      \"text\": \"Se o pH muda demais ou a temperatura sobe muito, a enzima perde sua forma; é como dobrar uma chave até tortá‑la — ela já não consegue iniciar o ciclo.\",\n      \"title\": \"Quando o Fluxo Quebra\"\n    }\n  ]\n}",
      "outputTokens": 410,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "pt-chemistry-enzyme-catalysis-1",
      "userPrompt": "LESSON_TITLE: Como Enzimas Catalisam Reacoes\nLESSON_DESCRIPTION: Entendendo o processo molecular pelo qual enzimas catalisam reacoes bioquimicas\nCHAPTER_TITLE: Bioquimica\nCOURSE_TITLE: Quimica Organica\nLANGUAGE: pt\nEXPLANATION_STEPS:\n1. Sitio Ativo: O sitio ativo e a regiao da enzima onde a catalise acontece. Sua forma tridimensional complementa o substrato, permitindo ligacao especifica.\n2. Substratos: Substratos sao as moleculas que as enzimas transformam. Eles se ligam ao sitio ativo e passam pela reacao quimica catalisada.\n3. Energia de Ativacao: A energia de ativacao e a barreira energetica que as reacoes precisam superar. Enzimas reduzem essa barreira, acelerando reacoes milhoes de vezes."
    },
    {
      "duration": 8134.89383299998,
      "inputTokens": 2029,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Todo arranca cuando aplicas una corriente externa. Es como abrir una compuerta que empuja a los iones a moverse en direcciones que normalmente no elegirían por sí solos.\",\n      \"title\": \"La corriente enciende el motor\"\n    },\n    {\n      \"text\": \"Al llegar la corriente, los electrones empiezan a fluir hacia un electrodo y alejarse del otro, creando un “empuje” que obliga a los iones en solución a reorganizarse.\",\n      \"title\": \"El flujo de electrones empuja el sistema\"\n    },\n    {\n      \"text\": \"Observa cómo los iones positivos sienten la atracción del electrodo cargado negativamente y comienzan a desplazarse hacia él, como limaduras de hierro corriendo hacia un imán.\",\n      \"title\": \"Los iones positivos avanzan\"\n    },\n    {\n      \"text\": \"Mientras tanto, los iones negativos se mueven hacia el electrodo opuesto. Es un tráfico simultáneo: cada tipo de ion corre hacia donde la corriente le promete el intercambio que necesita.\",\n      \"title\": \"Los iones negativos contraatacan\"\n    },\n    {\n      \"text\": \"Cuando un ion alcanza su electrodo, ocurre el intercambio de electrones. Es como llegar a una ventanilla: el ion recibe o entrega electrones según lo que la corriente fuerza.\",\n      \"title\": \"La reacción ocurre en la superficie\"\n    },\n    {\n      \"text\": \"En ese instante, el ion cambia de identidad química: se reduce o se oxida, transformándose en un átomo, molécula o incluso un depósito sólido que queda adherido al electrodo.\",\n      \"title\": \"Transformaciones instantáneas\"\n    },\n    {\n      \"text\": \"Mientras las reacciones avanzan, la solución ajusta sus cargas. Nuevos iones se acomodan para reemplazar a los que reaccionaron, asegurando que el flujo continúe sin desequilibrarse.\",\n      \"title\": \"La solución se reorganiza\"\n    },\n    {\n      \"text\": \"Si la corriente se corta, todo se detiene. Los iones dejan de moverse con dirección forzada y las reacciones dejan de ocurrir; el sistema vuelve a un estado pasivo.\",\n      \"title\": \"El proceso se detiene sin corriente\"\n    },\n    {\n      \"text\": \"Si la intensidad es baja o el voltaje insuficiente, los iones no reciben el empuje necesario. Es como intentar mover un engranaje sin la fuerza mínima: nada reacciona.\",\n      \"title\": \"Cuando la fuerza no alcanza\"\n    }\n  ]\n}",
      "outputTokens": 479,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "es-chemistry-electrolysis-1",
      "userPrompt": "LESSON_TITLE: El Proceso de Electrolisis\nLESSON_DESCRIPTION: Entendiendo como la corriente electrica fuerza reacciones quimicas no espontaneas en celdas electroliticas\nCHAPTER_TITLE: Electroquimica\nCOURSE_TITLE: Quimica General\nLANGUAGE: es\nEXPLANATION_STEPS:\n1. Electrodos: Los electrodos son conductores que conectan el circuito externo con la solucion. El catodo es negativo y el anodo es positivo.\n2. Electrolitos: Los electrolitos son sustancias que se disocian en iones cuando se disuelven. Estos iones libres permiten que la corriente fluya a traves de la solucion.\n3. Iones: Los iones son atomos o moleculas con carga electrica. Los cationes tienen carga positiva, los aniones tienen carga negativa."
    },
    {
      "duration": 7979.984292000008,
      "inputTokens": 1988,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Picture the central bank nudging its policy rate. That tiny move is like tapping the first domino, sending a signal through money markets: borrowing just got cheaper or pricier.\",\n      \"title\": \"Central Bank Sets the Signal\"\n    },\n    {\n      \"text\": \"Money market traders react instantly, adjusting overnight lending rates. Watch these rates ripple outward, giving banks a new baseline for how costly it is to raise short‑term funds.\",\n      \"title\": \"Market Rates Shift in Response\"\n    },\n    {\n      \"text\": \"Banks now reprice loans and deposits. It’s like adjusting all the shelves in a store after a change in wholesale costs—mortgages, business loans, and savings rates all get reset.\",\n      \"title\": \"Banks Reprice Their Products\"\n    },\n    {\n      \"text\": \"As rates change, households and firms rethink their spending plans. Lower rates pull forward purchases and investments; higher rates push them back, like a traffic light switching colors.\",\n      \"title\": \"Borrowers Rethink Decisions\"\n    },\n    {\n      \"text\": \"With borrowing shifting, watch credit flow speed up or slow down. More lending acts like extra fuel for spending; less lending feels like easing off the accelerator.\",\n      \"title\": \"Credit Flows Adjust\"\n    },\n    {\n      \"text\": \"Changes in demand ripple through businesses. Higher demand prompts more hiring and production; weaker demand makes firms scale back. It’s a chain reaction from wallets to factories.\",\n      \"title\": \"Demand Moves Output and Jobs\"\n    },\n    {\n      \"text\": \"As demand rises or falls, prices start responding. Strong demand lets prices climb; soft demand pressures them down. Inflation begins to bend in the direction set by the earlier rate move.\",\n      \"title\": \"Prices React to Demand Shifts\"\n    },\n    {\n      \"text\": \"Through all this, expectations adjust. If people believe the central bank will keep inflation in check, their price‑setting and wage decisions align, reinforcing the policy’s impact.\",\n      \"title\": \"Expectations Lock In the Path\"\n    },\n    {\n      \"text\": \"Sometimes the chain slips—banks may be cautious, firms may delay, or households may ignore lower rates. Any weak link slows the whole transmission, muting the policy’s effect.\",\n      \"title\": \"Where the Transmission Can Falter\"\n    }\n  ]\n}",
      "outputTokens": 486,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-economics-monetary-transmission-1",
      "userPrompt": "LESSON_TITLE: Monetary Policy Transmission\nLESSON_DESCRIPTION: Understanding how central bank policy decisions transmit through the financial system to affect economic activity and inflation\nCHAPTER_TITLE: Macroeconomic Policy\nCOURSE_TITLE: Economics\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Policy Rate: The policy rate is the interest rate the central bank charges commercial banks. It serves as the baseline for all other rates in the economy.\n2. Reserve Requirements: Reserve requirements determine what fraction of deposits banks must hold. Lower requirements mean banks can lend more of their deposits.\n3. Open Market Operations: Open market operations involve buying and selling government bonds. Purchases inject money into the economy; sales withdraw it."
    },
    {
      "duration": 8944.02020800003,
      "inputTokens": 1987,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Picture the compiler waking up as soon as you hand it your source file. It takes that raw text and prepares to run it through a series of filters, each one shaping the code a bit more.\",\n      \"title\": \"Source Text Kicks Things Off\"\n    },\n    {\n      \"text\": \"Watch the lexer glide over the text like a scanner reading barcodes. Each time it recognizes a meaningful pattern, it hands off a token, building a steady stream the next stage can consume.\",\n      \"title\": \"Lexer Streams Out Tokens\"\n    },\n    {\n      \"text\": \"As tokens arrive, the parser snaps them together like puzzle pieces. Every match reveals a new structure, and these nested structures grow upward into a full program tree.\",\n      \"title\": \"Parser Builds the Tree\"\n    },\n    {\n      \"text\": \"Now the tree gets examined like a blueprint under a bright lamp. Each node triggers checks—types are validated, names are resolved, and mismatches raise alarms before anything moves forward.\",\n      \"title\": \"Semantic Checks Light Up the AST\"\n    },\n    {\n      \"text\": \"Once the tree passes inspection, the compiler reshapes it into a more compact plan. Think of it as collapsing the blueprint into a clean, platform-neutral script that’s easier to optimize.\",\n      \"title\": \"Tree Folds Into IR\"\n    },\n    {\n      \"text\": \"Now the optimizer takes the IR for a workout. It trims redundancies, streamlines paths, and rearranges operations so the final result runs leaner and faster without changing meaning.\",\n      \"title\": \"Optimizer Refines the Flow\"\n    },\n    {\n      \"text\": \"With a polished IR, the compiler begins lowering it step-by-step. High‑level operations are broken into simpler moves, each one edging closer to what the hardware understands.\",\n      \"title\": \"Lowering Breaks Down Operations\"\n    },\n    {\n      \"text\": \"Instructions now get matched to the actual machine’s vocabulary. The compiler picks exact opcodes, allocates registers, and decides how values travel through the processor’s pathways.\",\n      \"title\": \"Backend Chooses Real Instructions\"\n    },\n    {\n      \"text\": \"Finally, everything gets lined up in binary form. It’s like packing all instructions into a tight byte-level container, ready to load straight into memory and execute.\",\n      \"title\": \"Machine Code Gets Packed\"\n    },\n    {\n      \"text\": \"If a step can’t continue—maybe a type doesn’t match or a name is missing—the pipeline halts. An error message gets sent back upstream, pointing to the earliest point things broke.\",\n      \"title\": \"Pipeline Halts When Checks Fail\"\n    }\n  ]\n}",
      "outputTokens": 552,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-cs-compilation-pipeline-1",
      "userPrompt": "LESSON_TITLE: The Compilation Pipeline\nLESSON_DESCRIPTION: Understanding how compilers transform source code through multiple phases of analysis and synthesis\nCHAPTER_TITLE: Language Implementation\nCOURSE_TITLE: Compiler Design\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Tokens: Tokens are the smallest meaningful units of code — keywords, identifiers, operators, literals. The lexer breaks source code into this stream of tokens.\n2. Abstract Syntax Tree: The AST (Abstract Syntax Tree) represents code structure hierarchically. It captures how expressions nest and statements compose.\n3. Intermediate Representation: Intermediate representation (IR) is a platform-independent format. It's lower-level than the AST but higher-level than machine code."
    }
  ],
  "taskId": "activity-mechanics"
}
