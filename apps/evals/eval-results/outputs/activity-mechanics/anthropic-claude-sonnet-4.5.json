{
  "generatedAt": "2026-01-17T01:14:16.433Z",
  "modelId": "anthropic/claude-sonnet-4.5",
  "outputs": [
    {
      "duration": 16443.08270899998,
      "inputTokens": 2417,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"A pathogen — bacteria, virus, or parasite — breaches your skin or mucus barriers. Like an intruder breaking into a building, it's now inside tissue where it shouldn't be.\",\n      \"title\": \"The Breach\"\n    },\n    {\n      \"text\": \"Local tissue cells detect something foreign and immediately release chemical alarm signals. Think of it like a smoke detector going off — the alert spreads through nearby tissue.\",\n      \"title\": \"Sounding the Alarm\"\n    },\n    {\n      \"text\": \"Those chemical signals reach nearby blood vessels, making their walls stickier and more porous. It's like opening emergency exits — white blood cells can now squeeze through vessel walls into infected tissue.\",\n      \"title\": \"Opening the Gates\"\n    },\n    {\n      \"text\": \"Neutrophils arrive first, rushing to the scene within minutes. They engulf pathogens directly, sacrificing themselves in the process. Their dead bodies create the pus you see in infections.\",\n      \"title\": \"First Responders Attack\"\n    },\n    {\n      \"text\": \"Macrophages arrive next and start devouring pathogens and debris. As they consume invaders, they display pathogen fragments on their surface like showing evidence to detectives.\",\n      \"title\": \"Cleanup Crew Reports In\"\n    },\n    {\n      \"text\": \"Those displayed fragments activate helper T cells, which read the evidence and determine what type of threat this is. They're like coordinators deciding which specialized units to deploy.\",\n      \"title\": \"Identifying the Enemy\"\n    },\n    {\n      \"text\": \"Helper T cells release signals that multiply specific B cells and killer T cells. The immune system is now mass-producing the exact weapons needed for this particular invader.\",\n      \"title\": \"Calling Reinforcements\"\n    },\n    {\n      \"text\": \"B cells transform into antibody factories, pumping out millions of Y-shaped proteins that fit this pathogen perfectly. These antibodies flood the bloodstream, searching for matching targets.\",\n      \"title\": \"Manufacturing Missiles\"\n    },\n    {\n      \"text\": \"Antibodies lock onto pathogens wherever they find them, marking them with molecular tags. Tagged invaders can't hide — they're now visible targets for roaming macrophages and other killers.\",\n      \"title\": \"Tagging the Targets\"\n    },\n    {\n      \"text\": \"Killer T cells hunt down infected body cells by reading surface signals. When they find cells hijacked by the pathogen, they inject toxic chemicals that trigger the infected cell to self-destruct.\",\n      \"title\": \"Destroying Compromised Cells\"\n    },\n    {\n      \"text\": \"As pathogens get eliminated, the threat level drops. Chemical signals shift from \\\"attack\\\" to \\\"stand down,\\\" and most immune cells die off or return to their patrol routes.\",\n      \"title\": \"Winding Down\"\n    },\n    {\n      \"text\": \"A small population of memory B and T cells survives, each coded to recognize this specific pathogen. They circulate quietly for years, ready to trigger a rapid response if this invader ever returns.\",\n      \"title\": \"Setting the Guard\"\n    }\n  ]\n}",
      "outputTokens": 602,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-biology-immune-response-1",
      "userPrompt": "LESSON_TITLE: The Immune Response Process\nLESSON_DESCRIPTION: Understanding the step-by-step process of how the immune system detects, responds to, and eliminates pathogens\nCHAPTER_TITLE: Body Systems\nCOURSE_TITLE: Human Biology\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. The Cellular Army: White blood cells are specialized defenders in your bloodstream. Different types handle different tasks — some patrol, some remember, some attack directly.\n2. Antibody Recognition: Antibodies are Y-shaped proteins that act like molecular handcuffs. Each type fits one specific pathogen shape, marking it for destruction.\n3. Immune Memory: Memory cells are veterans that remember past invaders. They remain dormant for years, ready to rapidly respond if the same threat returns."
    },
    {
      "duration": 12207.638291999989,
      "inputTokens": 2411,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"The process kicks off when RNA polymerase lands on a promoter sequence. Picture a train pulling up to the exact station marked 'start' — the enzyme knows this is where the gene begins.\",\n      \"title\": \"Landing at the Start Signal\"\n    },\n    {\n      \"text\": \"RNA polymerase grabs onto the DNA double helix and pulls the two strands apart, creating a bubble. It's like unzipping a zipper to expose the hidden code inside.\",\n      \"title\": \"Unzipping the DNA\"\n    },\n    {\n      \"text\": \"As the bubble opens, one DNA strand becomes the template — the strand that will be read. The other strand just hangs out, temporarily ignored during this process.\",\n      \"title\": \"Choosing the Reading Strand\"\n    },\n    {\n      \"text\": \"RNA polymerase reads the template strand and grabs matching RNA nucleotides from the surrounding soup. An A on DNA pairs with U in RNA, C pairs with G — the bases snap together.\",\n      \"title\": \"Reading and Matching\"\n    },\n    {\n      \"text\": \"Each new nucleotide clicks onto the growing RNA chain like train cars coupling together. The RNA strand extends one letter at a time, building a complementary copy.\",\n      \"title\": \"Building the RNA Chain\"\n    },\n    {\n      \"text\": \"As RNA polymerase crawls forward, the DNA bubble moves with it. Behind the enzyme, the two DNA strands zip back together — the bubble slides along like a wave.\",\n      \"title\": \"The Moving Bubble\"\n    },\n    {\n      \"text\": \"The newly built RNA strand peels away from the DNA template as it emerges. Think of it like a ribbon unfurling from a spool — the RNA product separates while still being made.\",\n      \"title\": \"RNA Peels Off\"\n    },\n    {\n      \"text\": \"When RNA polymerase hits a terminator sequence, it's like reaching a 'stop' sign. The enzyme releases the completed RNA strand and lets go of the DNA.\",\n      \"title\": \"Hitting the Stop Signal\"\n    },\n    {\n      \"text\": \"The DNA strands fully zip back together, returning to their original double helix. The gene is intact and ready to be transcribed again whenever the cell needs more copies.\",\n      \"title\": \"DNA Reseals Itself\"\n    }\n  ]\n}",
      "outputTokens": 454,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-biology-dna-transcription-1",
      "userPrompt": "LESSON_TITLE: DNA Transcription\nLESSON_DESCRIPTION: Understanding how genetic information flows from DNA to messenger RNA through the transcription process\nCHAPTER_TITLE: Molecular Biology\nCOURSE_TITLE: Cell Biology\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. The Transcription Machine: RNA polymerase is the molecular machine that reads DNA and builds RNA. It's a large protein complex that moves along the DNA strand.\n2. Start Signals: Promoters are special DNA sequences that signal 'start here.' They tell RNA polymerase exactly where to begin reading a gene.\n3. The Building Blocks: Nucleotides are the building blocks — A, U, G, C for RNA. Each matches a complementary base on the DNA template being read."
    },
    {
      "duration": 17035.86929100001,
      "inputTokens": 2416,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"You type a URL and hit Enter. Your browser immediately springs into action, parsing the URL into pieces — the protocol (http://), the domain (example.com), and the path (/api/users). It knows where to go.\",\n      \"title\": \"The Journey Begins\"\n    },\n    {\n      \"text\": \"Your browser asks, 'What's the IP address for this domain?' It queries DNS servers like looking up a phone number in a directory. DNS responds: '93.184.216.34' — now your browser has coordinates.\",\n      \"title\": \"DNS Lookup\"\n    },\n    {\n      \"text\": \"Armed with the IP address, your browser opens a TCP connection to the server. Think of it like dialing a phone — three-way handshake ensures both sides are ready to communicate.\",\n      \"title\": \"Opening the Connection\"\n    },\n    {\n      \"text\": \"Your browser constructs the HTTP request — the method (GET), the path (/api/users), headers with details about itself. It's like filling out a form before handing it through a service window.\",\n      \"title\": \"Building the Request\"\n    },\n    {\n      \"text\": \"The request travels across the internet in packets, hopping through routers and networks. Each packet carries a piece of your request, all racing toward the destination server.\",\n      \"title\": \"Crossing the Network\"\n    },\n    {\n      \"text\": \"The server receives your request and reads it line by line. It checks the method, inspects headers, validates permissions. 'What are they asking for? Are they allowed?' The server decides how to respond.\",\n      \"title\": \"Server Processing\"\n    },\n    {\n      \"text\": \"The server executes your request — querying databases, running code, gathering files. If you requested user data, it fetches records. If you posted a form, it saves the information. Work happens.\",\n      \"title\": \"Generating the Response\"\n    },\n    {\n      \"text\": \"The server packages its response — status code (200 for success), headers describing what's coming, and the actual data (HTML, JSON, images). It's wrapped up like a reply letter ready to send back.\",\n      \"title\": \"Crafting the Reply\"\n    },\n    {\n      \"text\": \"The response travels back across the network to your browser. Packets flow in reverse, reassembling on arrival. Your browser receives the status code first — 200 means 'good news coming.'\",\n      \"title\": \"Return Journey\"\n    },\n    {\n      \"text\": \"Your browser reads the response headers to understand what arrived. 'Content-Type: application/json' tells it to expect JSON. 'Cache-Control' says whether to save a local copy for later.\",\n      \"title\": \"Interpreting the Response\"\n    },\n    {\n      \"text\": \"Finally, your browser processes the data. If it's HTML, it renders the page. If it's JSON, JavaScript code handles it. The content appears on your screen — the request lifecycle completes.\",\n      \"title\": \"Rendering the Result\"\n    },\n    {\n      \"text\": \"Behind the scenes, the TCP connection might stay open for a moment, ready for follow-up requests. Or it closes, handshake reversed. Either way, one complete request-response cycle just finished.\",\n      \"title\": \"Connection Cleanup\"\n    }\n  ]\n}",
      "outputTokens": 642,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-cs-http-request-flow-1",
      "userPrompt": "LESSON_TITLE: The HTTP Request Lifecycle\nLESSON_DESCRIPTION: Understanding the complete lifecycle of an HTTP request from browser to server and back\nCHAPTER_TITLE: Web Protocols\nCOURSE_TITLE: Web Development Fundamentals\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Request Methods: HTTP methods define what action you want — GET retrieves data, POST sends data, PUT updates, DELETE removes. Each tells the server your intent.\n2. Response Codes: Status codes are three-digit responses from the server. 200 means success, 404 means not found, 500 means server error. They summarize what happened.\n3. Headers as Metadata: Headers carry metadata about the request and response — content type, authentication tokens, caching rules. They travel alongside the main data."
    },
    {
      "duration": 14971.944791999995,
      "inputTokens": 2398,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"The program runs, creating objects in the heap. Some variables point to these objects, others get reassigned to new ones. As references shift, some objects become orphaned — nothing points to them anymore.\",\n      \"title\": \"Objects Become Orphaned\"\n    },\n    {\n      \"text\": \"The garbage collector pauses your program momentarily. Think of it like freezing time to take a census — who's alive, who's gone? The world stops so nothing changes during the survey.\",\n      \"title\": \"The World Freezes\"\n    },\n    {\n      \"text\": \"Starting from GC roots, the collector begins walking through memory like following a web of connections. It marks each object it can reach — \\\"You're alive, you're needed.\\\"\",\n      \"title\": \"Walking the Reference Graph\"\n    },\n    {\n      \"text\": \"From each marked object, it follows outgoing references to other objects. It's like a chain reaction — if A points to B, and B points to C, then C is reachable too. Mark them all.\",\n      \"title\": \"Chains Keep Objects Alive\"\n    },\n    {\n      \"text\": \"Some objects sit isolated in memory with no path leading to them. The collector passes by without marking them. They're unreachable dead weight — memory that's allocated but useless.\",\n      \"title\": \"Dead Objects Stay Unmarked\"\n    },\n    {\n      \"text\": \"Now the collector sweeps through the heap examining every object. Marked? Leave it alone. Unmarked? That's garbage — reclaim that memory and add it back to the free pool.\",\n      \"title\": \"The Sweep Removes Corpses\"\n    },\n    {\n      \"text\": \"Your program resumes exactly where it paused. The heap is cleaner now, freed space ready for new allocations. The cycle will repeat when memory pressure builds again.\",\n      \"title\": \"The World Unfreezes\"\n    },\n    {\n      \"text\": \"If too many objects survive, they get promoted to an \\\"older generation\\\" that's collected less frequently. Frequent survivors earn tenure — the collector assumes they'll stick around.\",\n      \"title\": \"Survivors Get Promoted\"\n    },\n    {\n      \"text\": \"When the heap fills up despite collection, the runtime requests more memory from the OS. But if the OS says no or limits are hit, you get an out-of-memory error — nowhere left to allocate.\",\n      \"title\": \"Running Out of Room\"\n    }\n  ]\n}",
      "outputTokens": 475,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-cs-garbage-collection-1",
      "userPrompt": "LESSON_TITLE: How Garbage Collection Works\nLESSON_DESCRIPTION: Understanding how automatic garbage collection identifies and reclaims unused memory in managed runtimes\nCHAPTER_TITLE: Memory Management\nCOURSE_TITLE: Programming Language Internals\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. The Heap: The heap is where dynamically allocated objects live. Unlike the stack, objects here persist until explicitly freed or garbage collected.\n2. Object References: References are pointers to objects in memory. When nothing references an object anymore, it becomes eligible for garbage collection.\n3. GC Roots: Root objects are the starting points — global variables, stack variables, CPU registers. Everything reachable from roots is considered alive."
    },
    {
      "duration": 33331.80245799999,
      "inputTokens": 2484,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Quan doafoto n incid e sobre aclorof ila noF otoss istemaII ,elae xcitaeletronsc omo umsoc o desol aquecen do água .Essesel etronsgan ham energia e\\\"pula m\\\"para um nível maisalt o.\",\n      \"title\": \"Aluza tinge aclo rofila\"\n    },\n    {\n      \"text\": \"Ose letro nsexc itado sdeixam aclorof ila,criando um\\\"buraco\\\".Par a preencher,amole cula divideág ua—libe rando oxigên io(que respiramos ),próto ns,eno voselétr ons.\",\n      \"title\": \"Águ a separt e\"\n    },\n    {\n      \"text\": \"Osel etronsenergi zado spassa mpo r umaca deia de transpor tadores,c omo umabola descend o escad as.C adasa lto libera energi a,bo mbeando próto nspa ra dentr o dotilac oide.\",\n      \"title\": \"Ele tron sdesce mapilha\"\n    },\n    {\n      \"text\": \"Ospr óton sacumu lado sdentro dotila coide criamu mpres são,comoar emumbalã o.Essa diferenç a decon centrações é aenergiaarmaz enada aguardan do serusa da.\",\n      \"title\": \"Pressã o aument a\"\n    },\n    {\n      \"text\": \" Oselet ronsch ega maoF otos sistemI, ondesã o novamentee xcitad osporluzDu plo impulso,du pla energi a—como umpul o alémnatra vessiaemumpar qued ediver sões.\",\n      \"title\": \"Segu nda excit ação\"\n    },\n    {\n      \"text\": \"Osel étronsuper energizado spassamp ara umaamolé culacha madaNADP+.Ela captur a2el étron se1pró ton, transformand o-seem NADPH—ocomb ustível queimpuls ionarapró ximaeta pa.\",\n      \"title\": \"Combust ível químicoform a-se\"\n    },\n    {\n      \"text\": \" Ospr ótonspres sionados fluempe la ATPsi ntase,comoág ua poru mahi droelétri ca.Agi ro damole culafor necee nergiap ara solder ADP efo sfat o,crian doAT P.\",\n      \"title\": \"Tur bina mole culargir a\"\n    },\n    {\n      \"text\": \"Quand o aluzes casse iaou afic aesc uro,osfo tosis temaspar am.Seme létronsex citado s,atra nsport ecea ssaeaprodução de ATePNA DPHint errompe—pro cesso congela do.\",\n      \"title\": \"Sem luztu dopár a\"\n    }\n  ]\n}",
      "outputTokens": 694,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "pt-biology-photosynthesis-light-1",
      "userPrompt": "LESSON_TITLE: Reacoes Luminosas da Fotossintese\nLESSON_DESCRIPTION: Entendendo como a fase clara da fotossintese converte energia luminosa em energia quimica atraves do transporte de eletrons\nCHAPTER_TITLE: Biologia Celular\nCOURSE_TITLE: Biologia Vegetal\nLANGUAGE: pt\nEXPLANATION_STEPS:\n1. Clorofila: A clorofila e o pigmento verde que captura luz. Ela absorve principalmente luz vermelha e azul, refletindo verde — por isso as plantas parecem verdes.\n2. Fotossistemas: Os fotossistemas sao complexos de proteinas nas membranas dos tilacoides. Fotossistema I e II trabalham juntos para capturar energia luminosa.\n3. ATP Sintase: A ATP sintase e uma turbina molecular que produz ATP. Ela usa o gradiente de protons para fosforilar ADP em ATP, a moeda energetica celular."
    },
    {
      "duration": 19483.994124999997,
      "inputTokens": 2488,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Un vendedor publica un producto a un precio inicial basándose en sus costos y ganancias esperadas. Es como poner un letrero con el precio y ver qué pasa.\",\n      \"title\": \"El vendedor abre con una oferta\"\n    },\n    {\n      \"text\": \"Los compradores ven el precio y evalúan si les conviene. Si está muy alto para su presupuesto o valor percibido, simplemente no compran. Su silencio es una señal.\",\n      \"title\": \"Los compradores responden con acción o silencio\"\n    },\n    {\n      \"text\": \"Si nadie compra, el vendedor nota que tiene inventario acumulándose. La falta de ventas le dice: \\\"Tu precio está por encima de lo que el mercado acepta.\\\"\",\n      \"title\": \"La falta de ventas envía un mensaje\"\n    },\n    {\n      \"text\": \"El vendedor baja el precio poco a poco, probando dónde empieza a generar interés. Cada ajuste es un experimento: ¿A este nivel hay compradores?\",\n      \"title\": \"El vendedor ajusta hacia abajo\"\n    },\n    {\n      \"text\": \"De repente, varios compradores aparecen al nuevo precio. El producto empieza a moverse del estante. El vendedor nota: \\\"A este nivel sí hay demanda.\\\"\",\n      \"title\": \"Aparecen los primeros compradores\"\n    },\n    {\n      \"text\": \"Si el producto se agota rápidamente, el vendedor se da cuenta de que dejó dinero sobre la mesa. Podría haber cobrado más y aún así vender todo.\",\n      \"title\": \"Las ventas rápidas revelan precio bajo\"\n    },\n    {\n      \"text\": \"En el siguiente ciclo, el vendedor sube un poco el precio. Observa si las ventas continúan o se detienen. Está buscando el punto óptimo.\",\n      \"title\": \"El vendedor prueba subir\"\n    },\n    {\n      \"text\": \"Otros vendedores observan estos movimientos. Si ven que alguien vende todo rápido a cierto precio, entran con ofertas similares. La competencia empieza a sincronizar precios.\",\n      \"title\": \"La competencia copia señales exitosas\"\n    },\n    {\n      \"text\": \"Mientras tanto, los compradores comparan ofertas entre vendedores. Si uno cobra mucho más que otros por lo mismo, pierde clientes. La competencia presiona precios hacia abajo.\",\n      \"title\": \"Los compradores comparan y disciplinan\"\n    },\n    {\n      \"text\": \"Con el tiempo, emerge un rango de precios donde la mayoría de las transacciones ocurren. Los vendedores venden casi todo su inventario sin sacrificar mucha ganancia.\",\n      \"title\": \"Converge hacia un rango estable\"\n    },\n    {\n      \"text\": \"Este precio emergente no fue decidido por nadie en particular. Surgió de miles de decisiones individuales de comprar o no comprar, subir o bajar precios.\",\n      \"title\": \"El precio descubierto es colectivo\"\n    },\n    {\n      \"text\": \"Si la demanda aumenta repentinamente (más compradores con más dinero), los vendedores notan que venden todo muy rápido y suben precios. El ciclo de descubrimiento se reinicia.\",\n      \"title\": \"Los cambios reinician el proceso\"\n    }\n  ]\n}",
      "outputTokens": 735,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "es-economics-price-discovery-1",
      "userPrompt": "LESSON_TITLE: El Proceso de Descubrimiento de Precios\nLESSON_DESCRIPTION: Entendiendo como los precios de mercado emergen de las interacciones entre compradores y vendedores\nCHAPTER_TITLE: Mercados y Precios\nCOURSE_TITLE: Economia Basica\nLANGUAGE: es\nEXPLANATION_STEPS:\n1. Curva de Oferta: La curva de oferta muestra cuanto produciran los vendedores a cada precio. Precios mas altos incentivan mayor produccion porque aumentan las ganancias potenciales.\n2. Curva de Demanda: La curva de demanda muestra cuanto compraran los consumidores a cada precio. Precios mas bajos aumentan la cantidad demandada porque el producto se vuelve mas accesible.\n3. Punto de Equilibrio: El equilibrio es el punto donde oferta y demanda se cruzan. A este precio, la cantidad que los vendedores quieren vender iguala lo que los compradores quieren comprar."
    },
    {
      "duration": 14449.021166999999,
      "inputTokens": 2434,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"A single neutron drifts into a U-235 nucleus. The nucleus absorbs it like catching a ball, but this extra mass makes it wobble violently — too unstable to hold together.\",\n      \"title\": \"The First Strike\"\n    },\n    {\n      \"text\": \"The wobbling nucleus can't sustain its shape. It stretches, pinches in the middle, and tears apart into two lighter fragments. It's like a water droplet vibrating so hard it splits in two.\",\n      \"title\": \"The Nucleus Splits\"\n    },\n    {\n      \"text\": \"As the nucleus rips apart, it ejects 2-3 free neutrons at high speed. These fly outward in random directions, each carrying enough energy to trigger more fissions if they hit other U-235 nuclei.\",\n      \"title\": \"Neutrons Fly Free\"\n    },\n    {\n      \"text\": \"Each ejected neutron races through the material. If one strikes another U-235 nucleus, that nucleus absorbs it and splits too — releasing its own burst of neutrons. One becomes two, two becomes four.\",\n      \"title\": \"The Chain Begins\"\n    },\n    {\n      \"text\": \"Watch the multiplication: each fission releases multiple neutrons, each capable of causing another split. If more than one neutron per fission goes on to trigger the next generation, the reaction grows exponentially.\",\n      \"title\": \"Exponential Growth\"\n    },\n    {\n      \"text\": \"In an uncontrolled reaction, billions of fissions cascade in microseconds. Each generation happens faster than the last — the energy release compounds so rapidly it becomes an explosion.\",\n      \"title\": \"Runaway Mode\"\n    },\n    {\n      \"text\": \"Control rods made of neutron-absorbing material slide between fuel elements. They capture flying neutrons before they can trigger new fissions, like nets catching baseballs mid-flight.\",\n      \"title\": \"Inserting the Brakes\"\n    },\n    {\n      \"text\": \"By adjusting how deep the control rods penetrate, operators tune the neutron population. Pull them out slightly and the reaction heats up. Push them in and it cools down — one fission per fission maintains steady power.\",\n      \"title\": \"Balancing the Chain\"\n    },\n    {\n      \"text\": \"If neutrons escape through the surface faster than fissions produce them, the chain dies out. A critical mass is the minimum size where enough neutrons stay inside to sustain the reaction.\",\n      \"title\": \"When Chains Die\"\n    }\n  ]\n}",
      "outputTokens": 500,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-physics-fission-chain-1",
      "userPrompt": "LESSON_TITLE: Nuclear Fission Chain Reactions\nLESSON_DESCRIPTION: Understanding how nuclear fission chain reactions start, propagate, and are controlled or allowed to run away\nCHAPTER_TITLE: Nuclear Physics\nCOURSE_TITLE: Modern Physics\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Fissile Materials: Fissile materials like U-235 have nuclei that split when struck by neutrons. Not all heavy elements are fissile — it depends on nuclear structure.\n2. Neutrons as Triggers: Neutrons are uncharged particles that can penetrate nuclei. When absorbed by fissile atoms, they destabilize the nucleus and trigger fission.\n3. Energy Release: Binding energy is the glue holding nuclei together. When fission occurs, some mass converts to energy according to E=mc2, releasing enormous power."
    },
    {
      "duration": 12921.719832999981,
      "inputTokens": 2411,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Picture a wire loop sitting peacefully in a magnetic field. Nothing happens — yet. The magnetic field passes through, but as long as everything stays still, no current flows. The stage is set.\",\n      \"title\": \"The Quiet Before\"\n    },\n    {\n      \"text\": \"Now move a magnet toward the loop. Watch as the magnetic flux through the loop starts increasing — more field lines pierce through the surface. This change is the trigger that sets everything in motion.\",\n      \"title\": \"Flux Starts Changing\"\n    },\n    {\n      \"text\": \"The changing flux jolts electrons in the wire awake. They feel a force pushing them to move. It's like the magnetic field change creates an invisible pressure that nudges charges along the wire.\",\n      \"title\": \"Electrons Feel the Push\"\n    },\n    {\n      \"text\": \"As electrons start drifting, they form a current circulating around the loop. No battery needed — the changing magnetic field itself becomes the power source driving this electron flow.\",\n      \"title\": \"Current Begins to Flow\"\n    },\n    {\n      \"text\": \"Here's the twist: the induced current creates its own magnetic field that opposes the change you're making. Move the magnet closer? The current fights back, trying to keep flux from increasing.\",\n      \"title\": \"Nature Pushes Back\"\n    },\n    {\n      \"text\": \"Pull the magnet away instead, and flux decreases. Now the induced current reverses direction, creating a field that tries to prevent the flux from dropping. The loop always resists change.\",\n      \"title\": \"Reversal on Retreat\"\n    },\n    {\n      \"text\": \"Speed matters tremendously. Yank the magnet quickly and electrons rush faster, creating larger current. Move it slowly and you get just a trickle. The rate of change controls current strength.\",\n      \"title\": \"Speed Sets the Current\"\n    },\n    {\n      \"text\": \"Stop moving the magnet entirely and everything halts. With flux steady again, the driving force vanishes. Electrons settle back down and current drops to zero. Motion creates electricity; stillness ends it.\",\n      \"title\": \"Motion or Nothing\"\n    }\n  ]\n}",
      "outputTokens": 418,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-physics-electromagnetic-induction-1",
      "userPrompt": "LESSON_TITLE: Electromagnetic Induction\nLESSON_DESCRIPTION: Understanding how changing magnetic fields induce electric currents in conductors\nCHAPTER_TITLE: Electromagnetism\nCOURSE_TITLE: Physics Fundamentals\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Magnetic Flux: Magnetic flux measures how much magnetic field passes through a surface. It depends on field strength, area, and the angle between them.\n2. Induced EMF: EMF (electromotive force) is the voltage that drives current. In induction, changing magnetic flux creates this voltage without any battery.\n3. Faraday's Law: Faraday's law states that induced EMF equals the rate of change of magnetic flux. Faster changes produce larger voltages."
    },
    {
      "duration": 14050.350666000013,
      "inputTokens": 2473,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Imagine o substrato flutuando pela celula ate encontrar sua enzima. Como uma chave procurando a fechadura certa, ele se aproxima do sitio ativo da enzima.\",\n      \"title\": \"O Encontro Inicial\"\n    },\n    {\n      \"text\": \"O substrato toca a superficie do sitio ativo. Forcas fracas - pontes de hidrogenio e interacoes eletricas - comecam a puxar o substrato para dentro, como imas se atraindo.\",\n      \"title\": \"Primeiras Interacoes\"\n    },\n    {\n      \"text\": \"A medida que o substrato entra, o sitio ativo muda de forma, abraçando-o perfeitamente. E o encaixe induzido - a enzima se molda ao redor do substrato como uma luva.\",\n      \"title\": \"Encaixe Perfeito\"\n    },\n    {\n      \"text\": \"Agora firmemente ligado, o substrato e distorcido. Suas ligacoes quimicas sao esticadas e torcidas, ficando instáveis - prontas para quebrar ou formar novas conexoes.\",\n      \"title\": \"Tensao Molecular\"\n    },\n    {\n      \"text\": \"A enzima posiciona grupos quimicos especificos bem ao lado das ligacoes do substrato. Esses grupos agem como facilitadores, empurrando eletrons e acelerando a quebra ou formacao de ligacoes.\",\n      \"title\": \"Catalise em Acao\"\n    },\n    {\n      \"text\": \"A barreira de energia que normalmente bloquearia a reacao desaparece - a enzima criou um atalho. A transformacao acontece: ligacoes quebram, novas se formam. O substrato vira produto.\",\n      \"title\": \"Transformacao Completa\"\n    },\n    {\n      \"text\": \"O produto, agora com forma diferente, nao se encaixa mais no sitio ativo. Como uma porta se abrindo, a enzima solta o produto que flutua para longe.\",\n      \"title\": \"Liberacao do Produto\"\n    },\n    {\n      \"text\": \"Livre novamente, o sitio ativo retorna a sua forma original. A enzima esta intacta, pronta para repetir todo o ciclo - pode catalisar milhoes de reacoes seguidas.\",\n      \"title\": \"Pronta para Recomecar\"\n    }\n  ]\n}",
      "outputTokens": 525,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "pt-chemistry-enzyme-catalysis-1",
      "userPrompt": "LESSON_TITLE: Como Enzimas Catalisam Reacoes\nLESSON_DESCRIPTION: Entendendo o processo molecular pelo qual enzimas catalisam reacoes bioquimicas\nCHAPTER_TITLE: Bioquimica\nCOURSE_TITLE: Quimica Organica\nLANGUAGE: pt\nEXPLANATION_STEPS:\n1. Sitio Ativo: O sitio ativo e a regiao da enzima onde a catalise acontece. Sua forma tridimensional complementa o substrato, permitindo ligacao especifica.\n2. Substratos: Substratos sao as moleculas que as enzimas transformam. Eles se ligam ao sitio ativo e passam pela reacao quimica catalisada.\n3. Energia de Ativacao: A energia de ativacao e a barreira energetica que as reacoes precisam superar. Enzimas reduzem essa barreira, acelerando reacoes milhoes de vezes."
    },
    {
      "duration": 14971.849833000015,
      "inputTokens": 2461,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Conectas una fuente de poder a los electrodos sumergidos en la solución. La corriente comienza a fluir, forzando a los electrones a moverse en una dirección específica, como bombear agua cuesta arriba.\",\n      \"title\": \"La corriente inicia el empuje\"\n    },\n    {\n      \"text\": \"Los iones en la solución sienten el campo eléctrico. Los cationes positivos son atraídos hacia el cátodo negativo, mientras los aniones negativos se mueven hacia el ánodo positivo, como imanes opuestos acercándose.\",\n      \"title\": \"Los iones migran en direcciones opuestas\"\n    },\n    {\n      \"text\": \"Los cationes llegan al cátodo y encuentran un exceso de electrones esperando. Cada catión captura los electrones que necesita, transformándose en átomos neutros que se depositan en el electrodo.\",\n      \"title\": \"Reducción en el cátodo\"\n    },\n    {\n      \"text\": \"En el ánodo, los aniones entregan sus electrones extra al electrodo. Al perder electrones, se oxidan y pueden formar gas, disolverse o crear nuevos compuestos, liberando su carga al circuito.\",\n      \"title\": \"Oxidación en el ánodo\"\n    },\n    {\n      \"text\": \"Los electrones fluyen desde el ánodo, a través del circuito externo, hasta el cátodo. Este flujo constante es como una cinta transportadora que mantiene el proceso en marcha sin detenerse.\",\n      \"title\": \"El circuito completa el ciclo\"\n    },\n    {\n      \"text\": \"Con el tiempo, ves cambios visibles: metal plateándose en el cátodo, burbujas de gas emergiendo del ánodo, o el color de la solución cambiando. La energía eléctrica se convierte en cambio químico.\",\n      \"title\": \"Los productos aparecen\"\n    },\n    {\n      \"text\": \"La cantidad de sustancia transformada depende directamente de cuánta corriente fluye y por cuánto tiempo. Más corriente o más tiempo significa más electrones transferidos y más producto formado.\",\n      \"title\": \"La cantidad controla el resultado\"\n    },\n    {\n      \"text\": \"Si apagas la corriente, todo se detiene inmediatamente. Sin el empuje eléctrico forzando las reacciones, los iones vuelven a moverse aleatoriamente y el proceso no espontáneo se congela.\",\n      \"title\": \"Sin corriente, sin reacción\"\n    }\n  ]\n}",
      "outputTokens": 565,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "es-chemistry-electrolysis-1",
      "userPrompt": "LESSON_TITLE: El Proceso de Electrolisis\nLESSON_DESCRIPTION: Entendiendo como la corriente electrica fuerza reacciones quimicas no espontaneas en celdas electroliticas\nCHAPTER_TITLE: Electroquimica\nCOURSE_TITLE: Quimica General\nLANGUAGE: es\nEXPLANATION_STEPS:\n1. Electrodos: Los electrodos son conductores que conectan el circuito externo con la solucion. El catodo es negativo y el anodo es positivo.\n2. Electrolitos: Los electrolitos son sustancias que se disocian en iones cuando se disuelven. Estos iones libres permiten que la corriente fluya a traves de la solucion.\n3. Iones: Los iones son atomos o moleculas con carga electrica. Los cationes tienen carga positiva, los aniones tienen carga negativa."
    },
    {
      "duration": 18244.226250000007,
      "inputTokens": 2396,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"The central bank announces a policy rate change — say, lowering it by 0.5%. This is the spark that sets everything in motion, like flipping the first domino in a long chain.\",\n      \"title\": \"The Central Bank Moves First\"\n    },\n    {\n      \"text\": \"Commercial banks immediately adjust their own lending rates. When the policy rate drops, they lower mortgage rates, business loan rates, and credit card rates within days — borrowing just got cheaper.\",\n      \"title\": \"Banks Reprice Overnight\"\n    },\n    {\n      \"text\": \"Businesses see lower borrowing costs and start calculating: \\\"We can now afford that factory expansion.\\\" They apply for loans to invest in equipment, hire workers, and grow operations.\",\n      \"title\": \"Investment Decisions Shift\"\n    },\n    {\n      \"text\": \"Households notice mortgage rates falling and refinance their homes or take new loans. Monthly payments drop, freeing up cash. Some buy homes they couldn't afford before — demand for housing rises.\",\n      \"title\": \"Consumers Respond\"\n    },\n    {\n      \"text\": \"With cheaper credit, consumers pull out credit cards more freely. Retail spending picks up — electronics, cars, vacations. Money flows faster through the economy as purchases increase.\",\n      \"title\": \"Spending Accelerates\"\n    },\n    {\n      \"text\": \"Businesses see rising demand for their products. Factories run extra shifts, stores restock faster. To meet demand, companies hire more workers — unemployment starts dropping.\",\n      \"title\": \"Production Ramps Up\"\n    },\n    {\n      \"text\": \"As more people work and earn paychecks, they spend even more. This creates a feedback loop — demand fuels hiring, hiring fuels income, income fuels more demand.\",\n      \"title\": \"The Multiplier Effect Kicks In\"\n    },\n    {\n      \"text\": \"Asset prices respond too. Lower interest rates make bonds less attractive, so investors shift to stocks and real estate. Stock markets climb, home values rise — wealth increases on paper.\",\n      \"title\": \"Asset Markets Rally\"\n    },\n    {\n      \"text\": \"People feeling wealthier from rising home and stock values spend more confidently. This \\\"wealth effect\\\" adds another layer to the demand surge rippling through the economy.\",\n      \"title\": \"Wealth Fuels Confidence\"\n    },\n    {\n      \"text\": \"With strong demand and tight labor markets, workers negotiate raises. Companies facing higher wage bills start raising prices to protect margins — inflation begins creeping up.\",\n      \"title\": \"Price Pressures Build\"\n    },\n    {\n      \"text\": \"The exchange rate shifts as foreign investors see lower returns on the currency. Money flows out seeking better rates elsewhere, weakening the currency and making imports pricier.\",\n      \"title\": \"Currency Weakens\"\n    },\n    {\n      \"text\": \"Cheaper currency makes exports more competitive abroad while imports cost more at home. This trade shift boosts domestic producers and adds to inflationary pressure through import prices.\",\n      \"title\": \"Trade Flows Adjust\"\n    },\n    {\n      \"text\": \"Months pass as these effects compound. Inflation rises from 2% toward 3%. The central bank monitors closely — the transmission worked, but now they may need to reverse course to cool things down.\",\n      \"title\": \"Inflation Target Approaches\"\n    }\n  ]\n}",
      "outputTokens": 635,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-economics-monetary-transmission-1",
      "userPrompt": "LESSON_TITLE: Monetary Policy Transmission\nLESSON_DESCRIPTION: Understanding how central bank policy decisions transmit through the financial system to affect economic activity and inflation\nCHAPTER_TITLE: Macroeconomic Policy\nCOURSE_TITLE: Economics\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Policy Rate: The policy rate is the interest rate the central bank charges commercial banks. It serves as the baseline for all other rates in the economy.\n2. Reserve Requirements: Reserve requirements determine what fraction of deposits banks must hold. Lower requirements mean banks can lend more of their deposits.\n3. Open Market Operations: Open market operations involve buying and selling government bonds. Purchases inject money into the economy; sales withdraw it."
    },
    {
      "duration": 14050.135833000008,
      "inputTokens": 2405,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"When source code enters the compiler, it's just raw characters streaming in. The first phase, lexical analysis, scans this stream character by character, grouping them into meaningful tokens — like reading a sentence and recognizing individual words.\",\n      \"title\": \"Characters Flow In\"\n    },\n    {\n      \"text\": \"As tokens emerge from the lexer, the parser consumes them and checks syntax rules. It asks: \\\"Do these tokens form valid statements?\\\" Watch as it rejects malformed code immediately — catching your missing semicolons before going further.\",\n      \"title\": \"Parser Validates Structure\"\n    },\n    {\n      \"text\": \"Valid tokens trigger the parser to build an AST. Each token finds its place in the tree — operators become nodes, operands become children. An expression like \\\"a + b * c\\\" becomes a hierarchy showing multiplication happens before addition.\",\n      \"title\": \"Tree Takes Shape\"\n    },\n    {\n      \"text\": \"With the AST complete, semantic analysis begins walking the tree. It checks types, verifies variable declarations, and ensures operations make sense. Here's where \\\"text\\\" + 5 would fail — types don't match.\",\n      \"title\": \"Meaning Gets Verified\"\n    },\n    {\n      \"text\": \"Once semantics pass, the compiler transforms the AST into IR. Each high-level construct breaks down into simpler, generic operations. A for-loop becomes labels, jumps, and comparisons — still readable but closer to machine thinking.\",\n      \"title\": \"IR Translation Begins\"\n    },\n    {\n      \"text\": \"The optimizer takes over, scanning the IR for inefficiencies. It spots repeated calculations and caches them. It sees \\\"x * 0\\\" and replaces it with just \\\"0\\\". Dead code that never runs? Eliminated entirely.\",\n      \"title\": \"Optimization Runs\"\n    },\n    {\n      \"text\": \"Now the code generator converts optimized IR into target assembly. Each IR instruction maps to one or more machine instructions. Registers get assigned, memory addresses calculated — the abstraction dissolves into concrete hardware operations.\",\n      \"title\": \"Assembly Emerges\"\n    },\n    {\n      \"text\": \"Finally, the assembler and linker finish the job. Assembly becomes binary machine code. External libraries link in. The result: an executable file that the CPU can run directly, all traces of high-level syntax gone.\",\n      \"title\": \"Binary Output Complete\"\n    }\n  ]\n}",
      "outputTokens": 473,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-cs-compilation-pipeline-1",
      "userPrompt": "LESSON_TITLE: The Compilation Pipeline\nLESSON_DESCRIPTION: Understanding how compilers transform source code through multiple phases of analysis and synthesis\nCHAPTER_TITLE: Language Implementation\nCOURSE_TITLE: Compiler Design\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Tokens: Tokens are the smallest meaningful units of code — keywords, identifiers, operators, literals. The lexer breaks source code into this stream of tokens.\n2. Abstract Syntax Tree: The AST (Abstract Syntax Tree) represents code structure hierarchically. It captures how expressions nest and statements compose.\n3. Intermediate Representation: Intermediate representation (IR) is a platform-independent format. It's lower-level than the AST but higher-level than machine code."
    }
  ],
  "taskId": "activity-mechanics"
}
