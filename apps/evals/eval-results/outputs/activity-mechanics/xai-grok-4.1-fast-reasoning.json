{
  "generatedAt": "2026-01-17T01:16:02.382Z",
  "modelId": "xai/grok-4.1-fast-reasoning",
  "outputs": [
    {
      "duration": 11466.853041000024,
      "inputTokens": 2166,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"A pathogen slips past your skin barrier, entering the bloodstream or tissues — the invasion trigger is on. Patrolling macrophages spot the intruder first, like security guards at a gate.\",\n      \"title\": \"Pathogen Breaches Defenses\"\n    },\n    {\n      \"text\": \"Watch the macrophage extend pseudopods, engulfing the pathogen in a bubble called a phagosome. Enzymes inside dissolve it, but not before grabbing a piece — an antigen — as evidence.\",\n      \"title\": \"Macrophages Swallow Invader\"\n    },\n    {\n      \"text\": \"The macrophage bursts with alarm signals: cytokines flood the area, causing inflammation. Blood vessels dilate, drawing more white blood cells to the scene like reinforcements rushing to a fire.\",\n      \"title\": \"Alarm Cytokines Rally Help\"\n    },\n    {\n      \"text\": \"Antigen pieces hitch a ride on MHC proteins to the lymph nodes. Here, they display on dendritic cells, waving the evidence like a wanted poster for T cells to inspect.\",\n      \"title\": \"Antigens Parade to Lymph Nodes\"\n    },\n    {\n      \"text\": \"A T helper cell binds the matching antigen-MHC combo. This handshake activates it — now it multiplies rapidly, like a commander cloning troops, and releases signals to coordinate the attack.\",\n      \"title\": \"T Helper Cell Activates\"\n    },\n    {\n      \"text\": \"Activated T helpers signal matching B cells and cytotoxic T cells. B cells swell into plasma factories, pumping out antibodies that flood the blood, handcuffing free pathogens.\",\n      \"title\": \"B Cells Flood Antibodies\"\n    },\n    {\n      \"text\": \"Antibodies latch onto pathogens, marking them for phagocytosis or clumping them into harmless clusters. Cytotoxic T cells drill holes in infected body cells, unleashing toxins to burst them.\",\n      \"title\": \"Marked Pathogens Destroyed\"\n    },\n    {\n      \"text\": \"Killer cells and neutrophils mop up the debris, clearing the battlefield. As the threat fades, most responders die off, but memory cells linger, patrolling silently for future alerts.\",\n      \"title\": \"Cleanup and Memory Forms\"\n    },\n    {\n      \"text\": \"If overwhelmed, cytokines can trigger sepsis — a system-wide overreaction where inflammation spirals out of control, like a fire alarm flooding the building instead of just sounding it.\",\n      \"title\": \"When Response Overwhelms\"\n    }\n  ]\n}",
      "outputTokens": 900,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-biology-immune-response-1",
      "userPrompt": "LESSON_TITLE: The Immune Response Process\nLESSON_DESCRIPTION: Understanding the step-by-step process of how the immune system detects, responds to, and eliminates pathogens\nCHAPTER_TITLE: Body Systems\nCOURSE_TITLE: Human Biology\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. The Cellular Army: White blood cells are specialized defenders in your bloodstream. Different types handle different tasks — some patrol, some remember, some attack directly.\n2. Antibody Recognition: Antibodies are Y-shaped proteins that act like molecular handcuffs. Each type fits one specific pathogen shape, marking it for destruction.\n3. Immune Memory: Memory cells are veterans that remember past invaders. They remain dormant for years, ready to rapidly respond if the same threat returns."
    },
    {
      "duration": 16543.420874999953,
      "inputTokens": 2162,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Transcription factors guide RNA polymerase to the promoter, where it binds tightly like a magnet snapping to metal. This clamps the DNA, signaling the start of the genetic copy job.\",\n      \"title\": \"Polymerase Binds Promoter\"\n    },\n    {\n      \"text\": \"Energy from incoming nucleotides fuels the unwind: the DNA double helix bubbles open at the promoter, exposing the template strand like unzipping a blueprint scroll.\",\n      \"title\": \"DNA Bubble Forms\"\n    },\n    {\n      \"text\": \"The first nucleotide slots into place, complementary to the template base. Polymerase catalyzes the bond, starting a short RNA chain that it tests for stability.\",\n      \"title\": \"First Link Forms\"\n    },\n    {\n      \"text\": \"Once stable, polymerase shifts gears into elongation. It ratchets forward, peeling DNA ahead while rewinding behind, adding matched nucleotides in a 5' to 3' chain.\",\n      \"title\": \"Elongation Kicks In\"\n    },\n    {\n      \"text\": \"Nucleotides stream in one by one—A pairs U, T pairs A, G-C, C-G—snapping onto the growing RNA tail. The enzyme proofreads, fixing mismatches like an editor on the fly.\",\n      \"title\": \"Chain Grows Rapidly\"\n    },\n    {\n      \"text\": \"At the terminator sequence, the new RNA folds into a hairpin loop, jamming the polymerase like a brake. This pauses the machine and triggers release signals.\",\n      \"title\": \"Stop Signal Triggers\"\n    },\n    {\n      \"text\": \"The hairpin yanks the RNA free; polymerase detaches, and DNA strands snap back together. The fresh mRNA transcript floats off, ready for the next cellular phase.\",\n      \"title\": \"mRNA Released\"\n    }\n  ]\n}",
      "outputTokens": 1702,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-biology-dna-transcription-1",
      "userPrompt": "LESSON_TITLE: DNA Transcription\nLESSON_DESCRIPTION: Understanding how genetic information flows from DNA to messenger RNA through the transcription process\nCHAPTER_TITLE: Molecular Biology\nCOURSE_TITLE: Cell Biology\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. The Transcription Machine: RNA polymerase is the molecular machine that reads DNA and builds RNA. It's a large protein complex that moves along the DNA strand.\n2. Start Signals: Promoters are special DNA sequences that signal 'start here.' They tell RNA polymerase exactly where to begin reading a gene.\n3. The Building Blocks: Nucleotides are the building blocks — A, U, G, C for RNA. Each matches a complementary base on the DNA template being read."
    },
    {
      "duration": 15972.696750000003,
      "inputTokens": 2172,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"You click a link or submit a form—bam, the browser detects the trigger and kicks off the request lifecycle, grabbing the target URL to start the journey.\",\n      \"title\": \"User Action Triggers Request\"\n    },\n    {\n      \"text\": \"Watch the browser assemble the request like a delivery package: it slots in the method, tucks headers with metadata, adds any body data, then seals it for dispatch.\",\n      \"title\": \"Browser Builds Request Packet\"\n    },\n    {\n      \"text\": \"First stop: DNS lookup. Browser pings the DNS resolver, which translates the domain name into an IP address—like getting the server's exact coordinates on the internet map.\",\n      \"title\": \"DNS Resolves Server IP\"\n    },\n    {\n      \"text\": \"Browser initiates a TCP handshake: sends SYN, server replies SYN-ACK, browser ACKs back. Boom—a reliable connection pipe opens between browser and server.\",\n      \"title\": \"TCP Handshake Opens Pipe\"\n    },\n    {\n      \"text\": \"Over the open TCP connection, the browser streams out the full request: method line first, then headers, body if any. It races across the network to the server.\",\n      \"title\": \"Request Streams to Server\"\n    },\n    {\n      \"text\": \"Server grabs incoming bytes, parses the method and URL to route it, scans headers for auth or content clues, extracts body data—now it's primed to act.\",\n      \"title\": \"Server Parses Incoming Request\"\n    },\n    {\n      \"text\": \"Server's handler dives in: processes logic, queries data, crafts response with status code signaling success or fail, packs headers and body, ready to reply.\",\n      \"title\": \"Server Crafts Response\"\n    },\n    {\n      \"text\": \"Server pumps the response back through the TCP pipe: status line leads, headers follow, body trails. It mirrors the request's path across the network.\",\n      \"title\": \"Response Flows Back Home\"\n    },\n    {\n      \"text\": \"Browser catches the response, checks status code for outcome, reads headers for instructions like caching, then parses body—HTML renders into visible page.\",\n      \"title\": \"Browser Renders the Result\"\n    },\n    {\n      \"text\": \"If all smooth, TCP connection may reuse for pipelining or close cleanly. New assets like images trigger fresh requests, chaining more lifecycles.\",\n      \"title\": \"Connection Wraps or Reuses\"\n    },\n    {\n      \"text\": \"Bump in the road? Server hits error, sends 4xx/5xx code—browser spots it, shows error page. Or timeout cuts the pipe, retry logic kicks in.\",\n      \"title\": \"Handling Flow Failures\"\n    }\n  ]\n}",
      "outputTokens": 1402,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-cs-http-request-flow-1",
      "userPrompt": "LESSON_TITLE: The HTTP Request Lifecycle\nLESSON_DESCRIPTION: Understanding the complete lifecycle of an HTTP request from browser to server and back\nCHAPTER_TITLE: Web Protocols\nCOURSE_TITLE: Web Development Fundamentals\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Request Methods: HTTP methods define what action you want — GET retrieves data, POST sends data, PUT updates, DELETE removes. Each tells the server your intent.\n2. Response Codes: Status codes are three-digit responses from the server. 200 means success, 404 means not found, 500 means server error. They summarize what happened.\n3. Headers as Metadata: Headers carry metadata about the request and response — content type, authentication tokens, caching rules. They travel alongside the main data."
    },
    {
      "duration": 12535.82370800001,
      "inputTokens": 2156,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Heap usage climbs high, hitting a threshold — like a hotel nearing capacity. GC triggers automatically, pausing your app's threads to take control and prevent memory overflow.\",\n      \"title\": \"GC Triggers on Heap Pressure\"\n    },\n    {\n      \"text\": \"All mutator threads freeze in place. Now GC has the stage to scan without interference, ensuring no new references sneak in during cleanup.\",\n      \"title\": \"App Threads Pause\"\n    },\n    {\n      \"text\": \"GC grabs the GC roots — those globals, stack vars, registers — and lights them up as definitely alive. Think of roots as anchors holding the ship steady.\",\n      \"title\": \"Roots Light Up First\"\n    },\n    {\n      \"text\": \"From each root, GC follows reference chains like a relay race baton: object A refs B, mark B; B refs C, mark C. Unreachable objects stay dark.\",\n      \"title\": \"Marking Follows Refs\"\n    },\n    {\n      \"text\": \"The traversal floods the object graph, recursively marking every reachable object. Watch live clusters glow while isolated garbage fades unmarked.\",\n      \"title\": \"Graph Floods with Marks\"\n    },\n    {\n      \"text\": \"Marking wraps up. GC sweeps the entire heap, scanning every block — unmarked ones? Deemed garbage, instantly freed and added to the free list.\",\n      \"title\": \"Sweep Reclaims Garbage\"\n    },\n    {\n      \"text\": \"Free blocks coalesce into larger chunks, ready for new allocations. No fragmentation from stray holes — memory's tidy again.\",\n      \"title\": \"Blocks Coalesce Free\"\n    },\n    {\n      \"text\": \"In some GCs, compaction kicks in: live objects slide together, filling gaps like cars packing a parking lot, updating refs as they shift.\",\n      \"title\": \"Objects Compact Tight\"\n    },\n    {\n      \"text\": \"Threads roar back to life. Your app resumes, oblivious to the cleanup, with fresh heap space for the next allocations.\",\n      \"title\": \"Execution Resumes\"\n    }\n  ]\n}",
      "outputTokens": 1006,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-cs-garbage-collection-1",
      "userPrompt": "LESSON_TITLE: How Garbage Collection Works\nLESSON_DESCRIPTION: Understanding how automatic garbage collection identifies and reclaims unused memory in managed runtimes\nCHAPTER_TITLE: Memory Management\nCOURSE_TITLE: Programming Language Internals\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. The Heap: The heap is where dynamically allocated objects live. Unlike the stack, objects here persist until explicitly freed or garbage collected.\n2. Object References: References are pointers to objects in memory. When nothing references an object anymore, it becomes eligible for garbage collection.\n3. GC Roots: Root objects are the starting points — global variables, stack variables, CPU registers. Everything reachable from roots is considered alive."
    },
    {
      "duration": 12492.537707999989,
      "inputTokens": 2211,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"A luz solar atinge a clorofila no Fotossistema II, excitando elétrons como um raio que dá um empurrão inicial em uma corrida de revezamento.\",\n      \"title\": \"Luz Exita Elétrons no PSII\"\n    },\n    {\n      \"text\": \"Esses elétrons cheios de energia saltam para a cadeia transportadora de elétrons, deixando a clorofila com uma carga positiva que precisa ser reposta.\",\n      \"title\": \"Elétrons Saltam para a ETC\"\n    },\n    {\n      \"text\": \"Água é clivada no interior do tilacoide: enzimas quebram H2O, liberando O2, prótons e elétrons frescos que repõem o PSII.\",\n      \"title\": \"Fotólise Repõe Elétrons\"\n    },\n    {\n      \"text\": \"Enquanto os elétrons correm pela cadeia transportadora, como uma esteira rolante, eles liberam energia que bombeia prótons para o lúmen do tilacoide.\",\n      \"title\": \"ETC Bomba Prótons\"\n    },\n    {\n      \"text\": \"O acúmulo de prótons cria um gradiente de concentração, como água represada atrás de uma barragem, pressionando para fora.\",\n      \"title\": \"Gradiente de Prótons se Forma\"\n    },\n    {\n      \"text\": \"No Fotossistema I, a luz dá outro empurrão aos elétrons, elevando sua energia para o nível final da viagem.\",\n      \"title\": \"Luz Reexcita no PSI\"\n    },\n    {\n      \"text\": \"Elétrons energizados do PSI fluem para o NADP+, transformando-o em NADPH, o carregador de energia química pronto para uso.\",\n      \"title\": \"NADPH é Carregado\"\n    },\n    {\n      \"text\": \"O gradiente de prótons força a ATP sintase a girar como uma turbina hidrelétrica, fosforilando ADP em ATP à medida que prótons saem.\",\n      \"title\": \"ATP Sintase Gira e Produz\"\n    },\n    {\n      \"text\": \"Com ATP e NADPH prontos, a energia luminosa agora está armazenada como energia química, pronta para a fase escura.\",\n      \"title\": \"Energia Química Armazenada\"\n    }\n  ]\n}",
      "outputTokens": 1071,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "pt-biology-photosynthesis-light-1",
      "userPrompt": "LESSON_TITLE: Reacoes Luminosas da Fotossintese\nLESSON_DESCRIPTION: Entendendo como a fase clara da fotossintese converte energia luminosa em energia quimica atraves do transporte de eletrons\nCHAPTER_TITLE: Biologia Celular\nCOURSE_TITLE: Biologia Vegetal\nLANGUAGE: pt\nEXPLANATION_STEPS:\n1. Clorofila: A clorofila e o pigmento verde que captura luz. Ela absorve principalmente luz vermelha e azul, refletindo verde — por isso as plantas parecem verdes.\n2. Fotossistemas: Os fotossistemas sao complexos de proteinas nas membranas dos tilacoides. Fotossistema I e II trabalham juntos para capturar energia luminosa.\n3. ATP Sintase: A ATP sintase e uma turbina molecular que produz ATP. Ela usa o gradiente de protons para fosforilar ADP em ATP, a moeda energetica celular."
    },
    {
      "duration": 14337.484375,
      "inputTokens": 2209,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Imagina un mercado abarrotado de frutas: vendedores llegan con sus productos y compradores con sus presupuestos. Todo arranca cuando los vendedores anuncian un precio inicial, alto para maximizar ganancias.\",\n      \"title\": \"El Mercado Se Activa\"\n    },\n    {\n      \"text\": \"A ese precio, observa cómo los compradores reaccionan: si es bajo, muchos se lanzan a comprar, creando una fila enorme —demanda excede oferta, como compradores peleando por las mejores manzanas.\",\n      \"title\": \"Demanda Explota\"\n    },\n    {\n      \"text\": \"Los vendedores ven la cola y suben el precio rápidamente. Es como una subasta: las ofertas se disparan porque saben que pueden cobrar más sin perder ventas.\",\n      \"title\": \"Precios Suben por Escasez\"\n    },\n    {\n      \"text\": \"Ahora, con precios altos, algunos compradores se retiran y la oferta supera la demanda —sobran frutas en las mesas, como un puesto rebosante sin clientes.\",\n      \"title\": \"Exceso de Oferta Aparece\"\n    },\n    {\n      \"text\": \"Vendedores compiten bajando precios para mover su mercancía. Baja y baja hasta que los compradores regresan, equilibrando la balanza como un balancín que se estabiliza.\",\n      \"title\": \"Precios Bajan por Competencia\"\n    },\n    {\n      \"text\": \"Este tira y afloja continúa: subidas por demanda fuerte, bajadas por exceso. Cada ajuste acerca más al punto donde nadie quiere cambiar —oferta iguala demanda perfectamente.\",\n      \"title\": \"Ajustes Iterativos Convergen\"\n    },\n    {\n      \"text\": \"¡Equilibrio alcanzado! Al precio final, todos los vendedores venden lo que produjeron y todos los compradores obtienen lo que querían, sin presiones restantes.\",\n      \"title\": \"El Precio Se Estabiliza\"\n    }\n  ]\n}",
      "outputTokens": 1282,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "es-economics-price-discovery-1",
      "userPrompt": "LESSON_TITLE: El Proceso de Descubrimiento de Precios\nLESSON_DESCRIPTION: Entendiendo como los precios de mercado emergen de las interacciones entre compradores y vendedores\nCHAPTER_TITLE: Mercados y Precios\nCOURSE_TITLE: Economia Basica\nLANGUAGE: es\nEXPLANATION_STEPS:\n1. Curva de Oferta: La curva de oferta muestra cuanto produciran los vendedores a cada precio. Precios mas altos incentivan mayor produccion porque aumentan las ganancias potenciales.\n2. Curva de Demanda: La curva de demanda muestra cuanto compraran los consumidores a cada precio. Precios mas bajos aumentan la cantidad demandada porque el producto se vuelve mas accesible.\n3. Punto de Equilibrio: El equilibrio es el punto donde oferta y demanda se cruzan. A este precio, la cantidad que los vendedores quieren vender iguala lo que los compradores quieren comprar."
    },
    {
      "duration": 10462.021000000008,
      "inputTokens": 2178,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Watch a stray neutron zip into a U-235 nucleus, like the first domino toppling in a vast line. It gets absorbed, destabilizing the nucleus instantly.\",\n      \"title\": \"Stray Neutron Triggers Fission\"\n    },\n    {\n      \"text\": \"The unstable nucleus vibrates wildly and splits apart into two lighter fragments, hurtling in opposite directions like shrapnel from an explosion.\",\n      \"title\": \"Nucleus Splits Apart\"\n    },\n    {\n      \"text\": \"As it cleaves, the nucleus spits out 2-3 speedy new neutrons plus a massive burst of heat and radiation energy, kicking the chain into gear.\",\n      \"title\": \"Neutrons and Energy Burst Out\"\n    },\n    {\n      \"text\": \"These fresh neutrons scatter through the material, some slamming into nearby U-235 nuclei while others escape or get slowed by collisions.\",\n      \"title\": \"Neutrons Hunt New Targets\"\n    },\n    {\n      \"text\": \"A hit neutron triggers another fission, releasing even more neutrons—like passing a hot baton in a relay race that multiplies runners each lap.\",\n      \"title\": \"Second Fission Fires Off\"\n    },\n    {\n      \"text\": \"Each new fission spawns more neutrons than the last round, building an exponential wave: one becomes two, two become four, doubling down rapidly.\",\n      \"title\": \"Chain Reaction Accelerates\"\n    },\n    {\n      \"text\": \"Neutrons multiply until the production rate matches losses from escape or absorption, hitting 'criticality'—the chain now sustains itself steadily.\",\n      \"title\": \"Criticality Sustains the Chain\"\n    },\n    {\n      \"text\": \"In a reactor, control rods drop in like traffic cops, soaking up extra neutrons to throttle the chain back to a controlled simmer for steady power.\",\n      \"title\": \"Control Rods Tame the Chain\"\n    },\n    {\n      \"text\": \"Pull rods out too far or cram fissile material together, and neutrons overwhelm losses—the chain races unchecked toward a runaway blaze.\",\n      \"title\": \"Runaway Chain Ignites\"\n    },\n    {\n      \"text\": \"In a bomb, supercritical mass lets the chain explode in microseconds: billions of fissions flood energy before fragments fly apart, ending in a blast.\",\n      \"title\": \"Supercritical Boom Unleashes\"\n    }\n  ]\n}",
      "outputTokens": 949,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-physics-fission-chain-1",
      "userPrompt": "LESSON_TITLE: Nuclear Fission Chain Reactions\nLESSON_DESCRIPTION: Understanding how nuclear fission chain reactions start, propagate, and are controlled or allowed to run away\nCHAPTER_TITLE: Nuclear Physics\nCOURSE_TITLE: Modern Physics\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Fissile Materials: Fissile materials like U-235 have nuclei that split when struck by neutrons. Not all heavy elements are fissile — it depends on nuclear structure.\n2. Neutrons as Triggers: Neutrons are uncharged particles that can penetrate nuclei. When absorbed by fissile atoms, they destabilize the nucleus and trigger fission.\n3. Energy Release: Binding energy is the glue holding nuclei together. When fission occurs, some mass converts to energy according to E=mc2, releasing enormous power."
    },
    {
      "duration": 23036.63724999997,
      "inputTokens": 2155,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Slide a bar magnet toward a coil of wire. Magnetic field lines swarm through the coil's loops, ramping up the flux like rising floodwaters through a gate.\",\n      \"title\": \"Magnet Approaches Coil\"\n    },\n    {\n      \"text\": \"As flux climbs fast, Faraday's law triggers an EMF equal to the change rate—a voltage whirlpool circling the wire, urging electrons into motion.\",\n      \"title\": \"Flux Surge Sparks EMF\"\n    },\n    {\n      \"text\": \"Lenz's law flips the switch: induced current flows to birth a repelling magnetic field, bucking the invader like bouncers at a door.\",\n      \"title\": \"Opposition Field Activates\"\n    },\n    {\n      \"text\": \"Electrons surge around the closed loop, lighting a galvanometer needle. Current flows strong while flux keeps changing—pure induction in action.\",\n      \"title\": \"Current Pulses to Life\"\n    },\n    {\n      \"text\": \"Yank the magnet back: flux plunges, EMF reverses direction. Current flips to create an attracting field, fighting the drop like a magnet's tug-of-war.\",\n      \"title\": \"Withdrawal Reverses Flow\"\n    },\n    {\n      \"text\": \"Steady the magnet—no flux change—and induction dies. EMF vanishes, current halts. It's motion that keeps the electric river running.\",\n      \"title\": \"Steady State Shuts It Down\"\n    },\n    {\n      \"text\": \"In a moving conductor like a rod sliding on rails in a field, charges feel Lorentz force separating them, building EMF until current balances it.\",\n      \"title\": \"Motional EMF Joins In\"\n    },\n    {\n      \"text\": \"Open the loop? EMF piles charges at ends for voltage, but no loop means no circling current—the path must close for flow.\",\n      \"title\": \"Circuit Closure Required\"\n    }\n  ]\n}",
      "outputTokens": 1924,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-physics-electromagnetic-induction-1",
      "userPrompt": "LESSON_TITLE: Electromagnetic Induction\nLESSON_DESCRIPTION: Understanding how changing magnetic fields induce electric currents in conductors\nCHAPTER_TITLE: Electromagnetism\nCOURSE_TITLE: Physics Fundamentals\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Magnetic Flux: Magnetic flux measures how much magnetic field passes through a surface. It depends on field strength, area, and the angle between them.\n2. Induced EMF: EMF (electromotive force) is the voltage that drives current. In induction, changing magnetic flux creates this voltage without any battery.\n3. Faraday's Law: Faraday's law states that induced EMF equals the rate of change of magnetic flux. Faster changes produce larger voltages."
    },
    {
      "duration": 21500.21554200002,
      "inputTokens": 2204,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Imagine o substrato navegando pela solução aquosa até colidir com a enzima, como uma peça de quebra-cabeça flutuando até seu encaixe perfeito no sítio ativo.\",\n      \"title\": \"Substrato Colide com Enzima\"\n    },\n    {\n      \"text\": \"Ao se aproximar, o substrato se fixa no sítio ativo por ligações fracas, como um aperto de mão. A enzima muda levemente de forma, abraçando o substrato no modelo de ajuste induzido.\",\n      \"title\": \"Ligação e Ajuste Induzido\"\n    },\n    {\n      \"text\": \"Agora forma-se o complexo enzima-substrato (ES). Veja como a enzima segura o substrato, orientando-o precisamente para a reação, como um chef posicionando ingredientes na tábua.\",\n      \"title\": \"Complexo ES se Forma\"\n    },\n    {\n      \"text\": \"Grupos químicos do sítio ativo interagem: ácidos doam prótons, bases os recebem. Isso estressa as ligações do substrato, como torcer uma mola para facilitar o salto.\",\n      \"title\": \"Sítio Ativo Ataca Ligações\"\n    },\n    {\n      \"text\": \"O estado de transição surge — a configuração instável de alta energia. A enzima o estabiliza com interações, baixando a barreira como uma rampa suave em vez de um pico rochoso.\",\n      \"title\": \"Transição Estabilizada\"\n    },\n    {\n      \"text\": \"Ligações se rompem e novas se formam rapidamente. O substrato se transforma em produtos, como dominós caindo em sequência no complexo ES.\",\n      \"title\": \"Reação Acontece\"\n    },\n    {\n      \"text\": \"Produtos, agora mais fracos ligados à enzima, se soltam. É como soltar balões cheios: eles flutuam para longe, deixando a enzima vazia e pronta.\",\n      \"title\": \"Produtos São Liberados\"\n    },\n    {\n      \"text\": \"A enzima volta à forma original, intacta e cataliticamente ativa. O ciclo reinicia com novo substrato — uma linha de montagem biológica sem fim.\",\n      \"title\": \"Enzima se Regenera\"\n    },\n    {\n      \"text\": \"Se um inibidor competitivo se liga primeiro, bloqueia o substrato como um intruso na fechadura, parando o fluxo até ser removido.\",\n      \"title\": \"Quando o Processo Falha\"\n    }\n  ]\n}",
      "outputTokens": 1274,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "pt-chemistry-enzyme-catalysis-1",
      "userPrompt": "LESSON_TITLE: Como Enzimas Catalisam Reacoes\nLESSON_DESCRIPTION: Entendendo o processo molecular pelo qual enzimas catalisam reacoes bioquimicas\nCHAPTER_TITLE: Bioquimica\nCOURSE_TITLE: Quimica Organica\nLANGUAGE: pt\nEXPLANATION_STEPS:\n1. Sitio Ativo: O sitio ativo e a regiao da enzima onde a catalise acontece. Sua forma tridimensional complementa o substrato, permitindo ligacao especifica.\n2. Substratos: Substratos sao as moleculas que as enzimas transformam. Eles se ligam ao sitio ativo e passam pela reacao quimica catalisada.\n3. Energia de Ativacao: A energia de ativacao e a barreira energetica que as reacoes precisam superar. Enzimas reduzem essa barreira, acelerando reacoes milhoes de vezes."
    },
    {
      "duration": 11181.64729199995,
      "inputTokens": 2195,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Enciendes la fuente de corriente: La batería comienza a impulsar electrones a través del circuito externo hacia el cátodo, cargándolo negativamente como un imán atrayendo metales.\",\n      \"title\": \"Fuente impulsa electrones\"\n    },\n    {\n      \"text\": \"Cationes migran al cátodo: Atraídos por la carga negativa, los cationes positivos nadan velozmente por la solución electrolítica hacia el cátodo, como autos hacia un estacionamiento.\",\n      \"title\": \"Cationes corren al cátodo\"\n    },\n    {\n      \"text\": \"Reducción ocurre: En el cátodo, los cationes chocan y roban electrones de la superficie, transformándose en átomos neutros que se depositan o liberan gas.\",\n      \"title\": \"Cationes ganan electrones\"\n    },\n    {\n      \"text\": \"Aniones viajan al ánodo: Al mismo tiempo, los aniones negativos, repelidos por el cátodo, fluyen hacia el ánodo positivo, equilibrando el flujo iónico.\",\n      \"title\": \"Aniones fluyen al ánodo\"\n    },\n    {\n      \"text\": \"Oxidación en acción: Al tocar el ánodo, los aniones liberan electrones hacia el electrodo, convirtiéndose en átomos o moléculas que forman gases o se disuelven.\",\n      \"title\": \"Aniones pierden electrones\"\n    },\n    {\n      \"text\": \"Electrones completan el circuito: Los electrones del ánodo viajan de vuelta a la batería por el cable externo, cerrando el lazo y permitiendo que el proceso continúe.\",\n      \"title\": \"Circuito se cierra\"\n    },\n    {\n      \"text\": \"Reacción se fuerza: Paso a paso, la electricidad empuja la reacción química no espontánea hacia adelante, produciendo productos en ambos electrodos hasta agotar reactivos.\",\n      \"title\": \"Proceso genera productos\"\n    }\n  ]\n}",
      "outputTokens": 1031,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "es-chemistry-electrolysis-1",
      "userPrompt": "LESSON_TITLE: El Proceso de Electrolisis\nLESSON_DESCRIPTION: Entendiendo como la corriente electrica fuerza reacciones quimicas no espontaneas en celdas electroliticas\nCHAPTER_TITLE: Electroquimica\nCOURSE_TITLE: Quimica General\nLANGUAGE: es\nEXPLANATION_STEPS:\n1. Electrodos: Los electrodos son conductores que conectan el circuito externo con la solucion. El catodo es negativo y el anodo es positivo.\n2. Electrolitos: Los electrolitos son sustancias que se disocian en iones cuando se disuelven. Estos iones libres permiten que la corriente fluya a traves de la solucion.\n3. Iones: Los iones son atomos o moleculas con carga electrica. Los cationes tienen carga positiva, los aniones tienen carga negativa."
    },
    {
      "duration": 14847.661458000017,
      "inputTokens": 2157,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Central bank announces a policy rate cut, like flipping a switch to lower the cost of money at the source. This immediately hikes the incentive for banks to borrow more from the central bank instead of hoarding cash.\",\n      \"title\": \"CB Flips the Rate Switch\"\n    },\n    {\n      \"text\": \"Banks rush to tap cheaper central bank funds, easing their funding squeeze. Watch as their balance sheets swell with fresh liquidity, ready to lend out.\",\n      \"title\": \"Banks Tap Cheaper Funds\"\n    },\n    {\n      \"text\": \"Reserve requirements loosen or open market buys flood banks with reserves—like draining a reserve tank to unleash lending power. Banks now hold excess cash beyond what's required.\",\n      \"title\": \"Reserves Unlock Lending Power\"\n    },\n    {\n      \"text\": \"Banks slash loan rates to customers, from mortgages to business lines of credit. See rates ripple outward like waves from a stone dropped in a pond, making borrowing irresistible.\",\n      \"title\": \"Rates Ripple to Borrowers\"\n    },\n    {\n      \"text\": \"Businesses and households dive into loans—firms expand factories, families buy homes. Borrowing surges, injecting money into spending like fuel into an engine.\",\n      \"title\": \"Borrowing and Spending Surge\"\n    },\n    {\n      \"text\": \"New loans create deposits in other banks, sparking a multiplier chain. One loan begets more deposits, which fund more loans—like a relay race passing the baton of money creation.\",\n      \"title\": \"Money Multiplies Through Banks\"\n    },\n    {\n      \"text\": \"Cheap credit lifts asset prices—stocks climb, homes appreciate—wealth effect prompts more consumer spending. Investments boom, hiring ramps up across the economy.\",\n      \"title\": \"Assets and Activity Accelerate\"\n    },\n    {\n      \"text\": \"Aggregate demand swells: factories hum, shops bustle, GDP climbs. Jobs multiply as output expands, pulling in more workers and wages.\",\n      \"title\": \"Demand Drives Economic Growth\"\n    },\n    {\n      \"text\": \"If supply can't keep pace, inflation stirs—prices tick up as hot demand chases goods. Central bank watches this feedback loop, ready to tighten if needed.\",\n      \"title\": \"Inflation Heats from Pressure\"\n    },\n    {\n      \"text\": \"Transmission reverses on hikes: rates rise, lending slows, spending cools, output stabilizes, inflation eases—like slamming brakes on an overheating engine.\",\n      \"title\": \"Tightening Puts on Brakes\"\n    }\n  ]\n}",
      "outputTokens": 1269,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-economics-monetary-transmission-1",
      "userPrompt": "LESSON_TITLE: Monetary Policy Transmission\nLESSON_DESCRIPTION: Understanding how central bank policy decisions transmit through the financial system to affect economic activity and inflation\nCHAPTER_TITLE: Macroeconomic Policy\nCOURSE_TITLE: Economics\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Policy Rate: The policy rate is the interest rate the central bank charges commercial banks. It serves as the baseline for all other rates in the economy.\n2. Reserve Requirements: Reserve requirements determine what fraction of deposits banks must hold. Lower requirements mean banks can lend more of their deposits.\n3. Open Market Operations: Open market operations involve buying and selling government bonds. Purchases inject money into the economy; sales withdraw it."
    },
    {
      "duration": 19249.16404100001,
      "inputTokens": 2156,
      "output": "{\n  \"steps\": [\n    {\n      \"text\": \"Your source code streams into the lexer like raw ingredients down a conveyor belt. It scans chars sequentially, matching patterns to emit a token stream — stripping whitespace and comments, ready for parsing.\",\n      \"title\": \"Lexer Scans Source Code\"\n    },\n    {\n      \"text\": \"The token stream feeds the parser, which acts like a builder following blueprint rules. It shifts tokens and reduces them into hierarchical branches, erecting the full AST that captures nesting and structure.\",\n      \"title\": \"Parser Builds the AST\"\n    },\n    {\n      \"text\": \"AST passes to semantic analysis, where type checkers and scope resolvers inspect every node. They propagate types, flag mismatches, and annotate — or trigger errors if semantics don't align.\",\n      \"title\": \"Semantics Validates AST\"\n    },\n    {\n      \"text\": \"Validated AST lowers into IR generation. Watch structure flatten: high-level constructs convert to a platform-independent sequence of basic operations, bridging front-end to backend.\",\n      \"title\": \"AST Transforms to IR\"\n    },\n    {\n      \"text\": \"IR enters the optimizer, running passes like an editor's red pen. Constant folding simplifies expressions, dead code evaporates, loops unroll — shrinking and speeding the representation.\",\n      \"title\": \"Optimizer Refines IR\"\n    },\n    {\n      \"text\": \"Polished IR hits the backend code generator. It selects target instructions, allocates registers, and schedules ops — transforming abstract flows into machine-specific assembly code.\",\n      \"title\": \"Backend Emits Machine Code\"\n    },\n    {\n      \"text\": \"Assembly assembles into object files; linker weaves them with libraries, resolving symbols into a standalone executable. The pipeline completes — binary ready to launch.\",\n      \"title\": \"Linker Produces Executable\"\n    },\n    {\n      \"text\": \"Breaks happen fast: lexer spots invalid chars, parser chokes on bad syntax, semantics catches type errors. Flow halts with precise diagnostics, pinpointing the faulty line.\",\n      \"title\": \"Errors Stop the Pipeline\"\n    }\n  ]\n}",
      "outputTokens": 1758,
      "systemPrompt": "# Role\n\nYou are an expert process explainer creating a **Mechanics** activity for a learning app. Your mission is to explain the \"how\" behind a topic — its processes, sequences, and systems that make it work \"under the hood.\"\n\nYou specialize in transforming invisible processes into vivid mental simulations that help learners SEE things happening, not just understand definitions.\n\n# The Art of Process Explanation\n\nA great Mechanics activity doesn't describe static parts — it shows things in MOTION. Think of it like being a sports commentator who helps viewers see the play unfold in real-time, calling out each action and its effect.\n\n## Why Process Visualization Works\n\n1. **Mental Simulation**: When learners can \"run the process\" in their minds, they truly understand it — not just memorize steps.\n\n2. **Cause-Effect Clarity**: Seeing what triggers what reveals the logic behind systems. Understanding causes makes effects predictable.\n\n3. **Debugging Intuition**: When you know how something flows, you can spot where things might break or go wrong.\n\n## The Process Flow Principle\n\nEvery great Mechanics activity follows an action-driven arc:\n\n- **Trigger**: What kicks things off? What sets the process in motion?\n- **Flow**: What happens next? How does one step lead to another?\n- **Interactions**: How do parts affect each other? What depends on what?\n- **Outcome**: What's the end result? How do you know the process completed?\n\n## Why Short Steps Work\n\nEach step should be a \"frame\" in your mental movie — brief enough to visualize clearly, substantial enough to show real action. Short steps:\n\n- Let learners see one action at a time\n- Build a complete mental simulation piece by piece\n- Make invisible processes feel observable\n- Allow learners to pause and replay each \"scene\"\n\n# Inputs\n\n- `LESSON_TITLE`: The topic to explain the mechanics of\n- `LESSON_DESCRIPTION`: Additional context about what this lesson covers\n- `CHAPTER_TITLE`: The chapter context (for understanding scope)\n- `COURSE_TITLE`: The course context (for understanding audience level)\n- `LANGUAGE`: Output language\n- `EXPLANATION_STEPS`: Array of {title, text} from the Explanation activity learners completed before this one (to avoid repeating content)\n\n## Language Guidelines\n\n- `en`: Use US English unless the content is region-specific\n- `pt`: Use Brazilian Portuguese unless the content is region-specific\n- `es`: Use Latin American Spanish unless the content is region-specific\n\n# Requirements\n\n## Step Structure\n\nEach step must have:\n\n- **title**: Maximum 50 characters. A dynamic, action-oriented headline that signals movement or change.\n- **text**: Maximum 300 characters. A conversational paragraph that shows something HAPPENING.\n\n## Tone & Style\n\n- **Conversational**: Write as if walking a curious friend through a behind-the-scenes tour\n- **Rich in process metaphors**: Use analogies from everyday processes (cooking recipes, assembly lines, traffic flow, relay races, domino chains) to make invisible mechanisms visible\n- **Action-focused**: Use active verbs — things \"trigger,\" \"flow,\" \"signal,\" \"transform,\" \"pass to\"\n- **Visual**: Help the learner SEE the process running — use \"watch as,\" \"notice how,\" \"see the way\"\n\n## What to Avoid\n\n- Repeating content from EXPLANATION_STEPS (the learner already knows WHAT it is)\n- Static descriptions of parts (that's Explanation's job)\n- History or origin stories (that's Background's job)\n- Just listing steps without showing cause-effect relationships\n- Technical jargon without process context\n- Generic statements that could apply to any topic\n- Starting with \"In this activity...\" or similar meta-commentary\n\n## Scope\n\n- **Stay focused**: Cover only THIS lesson's topic, not the broader chapter or course\n- **Don't expand**: Other lessons will cover related topics — trust the curriculum structure\n- **Don't narrow**: If the lesson is about \"How Vaccines Work\", cover the full immune process, not just \"antibody production\"\n\n## Relationship to Previous Activities\n\nThe learner has already completed:\n\n- **Background**: WHY this exists (origin story, problems solved, historical context)\n- **Explanation**: WHAT it is (core concepts, components, definitions)\n\nYour Mechanics activity explains HOW (processes in action, cause-effect chains, systems running). These complement each other:\n\n- Background: \"WHY did we need this?\"\n- Explanation: \"WHAT exactly is it?\"\n- Mechanics: \"HOW does it actually work?\"\n\nNever repeat the definitions from Explanation. Assume the learner knows what the parts ARE and is now ready to see them in ACTION.\n\n# Structure Guide\n\nWhile every topic is unique, most Mechanics activities touch on these themes (adapt as needed):\n\n1. **The Starting Point**: What triggers the process? What's the initial state?\n2. **First Movement**: What happens first? What gets set in motion?\n3. **Chain Reactions**: How does one action lead to the next?\n4. **Key Interactions**: Where do different parts meet or affect each other?\n5. **Decision Points**: Are there branches, conditions, or variations in the flow?\n6. **The Finish Line**: How does the process complete? What's the end state?\n7. **When Things Go Wrong**: What breaks the flow? What causes failures?\n\nNot every topic needs all these elements — some may need more or fewer steps. Let the process's complexity dictate the structure.\n\n# Example: How Email Delivery Works\n\nHere's how a Mechanics activity might flow for \"How Email Delivery Works\" (assuming learners already know WHAT email servers, protocols, and addresses are):\n\n| Title                   | Text                                                                                                                                                                  |\n| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| You Hit Send            | The moment you click send, your email client packages your message like a letter in an envelope — your address as the sender, the recipient's address on the front.   |\n| Finding the Post Office | Your device connects to your outgoing mail server. Think of it like dropping your letter at the local post office — they'll take it from here.                        |\n| The Handoff Begins      | Your mail server reads the destination address and asks, \"Who handles mail for this domain?\" It's like asking which post office serves that neighborhood.             |\n| DNS Points the Way      | The DNS system responds with directions — the IP address of the recipient's mail server. Now your server knows exactly where to deliver.                              |\n| Servers Shake Hands     | Your server connects to the recipient's server and they exchange greetings. \"I have mail for one of your users.\" \"Let me verify... okay, I'll accept it.\"             |\n| Into the Inbox          | The receiving server places the message in the recipient's mailbox. It sits there like a letter in a physical mailbox, waiting to be opened.                          |\n| The Recipient Checks In | When they open their email app, it connects to the server and downloads waiting messages. The email finally appears on their screen — delivered.                      |\n| When Delivery Fails     | If the recipient's server is down or the address doesn't exist, your server gets a bounce-back — like a \"return to sender\" stamp. The process reverses to notify you. |\n\nNotice how each step shows ACTION — things moving, connecting, responding. The learner can now mentally trace an email's journey from send to inbox. This is just an example, though. Adapt the structure to the process you're explaining. It could be more or fewer steps depending on complexity.\n\n# Quality Checks\n\nBefore finalizing, verify:\n\n- [ ] Does the explanation start with the trigger or initial action?\n- [ ] Does each step show something HAPPENING, not just describe a part?\n- [ ] Are cause-effect relationships clear (one thing leads to the next)?\n- [ ] Can the learner mentally simulate the full process from start to finish?\n- [ ] Are process metaphors used to make invisible mechanisms visible?\n- [ ] Is there NO overlap with the EXPLANATION_STEPS content?\n- [ ] Does the activity focus on HOW (processes) not WHAT (definitions)?\n- [ ] Is the scope exactly the lesson topic — not broader or narrower?\n- [ ] Are all titles ≤50 characters and all texts ≤300 characters?\n\n# Output Format\n\nReturn an array of steps, each with:\n\n- **title**: Dynamic, action-oriented headline (max 50 chars)\n- **text**: Conversational, process-showing paragraph (max 300 chars)\n\nUse as many steps as needed to show the complete process in action. Don't limit yourself to a specific number of steps. Let the process's complexity dictate the length.\n",
      "testCaseId": "en-cs-compilation-pipeline-1",
      "userPrompt": "LESSON_TITLE: The Compilation Pipeline\nLESSON_DESCRIPTION: Understanding how compilers transform source code through multiple phases of analysis and synthesis\nCHAPTER_TITLE: Language Implementation\nCOURSE_TITLE: Compiler Design\nLANGUAGE: en\nEXPLANATION_STEPS:\n1. Tokens: Tokens are the smallest meaningful units of code — keywords, identifiers, operators, literals. The lexer breaks source code into this stream of tokens.\n2. Abstract Syntax Tree: The AST (Abstract Syntax Tree) represents code structure hierarchically. It captures how expressions nest and statements compose.\n3. Intermediate Representation: Intermediate representation (IR) is a platform-independent format. It's lower-level than the AST but higher-level than machine code."
    }
  ],
  "taskId": "activity-mechanics"
}
